
<!doctypehtml><html lang=en><meta charset=UTF-8><meta content="width=device-width,initial-scale=1"name=viewport><title>Ramifyy</title><style>:root{--bg:#0b0f14;--panel:#10151c;--card:#131a22;--text:#eaf2ff;--muted:#a8b0bb;--brand:#7dd3fc;--brand-600:#38bdf8;--radius:14px;--shadow:0 8px 30px rgba(0,0,0,.35)}body,html{height:100%}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-size:cover;background-position:center;background-repeat:no-repeat;background-attachment:fixed}.menu{position:fixed;top:12px;left:12px;right:12px;display:flex;align-items:center;gap:10px;background:rgba(16,21,28,.72);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);padding:8px;box-shadow:var(--shadow);z-index:1000}.chip-btn,.icon-btn{display:inline-flex;align-items:center;justify-content:center;height:36px;min-width:36px;padding:0 10px;gap:8px;border:1px solid rgba(255,255,255,.08);background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));color:var(--text);border-radius:10px;cursor:pointer;transition:transform .08s ease,border-color .2s ease,background .2s ease}.chip-btn:hover,.icon-btn:hover{border-color:rgba(255,255,255,.18)}.chip-btn:active,.icon-btn:active{transform:translateY(1px) scale(.98)}.spacer{flex:1}.dropdown small{color:#eaf1fb!important}.dropdown{position:absolute;top:56px;left:12px;background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:12px;box-shadow:var(--shadow);padding:12px;width:min(420px,92vw);display:none;z-index:1001}.dropdown h3{margin:6px 0 10px;font-size:14px;color:var(--text)!important;font-weight:600}.row{display:flex;gap:8px}input[type=datetime-local],input[type=search],input[type=text],select{width:100%;background:#0f1318;color:var(--text);border:1px solid rgba(255,255,255,.08);border-radius:10px;padding:10px 12px;outline:0}.small-select{width:auto;min-width:140px;padding:4px 8px;font-size:12px}input[type=datetime-local]::-webkit-calendar-picker-indicator{filter:invert(1);opacity:.9}.content{width:min(1100px,94vw);margin:120px auto 60px}.heading-block{margin:18px 0 8px}.heading-bar{display:flex;align-items:center;gap:8px;justify-content:space-between;background:var(--panel);border:1px solid rgba(255,255,255,.08);padding:10px 12px;border-radius:12px;position:relative}.heading-left{display:flex;align-items:center;gap:8px}.heading-toggle{background:0 0;border:none;color:var(--brand);font-size:18px;cursor:pointer;transition:transform .15s ease,color .2s ease}.heading-toggle:hover{color:var(--brand-600);transform:scale(1.12)}.heading-name{font-weight:800;letter-spacing:.3px}.heading-actions .mini-menu{position:absolute;right:12px;top:56px;width:260px}.cards{display:none;grid-template-columns:repeat(3,minmax(0,1fr));gap:20px;margin-top:16px}.cards.open{display:grid}@media (min-width:1150px){.cards{grid-template-columns:repeat(4,minmax(0,1fr))}}@media (max-width:640px){.cards{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (max-width:420px){.cards{grid-template-columns:1fr}}.card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:18px;padding:20px;display:flex;align-items:center;gap:14px;cursor:pointer;user-select:none;transition:transform .12s ease,box-shadow .2s ease,border-color .2s ease}.card:hover{transform:translateY(-2px);border-color:rgba(125,211,252,.35);box-shadow:0 8px 24px rgba(125,211,252,.16)}.card:active{transform:translateY(0) scale(.98)}.card.dragging{opacity:.6;transform:scale(1.03)}.card img{width:30px;height:30px;border-radius:6px}.card p{margin:0;font-weight:800;font-size:16px}.tasks{position:fixed;top:68px;right:-420px;width:min(420px,92vw);max-height:82vh;overflow:auto;background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:14px;box-shadow:var(--shadow);padding:12px;z-index:1002;transition:right .35s ease}.tasks.open{right:12px}.task-card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:14px;margin:12px 0;color:var(--text)}.task-card.white{background:#fff!important;color:#0a0a0a!important}.task-title{font-weight:900;font-size:19px;margin:4px 0 10px;text-align:center}.task-title.done{text-decoration:line-through;opacity:.6}.task-actions{display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:10px}.task-actions input[type=checkbox]{transform:scale(1.9);width:22px;height:22px}.task-notes{width:100%;min-height:54px;resize:vertical;background:#0f1318;color:var(--text);border:1px solid rgba(255,255,255,.08);border-radius:10px;padding:8px}#timeDisplay{font-size:30px;font-weight:900;letter-spacing:1.25px}.cal-win{display:none;position:fixed;top:120px;left:120px;width:860px;height:620px;background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:12px;box-shadow:var(--shadow);overflow:hidden;z-index:1001}.cal-header{height:38px;display:flex;align-items:center;justify-content:space-between;padding:0 10px;background:var(--brand);color:#041116;font-weight:800;cursor:grab}.cal-body{width:100%;height:calc(100% - 38px)}.cal-resizer{position:absolute;z-index:1003}.cal-resizer.e{right:-6px;top:0;bottom:0;width:12px;cursor:ew-resize}.cal-resizer.w{left:-6px;top:0;bottom:0;width:12px;cursor:ew-resize}.cal-resizer.s{left:0;right:0;bottom:-6px;height:12px;cursor:ns-resize}.cal-resizer.n{left:0;right:0;top:-6px;height:12px;cursor:ns-resize}.cal-resizer.se{right:-8px;bottom:-8px;width:16px;height:16px;cursor:nwse-resize}.cal-resizer.sw{left:-8px;bottom:-8px;width:16px;height:16px;cursor:nesw-resize}.cal-resizer.ne{right:-8px;top:-8px;width:16px;height:16px;cursor:nwse-resize}.cal-resizer.nw{left:-8px;top:-8px;width:16px;height:16px;cursor:nwse-resize}.weather-chip{display:inline-flex;align-items:center;gap:8px;font-weight:700;padding:0 10px;height:36px;border:1px solid rgba(255,255,255,.08);border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));cursor:pointer}.weather-chip small{color:var(--muted);font-weight:600}.hidden{display:none!important}.iex{margin:12px 0 18px;border-radius:16px;border:1px solid rgba(255,255,255,.18);padding:12px;box-shadow:var(--shadow)}.iex .addrbar{display:flex;gap:8px;align-items:center;width:100%;background:#0f151c;border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:10px}.iex .addrbar input{flex:1;border:none;outline:0;background:0 0;color:var(--text);font-size:16px}.iex--pinkblue{background:radial-gradient(1200px 200px at 30% -20%,rgba(255,102,196,.16),transparent 60%),linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));box-shadow:0 16px 60px rgba(255,102,196,.22)}.iex--teal{background:radial-gradient(1200px 200px at 30% -20%,rgba(34,247,195,.16),transparent 60%),linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));box-shadow:0 16px 60px rgba(34,247,195,.18)}.iex--amber{background:radial-gradient(1200px 200px at 30% -20%,rgba(245,158,11,.2),transparent 60%),linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));box-shadow:0 16px 60px rgba(245,158,11,.22)}.iex--slate{background:radial-gradient(1200px 200px at 30% -20%,rgba(96,165,250,.14),transparent 60%),linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));box-shadow:0 16px 60px rgba(96,165,250,.18)}.iex--neon{background:radial-gradient(1200px 200px at 30% -20%,rgba(34,197,94,.2),transparent 60%),linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));box-shadow:0 16px 60px rgba(34,197,94,.22)}.dock{position:fixed;top:60px;left:12px;width:min(460px,46vw);max-height:86vh;overflow:hidden;background:rgba(16,21,28,.45);backdrop-filter:blur(14px) saturate(130%);border:1px solid rgba(255,255,255,.14);border-radius:18px;box-shadow:0 24px 70px rgba(0,0,0,.5);z-index:1002;display:none}.dock::before{content:"";position:absolute;inset:0;pointer-events:none;border-radius:18px;background:linear-gradient(180deg,rgba(125,211,252,.25),rgba(255,255,255,0) 40%,rgba(125,211,252,.12) 100%);opacity:.75}.dock header{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.1);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02))}.dock header strong{letter-spacing:.3px}.dock .body{width:100%;height:calc(86vh - 54px);overflow:auto}.dock .list{padding:10px 10px 14px;display:grid;gap:10px}.dock .item{display:flex;align-items:flex-start;gap:10px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.14);border-radius:14px;padding:10px 12px;transition:transform .12s ease,border-color .2s ease,background .2s ease}.dock .item:hover{transform:translateY(-1px) scale(1.01);border-color:rgba(125,211,252,.45);background:rgba(255,255,255,.07)}.dock .item a{color:var(--text);text-decoration:none;font-weight:800}.dock .favicon{flex:0 0 18px;width:18px;height:18px;border-radius:4px;opacity:.9;margin-top:2px}.dock .meta{color:var(--muted);font-size:12px;margin-top:4px}.dock .empty{color:var(--muted);padding:12px}.dock .widget{width:100%;height:100%}#navResults{display:grid;gap:8px}#navResults .result-item{padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.04);cursor:pointer}#navResults .result-item:hover{border-color:rgba(125,211,252,.35);background:rgba(255,255,255,.06)}.widget-card{display:flex;flex-direction:column;min-height:300px;max-height:clamp(360px,70vh,860px);overflow:hidden}.widget-card__body{flex:1 1 auto;overflow:auto;overscroll-behavior:contain}@media (min-width:1281px){body.dock-open .content{margin-left:clamp(480px,36vw,600px);transition:margin-left .25s ease}}@media (max-width:1280px){.dock{left:12px!important;right:12px!important;width:auto!important;max-width:980px}.dock .body{height:calc(78vh - 54px)!important}body.dock-open .content{margin-left:0!important}}.cards .card{background:#151b23}.iex{backdrop-filter:blur(18px) saturate(120%)}.iex .addrbar{backdrop-filter:blur(8px);box-shadow:inset 0 0 0 1px rgba(255,255,255,.06),0 8px 26px rgba(0,0,0,.35)}.iex .addrbar:focus-within{box-shadow:inset 0 0 0 2px rgba(125,211,252,.55),0 8px 30px rgba(125,211,252,.2)}.iex--teal .addrbar{border-color:rgba(34,247,195,.35)}.iex--amber .addrbar{border-color:rgba(245,158,11,.35)}.iex--slate .addrbar{border-color:rgba(96,165,250,.35)}.iex--neon .addrbar{border-color:rgba(34,197,94,.35)}.iex--pinkblue .addrbar{border-color:rgba(255,102,196,.35)}#ramifySettingsBackdrop{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;z-index:10000}#ramifySettingsModal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);width:min(560px,92vw);background:var(--panel,#10151c);color:var(--text,#eaf2ff);border-radius:14px;border:1px solid rgba(255,255,255,.12);box-shadow:0 30px 80px rgba(0,0,0,.55);display:none;z-index:10001;padding:14px}#ramifySettingsModal header{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}#ramifySettingsModal .tabrow{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px}#ramifySettingsModal .section{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:12px}#ramifySettingsModal .chip-btn,#ramifySettingsModal .icon-btn{cursor:pointer;border:1px solid rgba(255,255,255,.12);background:0 0;color:var(--text,#eaf2ff);padding:6px 10px;border-radius:10px}#ramifySettingsModal .chip-btn:hover{border-color:rgba(255,255,255,.22)}#ramifySettingsFallback{position:fixed;top:12px;right:12px;z-index:10002;display:none}#chipDownload,#chipUpload,#configBtn,#downloadBtn,#uploadBtn{color:#f7fbff!important;text-shadow:0 0 10px rgba(255,255,255,.18);font-weight:800!important;letter-spacing:.2px}#settingsDrop{display:none!important}</style><style id=ramify-fixes-0818>#calendarDrop,#internetDrop,#navDrop,#shortcutsDrop,#themeDrop,#timeDrop,#weatherDrop{position:fixed!important;top:64px!important;max-height:calc(100vh - 88px);overflow:auto;z-index:1002}</style><div id=ramifySettingsBackdrop></div><div role=dialog id=ramifySettingsModal aria-labelledby=ramifySettingsTitle aria-modal=true><header><h3 id=ramifySettingsTitle>Settings</h3><button class=chip-btn id=ramifySettingsClose>‚úñ</button></header><div class=tabrow><button class=chip-btn onclick=_ramifyShowAbout() id=ramifyTabAbout>‚ÑπÔ∏è About</button> <button class=chip-btn onclick=_ramifyShowContact() id=ramifyTabContact>‚úâÔ∏è Contact Owner</button> <button class=chip-btn onclick=_ramifyShowLegal() id=ramifyTabLegal>üõ°Ô∏è Copyright / Legal</button></div><div class=section id=settingsPane><b>Choose a section above.</b></div></div><button class=chip-btn onclick=_ramifyOpenSettings() id=ramifySettingsFallback title="Settings (fallback)">‚öôÔ∏è Settings</button><div class=menu id=topMenu><button class=icon-btn id=hamburger>‚ò∞</button> <button class=icon-btn id=openTasks>Tasks ‚úÖ</button> <button class=icon-btn id=quickNote>Notesüìù</button> <button class=icon-btn id=openThemes>Backgrounds üé®</button> <button class=chip-btn id=openCalendar>Calendar üìÖ</button> <button class=chip-btn id=toggleIEX>Internet üåç</button> <button class=chip-btn id=toggleStocks>Stocks üìà</button> <button class=chip-btn id=toggleNews>News üì∞</button><div class=spacer></div><div id=timeDisplay></div><div class=spacer></div><span id=weatherChip class=weather-chip>‚õÖ <span id=weatherNow>--¬∞</span> <small id=weatherCity></small></span> <button class=icon-btn id=openTime>Clock ‚è∞</button> <button class=icon-btn id=openReminders>Reminders üîî</button> <button class=chip-btn id=openNavigator>Shortcut Navigatorüß≠</button></div><div class=dropdown id=shortcutsDrop><h3>Shortcuts</h3><div class=row><input id=headingName placeholder="New heading‚Ä¶"> <button class=chip-btn onclick=App.addHeading()>Add</button></div><h3 style=margin-top:12px>Add Shortcut</h3><div class=row><select id=headingSelect></select></div><div class=row><input id=shortcutName placeholder=Name> <input id=shortcutURL placeholder="Your URL"></div><div class=row><button class=chip-btn onclick=App.addShortcut() style=width:100%>Add Shortcut</button></div><div style=margin-top:10px id=shortcutList></div></div><div class=dropdown id=themeDrop><h3>Theme</h3><select id=themeSelect onchange=App.changeTheme(this.value)><option value=""selected disabled hidden>Select Theme<option value=ocean>Ocean<option value=twilight>Twilight<option value=slate>Slate<option value=neon>Neon Pulse<option value=midnight>Midnight Aurora</select><h3 style=margin-top:12px>Wallpaper</h3><select id=wallpaperSelect onchange=App.changeWallpaper(this.value)><option value=none selected>No wallpaper<option value=beach>Beach<option value=nature>Nature<option value=filter>Fall</select> <small id=wpStatus style=color:var(--muted);display:block;margin-top:6px>Uses local files next to this HTML: <strong>Beach.jpg</strong>, <strong>Nature.jpg</strong>, <strong>Fall.jpg</strong>.</small></div><div class=dropdown id=timeDrop><h3>Clock</h3><div class=row style=flex-direction:column><button class=chip-btn onclick='App.setTimeFormat("12h")'>12-Hour</button> <button class=chip-btn onclick='App.setTimeFormat("24h")'>24-Hour</button> <button class=chip-btn onclick='App.setTimeFormat("date")'>Date</button> <button class=chip-btn onclick='App.setTimeFormat("day")'>Day</button> <button class=chip-btn onclick=App.toggleClock()>Clock On/Off</button></div></div><div class=dropdown id=calendarDrop><h3>Calendar</h3><div class=row style=margin-bottom:6px><select id=calProvider><option value=google selected>Google<option value=microsoft>Microsoft</select> <button class=chip-btn id=calHelpBtn title="How to embed">‚ùì</button> <button class=chip-btn id=calOpenTab title="Open in new tab">‚Üó</button></div><div class=row><input id=calendarURL placeholder="Paste embed URL"> <button class=chip-btn onclick=App.addCalendar()>Add</button></div><div class=hidden style=margin-top:8px;color:var(--muted);line-height:1.4 id=calHelp><strong>Google:</strong> Settings ‚ñ∏ your calendar ‚ñ∏ <em>Integrate calendar</em> ‚ñ∏ copy the <em>Embed code</em> URL (starts with <code>https://calendar.google.com/calendar/embed?</code>).<br><strong>Microsoft:</strong> Outlook Calendar ‚ñ∏ <em>Publish</em> / <em>Share</em> ‚ñ∏ copy the <em>Embed</em> link.</div><div class=hidden style=margin-top:8px;color:#ffb4b4;font-weight:700 id=calWarn></div></div><div class=dropdown style=left:auto;right:12px id=weatherDrop><h3>Weather</h3><div class=row><input id=wxQuery placeholder="Search city (e.g., Marquette)"type=search> <button class=chip-btn onclick=App.searchWeather()>Search</button></div><div style=margin-top:8px id=wxResults></div><hr style=border-color:rgba(255,255,255,.1)><div id=wxCurrent></div></div><div class=dropdown style=left:220px id=navDrop><h3>Navigator</h3><div class=row><input id=navSearch placeholder="Find heading‚Ä¶"type=search></div><div style=margin-top:8px;max-height:45vh;overflow:auto id=navResults></div></div><div class=dropdown style=left:360px id=internetDrop><h3>Internet</h3><div class=row><select id=iexEngine><option value=brave selected>Brave<option value=google>Google<option value=bing>Edge/Bing</select> <select id=iexStyle><option value=pinkblue selected>Pink/Blue<option value=teal>Teal<option value=amber>Amber<option value=slate>Slate<option value=neon>Neon Green</select> <button class=chip-btn id=iexToggleBtn>Search On/Off</button></div><small style=color:var(--muted);display:block;margin-top:6px>Search opens in a new tab. No embedded results.</small></div><aside class=tasks id=tasksPanel><div style=display:flex;align-items:center;justify-content:space-between;margin-bottom:8px><h3 style=margin:0>Task List</h3><div><button class=chip-btn onclick=App.addTask()>‚ûï Add Task</button> <button class=chip-btn onclick=App.toggleTasks()>‚ùå Close</button></div></div><div id=tasksBody></div></aside><div class=cal-win id=calWin><div class=cal-header id=calDrag><span>Calendar</span><div><button class=chip-btn onclick=App.resizeCalendar(60)>‚ûï</button> <button class=chip-btn onclick=App.resizeCalendar(-60)>‚ûñ</button> <button class=chip-btn onclick=App.closeCalendar()>‚ùå</button></div></div><div class="cal-resizer n"></div><div class="cal-resizer s"></div><div class="cal-resizer e"></div><div class="cal-resizer w"></div><div class="cal-resizer ne"></div><div class="cal-resizer nw"></div><div class="cal-resizer se"></div><div class="cal-resizer sw"></div><iframe class=cal-body frameborder=0 id=calendarFrame loading=lazy referrerpolicy=no-referrer-when-downgrade scrolling=no></iframe></div><aside class=dock id=leftDock><header><div style=display:flex;gap:8px;align-items:center><strong id=dockTitle>Feed</strong> <select id=dockSource class=small-select></select></div><div><button class=chip-btn id=dockClose>‚ùå</button></div></header><div class=body id=dockBody></div></aside><div class=hidden style=position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:1003 id=remOverlay></div><div class=hidden style="position:fixed;z-index:1004;left:50%;top:50%;transform:translate(-50%,-50%);width:min(360px,92vw);background:var(--panel);border:1px solid rgba(255,255,255,.08);box-shadow:var(--shadow);border-radius:14px;padding:16px"id=remModal><h3 style="margin:0 0 10px">Set Reminder</h3><input id=remTitle placeholder=Title> <input id=remDT type=datetime-local style=margin-top:8px> <select id=remEmoji style=margin-top:8px><option value="">Emoji<option>üéØ<option>üöÄ<option>üìÖ<option>üî•<option>üí°<option>‚úÖ<option>‚òï<option>üö∂</select><div class=row style=margin-top:10px><button class=chip-btn onclick=App.saveReminder() style=flex:1>Save</button> <button class=chip-btn onclick=App.closeReminder() style=flex:1>Cancel</button></div><hr style=border-color:rgba(255,255,255,.1)><h4 style="margin:6px 0 6px;color:var(--muted)">Saved</h4><ul id=remList style=list-style:none;padding:0;margin:0;display:grid;gap:6px></ul><hr style=border-color:rgba(255,255,255,.1)><h4 style="margin:6px 0;color:var(--muted)">Daily Message</h4><div style=display:flex;flex-direction:column;gap:8px><label style=display:flex;align-items:center;gap:8px><input id=dailyMsgToggle type=checkbox> Enable Daily Message</label> <select id=dailyMsgType><option value=biblical>Biblical<option value=motivational>Motivational</select></div></div><div class=hidden style="position:fixed;z-index:1005;left:50%;top:50%;transform:translate(-50%,-50%) scale(.98);background:linear-gradient(135deg,rgba(125,211,252,.95),rgba(56,189,248,.95));color:#04121f;padding:20px 24px;border-radius:18px;font-weight:900;min-width:280px;text-align:center;box-shadow:0 16px 60px rgba(0,0,0,.45);border:1px solid rgba(255,255,255,.35);backdrop-filter:blur(8px);display:flex;align-items:center;justify-content:center;gap:10px;opacity:0;pointer-events:none"id=remToast><span id=remToastEmoji class=emoji>üîî</span><span id=remToastText></span><button class=chip-btn onclick=App.hideToast()>‚ùå</button></div><div class=hidden style="position:fixed;z-index:1006;left:50%;top:50%;transform:translate(-50%,-50%) scale(.98);background:linear-gradient(135deg,rgba(167,139,250,.95),rgba(56,189,248,.95));color:#fff;padding:28px;border-radius:22px;font-weight:700;font-size:18px;min-width:300px;max-width:90vw;text-align:center;box-shadow:0 24px 80px rgba(0,0,0,.55);border:1px solid rgba(255,255,255,.25);backdrop-filter:blur(14px);display:flex;flex-direction:column;gap:14px;opacity:0;pointer-events:none"id=dailyPopup><div id=dailyPopupText>Daily Message</div><button class=chip-btn onclick=App.hideDailyPopup()>‚ùå Close</button></div><main class=content><section class="hidden iex iex--pinkblue"id=iexPanel><div class=addrbar><span>üåç</span> <input id=iexInput placeholder="Search the web‚Ä¶"type=search autocomplete=off> <button class=chip-btn id=iexGo>Go</button></div></section><div id=headingsRoot></div></main><style id=ramify-merge-2025-08-16b-css>.cards .card{background:linear-gradient(135deg,rgba(125,211,252,.12),rgba(125,211,252,.05) 60%),var(--card)!important;border-color:rgba(125,211,252,.28)!important}.card{position:relative}.card .tools{position:absolute;right:8px;top:8px;display:flex;gap:6px;opacity:0;transition:opacity .2s ease}.card:hover .tools{opacity:1}.task-actions .chip-btn,.tools .mini{height:28px;min-width:28px;padding:0 8px;font-size:12px;border-radius:8px;border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.25);color:var(--text);cursor:pointer}.task-actions .small-select,.tools .mini.small-select{padding:0 6px;min-width:unset;height:28px;font-size:12px}.dropdown.settings{position:absolute;top:44px;right:0;min-width:320px;background:var(--panel);border:1px solid rgba(125,211,252,.28);border-radius:14px;padding:12px;display:none;box-shadow:0 16px 50px rgba(0,0,0,.55)}.dropdown.settings h3{margin:4px 0 8px}.dropdown.settings .chip{padding:6px 10px;border:1px solid rgba(125,211,252,.28);border-radius:999px;background:rgba(255,255,255,.04);cursor:pointer}.dropdown.settings .chip:hover{background:rgba(255,255,255,.09)}.muted{color:var(--muted)}</style><style id=ramify-merge-2025-08-16c-css>#settingsGroup{position:relative}#settingsDrop.dropdown.settings{right:auto!important;left:-320px!important;max-width:420px}#configDrop{position:absolute;top:44px;left:-180px;min-width:200px;background:var(--panel);border:1px solid rgba(125,211,252,.28);border-radius:14px;padding:10px;display:none;box-shadow:0 16px 50px rgba(0,0,0,.55)}#configDrop .chip{padding:6px 10px;border:1px solid rgba(125,211,252,.28);border-radius:999px;background:rgba(255,255,255,.04);cursor:pointer;display:block;margin:4px 0}#configDrop .chip:hover{background:rgba(255,255,255,.09)}</style><style>.mini-menu{max-height:min(60vh,480px);overflow:auto}</style><style>#chipDownload,#chipUpload,#configBtn,#downloadBtn,#uploadBtn{color:#f7fbff!important;text-shadow:0 0 10px rgba(255,255,255,.18);font-weight:800!important;letter-spacing:.2px}#settingsDrop .section{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:12px;margin-top:10px}#settingsDrop h4{margin:0 0 6px 0;font-size:1rem}#settingsDrop .row{display:flex;gap:8px;flex-wrap:wrap}#settingsDrop a{color:var(--text)!important}#settingsDrop small{color:#d8e6ff!important;opacity:.9}</style><style id=ramify-bar-style>:root{--heading-bar-bg:linear-gradient(135deg,#39404a,#1b2430)}.heading-bar{background:var(--heading-bar-bg)!important;border:1px solid rgba(255,255,255,.08)!important}#barColorFab{position:fixed;right:16px;bottom:16px;z-index:9999;display:none;align-items:center;gap:6px;background:#202837;color:#eaf2ff;border:1px solid rgba(255,255,255,.1);padding:10px 12px;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,.35);cursor:pointer;user-select:none}#barColorFab small{opacity:.8}#barPalette{position:fixed;right:16px;bottom:68px;z-index:10000;display:none;background:#0f141c;border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:12px;box-shadow:0 10px 28px rgba(0,0,0,.45);min-width:240px}#barPalette h4{margin:0 0 8px;font-size:14px;letter-spacing:.3px}.swatches{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}.swatch{height:36px;border-radius:10px;cursor:pointer;border:1px solid rgba(255,255,255,.12)}.swatch:hover{transform:translateY(-1px)}.row{display:flex;gap:8px;align-items:center;margin-top:10px}.row input[type=text]{flex:1;padding:8px 10px;border-radius:10px;background:#0b0f14;color:#eaf2ff;border:1px solid rgba(255,255,255,.12)}</style><div id=barColorFab>üé® <small>Bar color</small></div><div role=dialog id=barPalette aria-label="Shortcut Bar Color"><h4>Shortcut Bar color</h4><div class=swatches><div class=swatch style=background:linear-gradient(135deg,#39404a,#1b2430) data-val=""></div><div class=swatch style=background:linear-gradient(135deg,#22d3ee,#a78bfa) data-val=linear-gradient(135deg,#22d3ee,#a78bfa)></div><div class=swatch style=background:linear-gradient(135deg,#10b981,#60a5fa) data-val=linear-gradient(135deg,#10b981,#60a5fa)></div><div class=swatch style=background:linear-gradient(135deg,#0ea5e9,#14b8a6) data-val=linear-gradient(135deg,#0ea5e9,#14b8a6)></div><div class=swatch style=background:linear-gradient(135deg,#ef4444,#f59e0b) data-val=linear-gradient(135deg,#ef4444,#f59e0b)></div><div class=swatch style=background:linear-gradient(135deg,#8b5cf6,#06b6d4) data-val=linear-gradient(135deg,#8b5cf6,#06b6d4)></div></div><div class=row><input id=barCustom placeholder="CSS color or gradient..."> <button id=barApply style="padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:#1a2230;color:#eaf2ff;cursor:pointer">Apply</button></div></div><style id=ramify-per-heading-style></style><div style="display:none;position:fixed;z-index:10000;background:#0f141c;border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:12px;box-shadow:0 10px 28px rgba(0,0,0,.45);min-width:240px"id=headingColorPalette><h4 style="margin:0 0 8px;font-size:14px;letter-spacing:.3px">Heading Bar color</h4><div class=swatches style=display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px><div class=swatch style="height:36px;border-radius:10px;cursor:pointer;border:1px solid rgba(255,255,255,.12);background:linear-gradient(135deg,#39404a,#1b2430)"data-val=""></div><div class=swatch style="height:36px;border-radius:10px;cursor:pointer;border:1px solid rgba(255,255,255,.12);background:linear-gradient(135deg,#22d3ee,#a78bfa)"data-val=linear-gradient(135deg,#22d3ee,#a78bfa)></div><div class=swatch style="height:36px;border-radius:10px;cursor:pointer;border:1px solid rgba(255,255,255,.12);background:linear-gradient(135deg,#10b981,#60a5fa)"data-val=linear-gradient(135deg,#10b981,#60a5fa)></div><div class=swatch style="height:36px;border-radius:10px;cursor:pointer;border:1px solid rgba(255,255,255,.12);background:linear-gradient(135deg,#0ea5e9,#14b8a6)"data-val=linear-gradient(135deg,#0ea5e9,#14b8a6)></div><div class=swatch style="height:36px;border-radius:10px;cursor:pointer;border:1px solid rgba(255,255,255,.12);background:linear-gradient(135deg,#ef4444,#f59e0b)"data-val=linear-gradient(135deg,#ef4444,#f59e0b)></div><div class=swatch style="height:36px;border-radius:10px;cursor:pointer;border:1px solid rgba(255,255,255,.12);background:linear-gradient(135deg,#8b5cf6,#06b6d4)"data-val=linear-gradient(135deg,#8b5cf6,#06b6d4)></div></div><div class=row style=display:flex;gap:8px;align-items:center;margin-top:10px><input id=headingBarCustom placeholder="CSS color or gradient..."style="flex:1;padding:8px 10px;border-radius:10px;background:#0b0f14;color:#eaf2ff;border:1px solid rgba(255,255,255,.12)"> <button id=headingBarApply style="padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:#1a2230;color:#eaf2ff;cursor:pointer">Apply</button></div></div><style>#barColorFab{display:none!important;visibility:hidden!important}</style><style>.card{background:var(--card)!important;color:var(--text)!important}#headingColorPalette{z-index:999999!important;position:fixed!important}</style><style>#headingColorPalette{z-index:2147483000!important;position:fixed!important}</style><style>#headingsRoot .heading-bar .chip-btn,#headingsRoot .heading-bar .heading-name,#headingsRoot .heading-bar .heading-toggle{color:var(--hb-fg,var(--text))!important}#headingsRoot .heading-bar .chip-btn{border-color:rgba(255,255,255,.22)!important}</style><style>#headingsRoot .heading-bar{--hb-fg:var(--text)}#headingsRoot .heading-bar>.heading-actions>.chip-btn,#headingsRoot .heading-bar>.heading-left .heading-name,#headingsRoot .heading-bar>.heading-left .heading-toggle{color:var(--hb-fg)!important}#headingsRoot .heading-bar .mini-menu,#headingsRoot .heading-bar .mini-menu *{color:var(--text)!important}</style>

<!-- ¬© 2025 Ramifyy ‚Äî All Rights Reserved. 
Unauthorized copying, distribution, or modification is strictly prohibited. 
RIP Jeff Horn üïäÔ∏è -->


<style id="ramify-settings-contrast">
  /* Higher-contrast, readable links in the Settings pane */
  #settingsPane a { 
    color: #a7d1ff; 
    text-decoration: underline; 
    font-weight: 600;
  }
  #settingsPane li { margin: 6px 0; }
</style>

<script>
/* Runtime loader: recreates original inline scripts in order (UTF‚Äë8 safe) */
(function(){
  var list = [{"t":"classic","d":"IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3ZhciBlPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzZXR0aW5nc0Ryb3AiKTtlJiZlLnJlbW92ZSgpfXQoKSxuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihlKXt0KCl9KS5vYnNlcnZlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCx7Y2hpbGRMaXN0OiEwLHN1YnRyZWU6ITB9KX0oKQ=="},{"t":"classic","d":"Y29uc3QgU3RvcmFnZSA9IHsgZ2V0KGtleSwgZmFsbGJhY2speyB0cnl7IGNvbnN0IHYgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpOyByZXR1cm4gdiA/IEpTT04ucGFyc2UodikgOiAoZmFsbGJhY2sgPz8gbnVsbCk7IH1jYXRjaHsgcmV0dXJuIGZhbGxiYWNrID8/IG51bGw7IH0gfSwgc2V0KGtleSx2YWwpeyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHZhbCkpOyB9LCBkZWwoa2V5KXsgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTsgfSB9OwoKICBjb25zdCBUSEVNRVMgPSB7IG9jZWFuOnsgYmc6JyMwNzEzMWEnLCB0ZXh0OicjZTZmN2ZmJywgYWNjZW50OicjN2RkM2ZjJywgcGFuZWw6JyMwZDE4MjAnLCBjYXJkOicjMGYxYzI1JyB9LCB0d2lsaWdodDp7IGJnOicjMGMwZjE3JywgdGV4dDonI2VlZjJmZicsIGFjY2VudDonI2E3OGJmYScsIHBhbmVsOicjMTIxNjI3JywgY2FyZDonIzE2MWIyZScgfSwgc2xhdGU6eyBiZzonIzBlMTExNicsIHRleHQ6JyNlYWVlZjUnLCBhY2NlbnQ6JyM2MGE1ZmEnLCBwYW5lbDonIzE0MTkyMicsIGNhcmQ6JyMxODIwMmInIH0sIG5lb246eyBiZzonIzA2MGEwZicsIHRleHQ6JyNlYWZmZmQnLCBhY2NlbnQ6JyMyMmY3YzMnLCBwYW5lbDonIzBhMGYxNicsIGNhcmQ6JyMwZDE1MjAnIH0sIG1pZG5pZ2h0OnsgYmc6JyMwNTA3MGQnLCB0ZXh0OicjZjFmN2ZmJywgYWNjZW50OicjZmY2NmM0JywgcGFuZWw6JyMwYTBjMTgnLCBjYXJkOicjMTAxNDI4JyB9IH07CiAgY29uc3QgQ09MT1JTID0geyBSZWQ6JyNlZjQ0NDQnLCBHcmVlbjonIzIyYzU1ZScsIEJsdWU6JyMzYjgyZjYnLCBZZWxsb3c6JyNmZmQ2MGEnLCBQaW5rOicjZWM0ODk5JywgR3JheTonIzljYTNhZicsIExhdmVuZGVyOicjYTc4YmZhJywgVGVhbDonIzE0YjhhNicsIE9yYW5nZTonI2ZiOTIzYycgfTsKICBjb25zdCBXQUxMUEFQRVJTID0geyBub25lOicnLCBiZWFjaDonQmVhY2guanBnJywgbmF0dXJlOidOYXR1cmUuanBnJywgZmlsdGVyOidGYWxsLmpwZycgfTsKCiAgYXN5bmMgZnVuY3Rpb24gZmV0Y2hKU09OKHVybCwgeyB0aW1lb3V0PTEyMDAwIH09e30peyBjb25zdCBjdHJsID0gbmV3IEFib3J0Q29udHJvbGxlcigpOyBjb25zdCB0dCA9IHNldFRpbWVvdXQoKCk9PmN0cmwuYWJvcnQoKSwgdGltZW91dCk7IHRyeXsgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godXJsLHsgc2lnbmFsOmN0cmwuc2lnbmFsIH0pOyBpZighcmVzLm9rKXsgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCkuY2F0Y2goKCk9PiAnJyk7IHRocm93IG5ldyBFcnJvcignSFRUUCAnK3Jlcy5zdGF0dXMrJyAnK3Jlcy5zdGF0dXNUZXh0Kycg4oCTICcrdGV4dC5zbGljZSgwLDEyMCkpOyB9IHJldHVybiBhd2FpdCByZXMuanNvbigpOyB9IGZpbmFsbHkgeyBjbGVhclRpbWVvdXQodHQpOyB9IH0KCiAgY29uc3QgQXBwID0gewogICAgX2dsb2JhbENsaWNrQ2xvc2UoZSl7CiAgICAgIGNvbnN0IG9wZW5lcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXAub3BlbicpOwogICAgICBvcGVuZXJzLmZvckVhY2goZWw9PnsKICAgICAgICBpZighZWwuY2xvc2VzdCgnLnRhc2tzLXBhbmVsJykpeyAvLyBrZWVwIHRhc2sgbGlzdCBhcyByZXF1ZXN0ZWQKICAgICAgICAgIGlmKCFlbC5jb250YWlucyhlLnRhcmdldCkpIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW4nKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgICAgICBtb3ZlVGFzayhpZCwgZGlyKXsKICAgICAgICAgIGNvbnN0IGxpc3QgPSAoQXBwLnN0YXRlICYmIEFwcC5zdGF0ZS50YXNrcykgPyBBcHAuc3RhdGUudGFza3MgOiAoU3RvcmFnZS5nZXQoJ3Rhc2tzJyl8fFtdKTsKICAgICAgICAgIGNvbnN0IGlkeCA9IGxpc3QuZmluZEluZGV4KHg9PnguaWQ9PT1pZCk7CiAgICAgICAgICBpZihpZHg8MCkgcmV0dXJuOwogICAgICAgICAgY29uc3QgaiA9IGlkeCArIGRpcjsKICAgICAgICAgIGlmKGo8MCB8fCBqPj1saXN0Lmxlbmd0aCkgcmV0dXJuOwogICAgICAgICAgW2xpc3RbaWR4XSwgbGlzdFtqXV0gPSBbbGlzdFtqXSwgbGlzdFtpZHhdXTsKICAgICAgICAgIGlmKEFwcC5zdGF0ZSkgQXBwLnN0YXRlLnRhc2tzID0gbGlzdDsKICAgICAgICAgIFN0b3JhZ2Uuc2V0KCd0YXNrcycsIGxpc3QpOwogICAgICAgICAgaWYodHlwZW9mIEFwcC5yZW5kZXJUYXNrcz09PSdmdW5jdGlvbicpIEFwcC5yZW5kZXJUYXNrcygpOwogICAgICAgIH0sCiAgICBzdGF0ZTogewogICAgICBoZWFkaW5nczogU3RvcmFnZS5nZXQoJ2hlYWRpbmdzJywgW10pLAogICAgICBzaG9ydGN1dHM6IFN0b3JhZ2UuZ2V0KCdzaG9ydGN1dHMnLCBbXSksCiAgICAgIGNvbGxhcHNlZDogU3RvcmFnZS5nZXQoJ2NvbGxhcHNlZEhlYWRpbmdzJywge30pLAogICAgICB0YXNrczogU3RvcmFnZS5nZXQoJ3Rhc2tzJywgW10pLAogICAgICBjbG9ja0Zvcm1hdDogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Nsb2NrRm9ybWF0JykgfHwgJzEyaCcsCiAgICAgIGNsb2NrVmlzaWJsZTogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Nsb2NrVmlzaWJsZScpICE9PSAnZmFsc2UnLAogICAgICB0aGVtZTogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RoZW1lJykgfHwgJ29jZWFuJywKICAgICAgd2FsbHBhcGVyOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnd2FsbHBhcGVyJykgfHwgJ25vbmUnLAogICAgICBjYWw6IFN0b3JhZ2UuZ2V0KCdjYWxlbmRhclNldHRpbmdzJywgeyB3aWR0aDonODYwcHgnLCBoZWlnaHQ6JzYyMHB4JywgdG9wOicxMjBweCcsIGxlZnQ6JzEyMHB4JywgdXJsOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2FsZW5kYXJVUkwnKSB8fCAnJywgdmlzaWJsZTpmYWxzZSB9KSwKICAgICAgd2VhdGhlcjogU3RvcmFnZS5nZXQoJ3dlYXRoZXInLCB7IG5hbWU6JycsIGxhdDpudWxsLCBsb246bnVsbCwgdGVtcDpudWxsIH0pLAogICAgICBpZXg6IFN0b3JhZ2UuZ2V0KCdpZXgnLCB7IHZpc2libGU6ZmFsc2UsIGVuZ2luZTonYnJhdmUnLCBzdHlsZToncGlua2JsdWUnIH0pLAogICAgICBkb2NrOiBTdG9yYWdlLmdldCgnZG9jaycsIHsgb3BlbjpmYWxzZSwgbW9kZTonJywgc291cmNlOicnIH0pCiAgICB9LAoKICAgIGluaXQoKXsKICAgICAgLy8gTWVudSBoYW5kbGVycwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGFtYnVyZ2VyJykub25jbGljayAgID0gKGUpPT57IGUuc3RvcFByb3BhZ2F0aW9uKCk7IHRvZ2dsZURyb3Bkb3duKCdzaG9ydGN1dHNEcm9wJyk7IH07CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuVGFza3MnKS5vbmNsaWNrICAgPSAoZSk9PnsgZS5zdG9wUHJvcGFnYXRpb24oKTsgQXBwLnRvZ2dsZVRhc2tzKCk7IH07CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuVGhlbWVzJykub25jbGljayAgPSAoZSk9PnsgZS5zdG9wUHJvcGFnYXRpb24oKTsgdG9nZ2xlRHJvcGRvd24oJ3RoZW1lRHJvcCcpOyB9OwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlblRpbWUnKS5vbmNsaWNrICAgID0gKGUpPT57IGUuc3RvcFByb3BhZ2F0aW9uKCk7IHRvZ2dsZURyb3Bkb3duKCd0aW1lRHJvcCcpOyB9OwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlbkNhbGVuZGFyJykub25jbGljaz0gKGUpPT57IGUuc3RvcFByb3BhZ2F0aW9uKCk7IHRvZ2dsZURyb3Bkb3duKCdjYWxlbmRhckRyb3AnKTsgfTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5OYXZpZ2F0b3InKS5vbmNsaWNrPShlKT0+eyBlLnN0b3BQcm9wYWdhdGlvbigpOyBBcHAucmVuZGVyTmF2aWdhdG9yKCcnKTsgdG9nZ2xlRHJvcGRvd24oJ25hdkRyb3AnKTsgc2V0VGltZW91dCgoKT0+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hdlNlYXJjaCcpLmZvY3VzKCksNTApOyB9OwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlSUVYJykub25jbGljayAgID0gKGUpPT57IGUuc3RvcFByb3BhZ2F0aW9uKCk7IHRvZ2dsZURyb3Bkb3duKCdpbnRlcm5ldERyb3AnKTsgfTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZVN0b2NrcycpLm9uY2xpY2s9ICgpPT4gQXBwLnRvZ2dsZURvY2soJ3N0b2NrcycpOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlTmV3cycpLm9uY2xpY2sgID0gKCk9PiBBcHAudG9nZ2xlRG9jaygnbmV3cycpOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG9ja0Nsb3NlJykub25jbGljayAgID0gKCk9PiBBcHAuY2xvc2VEb2NrKCk7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkb2NrU291cmNlJykub25jaGFuZ2UgPSAoZSk9PiBBcHAubG9hZERvY2tTb3VyY2UoZS50YXJnZXQudmFsdWUpOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlblJlbWluZGVycycpLm9uY2xpY2s9IChlKT0+eyBlLnN0b3BQcm9wYWdhdGlvbigpOyBBcHAub3BlblJlbWluZGVyKCk7IH07CgkgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdxdWlja05vdGUnKS5vbmNsaWNrPWU9PntlLnN0b3BQcm9wYWdhdGlvbigpO3dpbmRvdy5vcGVuKCdmaWxlOi8vL0M6L1VzZXJzL2RlYW5yL0Rlc2t0b3AvUmFtaWZ5L05vdGVUYWtpbmcuaHRtbCcsJ19ibGFuaycpO307CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3ZWF0aGVyQ2hpcCcpLm9uY2xpY2sgPSAoZSk9PnsgZS5zdG9wUHJvcGFnYXRpb24oKTsgdG9nZ2xlRHJvcGRvd24oJ3dlYXRoZXJEcm9wJyk7IH07CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxIZWxwQnRuJykub25jbGljayAgPSAoZSk9PnsgZS5zdG9wUHJvcGFnYXRpb24oKTsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbEhlbHAnKS5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTsgfTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbE9wZW5UYWInKS5vbmNsaWNrICA9ICgpPT57IGNvbnN0IHVybCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxlbmRhclVSTCcpLnZhbHVlLnRyaW0oKSB8fCBBcHAuc3RhdGUuY2FsLnVybDsgaWYodXJsKSB3aW5kb3cub3Blbih1cmwsJ19ibGFuaycpOyB9OwoKICAgICAgLy8gSW50ZXJuZXQgZHJvcGRvd24gY29udHJvbHMKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lleFRvZ2dsZUJ0bicpLm9uY2xpY2sgPSAoKT0+IEFwcC50b2dnbGVJRVgoKTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lleEVuZ2luZScpLm9uY2hhbmdlICAgPSAoZSk9PiBBcHAuc2V0SUVYRW5naW5lKGUudGFyZ2V0LnZhbHVlKTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lleFN0eWxlJykub25jaGFuZ2UgICAgPSAoZSk9PiBBcHAuc2V0SUVYU3R5bGUoZS50YXJnZXQudmFsdWUpOwoKICAgICAgLy8gSW50ZXJuZXQgYmFyIGFjdGlvbnMKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lleEdvJykub25jbGljayA9IEFwcC5pZXhOYXZpZ2F0ZTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lleElucHV0JykuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKT0+eyBpZihlLmtleT09PSdFbnRlcicpeyBlLnByZXZlbnREZWZhdWx0KCk7IEFwcC5pZXhOYXZpZ2F0ZSgpOyB9IH0pOwoKICAgICAgLy8gT3ZlcmxheSBjbG9zZQogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtT3ZlcmxheScpLm9uY2xpY2sgPSBBcHAuY2xvc2VSZW1pbmRlcjsKCiAgICAgIC8vIEdsb2JhbCBrZXlzCiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSk9PnsgaWYoZS5rZXk9PT0nRXNjYXBlJykgaGlkZUFsbERyb3Bkb3ducygpOyB9KTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZSk9PnsgaWYoZS50YXJnZXQgJiYgZS50YXJnZXQuaWQ9PT0nbmF2U2VhcmNoJykgQXBwLnJlbmRlck5hdmlnYXRvcihlLnRhcmdldC52YWx1ZSk7IH0pOwoKICAgICAgLy8gV2VhdGhlciBkZWZhdWx0CiAgICAgIGlmKCFBcHAuc3RhdGUud2VhdGhlciB8fCAhQXBwLnN0YXRlLndlYXRoZXIubGF0KXsgQXBwLnN0YXRlLndlYXRoZXIgPSB7IG5hbWU6J1N1cmZzaWRlLCBDQScsIGxhdDozMy43NDIsIGxvbjotMTE4LjExMCwgdGVtcDpudWxsIH07IFN0b3JhZ2Uuc2V0KCd3ZWF0aGVyJywgQXBwLnN0YXRlLndlYXRoZXIpOyB9CgogICAgICBBcHAucmVuZGVyQWxsKCk7CiAgICAgIEFwcC5hcHBseVRoZW1lKCk7CiAgICAgIEFwcC5hcHBseUNsb2NrKHRydWUpOwogICAgICBBcHAubW91bnRDYWxlbmRhckRyYWcoKTsKICAgICAgQXBwLm1vdW50Q2FsZW5kYXJSZXNpemVycygpOwogICAgICBBcHAucmVmcmVzaFdlYXRoZXIoKTsKCiAgICAgIC8vIFJlc3RvcmUgc2VsZWN0aW9ucwogICAgICBjb25zdCB0cz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhlbWVTZWxlY3QnKTsgaWYodHMpIHRzLnZhbHVlPUFwcC5zdGF0ZS50aGVtZTsKICAgICAgY29uc3Qgd3M9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dhbGxwYXBlclNlbGVjdCcpOyBpZih3cykgd3MudmFsdWU9QXBwLnN0YXRlLndhbGxwYXBlcjsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lleEVuZ2luZScpLnZhbHVlID0gQXBwLnN0YXRlLmlleC5lbmdpbmUgfHwgJ2JyYXZlJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lleFN0eWxlJykudmFsdWUgID0gQXBwLnN0YXRlLmlleC5zdHlsZSAgfHwgJ3BpbmtibHVlJzsKCiAgICAgIHNldEludGVydmFsKEFwcC5jaGVja1JlbWluZGVycywgMzAwMDApOwogICAgICAvLyBEYWlseSBNZXNzYWdlcyBzZXR1cAogICAgICBjb25zdCBkbVRvZ2dsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYWlseU1zZ1RvZ2dsZScpOwogICAgICBjb25zdCBkbVR5cGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGFpbHlNc2dUeXBlJyk7CiAgICAgIGlmKGRtVG9nZ2xlICYmIGRtVHlwZSl7CiAgICAgICAgZG1Ub2dnbGUub25jaGFuZ2U9KGUpPT57IAogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2RhaWx5TXNnRW5hYmxlZCcsIGUudGFyZ2V0LmNoZWNrZWQpOyAKICAgICAgICAgIC8vIE5FVzogc2hvdyBmaXJzdCBtZXNzYWdlIGltbWVkaWF0ZWx5IG9uIGZpcnN0IGVuYWJsZQogICAgICAgICAgaWYoZS50YXJnZXQuY2hlY2tlZCAmJiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZGFpbHlNc2dFdmVyRW5hYmxlZCcpIT09J3RydWUnKXsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2RhaWx5TXNnRXZlckVuYWJsZWQnLCd0cnVlJyk7CiAgICAgICAgICAgIGNvbnN0IHR5cGU9bG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2RhaWx5TXNnVHlwZScpfHwnbW90aXZhdGlvbmFsJzsKICAgICAgICAgICAgY29uc3QgYXJyPUFwcC5kYWlseU1lc3NhZ2VzW3R5cGVdfHxbXTsKICAgICAgICAgICAgY29uc3QgbXNnPWFyclswXXx8J0hhdmUgYSBncmVhdCBkYXkhJzsKICAgICAgICAgICAgQXBwLnNob3dEYWlseVBvcHVwKG1zZyk7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBkbVR5cGUub25jaGFuZ2U9KGUpPT57IGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdkYWlseU1zZ1R5cGUnLCBlLnRhcmdldC52YWx1ZSk7IH07CiAgICAgICAgZG1Ub2dnbGUuY2hlY2tlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkYWlseU1zZ0VuYWJsZWQnKT09PSd0cnVlJzsKICAgICAgICBkbVR5cGUudmFsdWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZGFpbHlNc2dUeXBlJyl8fCdtb3RpdmF0aW9uYWwnOwogICAgICB9CiAgICAgIHNldEludGVydmFsKEFwcC5jaGVja0RhaWx5TWVzc2FnZSwgNjAwMDApOwoKICAgIH0sCgogICAgcmVuZGVyQWxsKCl7CiAgICAgIEFwcC5yZW5kZXJIZWFkaW5nc1VJKCk7CiAgICAgIEFwcC5yZW5kZXJTaG9ydGN1dHNJbnRvSGVhZGluZ3MoKTsKICAgICAgQXBwLnJlbmRlclRhc2tzKCk7CiAgICAgIEFwcC5wb3B1bGF0ZUhlYWRpbmdTZWxlY3QoKTsKICAgICAgaWYoQXBwLnN0YXRlLmNhbC51cmwgJiYgQXBwLnN0YXRlLmNhbC52aXNpYmxlKSBBcHAub3BlbkNhbGVuZGFyKHRydWUpOwogICAgICBpZihBcHAuc3RhdGUuaWV4LnZpc2libGUpIEFwcC5zaG93SUVYKCk7IGVsc2UgQXBwLmhpZGVJRVgoKTsKICAgICAgaWYoQXBwLnN0YXRlLmRvY2sub3BlbikgQXBwLm9wZW5Eb2NrKEFwcC5zdGF0ZS5kb2NrLm1vZGUsIHRydWUpOwogICAgfSwKCiAgICAvKiBIZWFkaW5ncyAqLwogICAgcmVuZGVySGVhZGluZ3NVSSgpewogICAgICBjb25zdCByb290ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlYWRpbmdzUm9vdCcpOyByb290LmlubmVySFRNTD0nJzsKICAgICAgQXBwLnN0YXRlLmhlYWRpbmdzLmZvckVhY2gobmFtZT0+ewogICAgICAgIGNvbnN0IGlzQ29sbGFwc2VkID0gISFBcHAuc3RhdGUuY29sbGFwc2VkW25hbWVdOwogICAgICAgIGNvbnN0IGJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VjdGlvbicpOwogICAgICAgIGJsb2NrLmNsYXNzTmFtZSA9ICdoZWFkaW5nLWJsb2NrJzsgYmxvY2suaWQgPSBgbWFpbi1oZWFkaW5nLSR7bmFtZX1gOwogICAgICAgIGJsb2NrLmlubmVySFRNTCA9IGAKICAgICAgICAgIDxkaXYgY2xhc3M9ImhlYWRpbmctYmFyIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iaGVhZGluZy1sZWZ0Ij4KICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJoZWFkaW5nLXRvZ2dsZSIgZGF0YS1uYW1lPSIke25hbWV9Ij4ke2lzQ29sbGFwc2VkID8gJ+KWticgOiAn4pa8J308L2J1dHRvbj4KICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iaGVhZGluZy1uYW1lIj4ke25hbWV9PC9zcGFuPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iaGVhZGluZy1hY3Rpb25zIj4KICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJjaGlwLWJ0biIgb25jbGljaz0iQXBwLm9wZW5BbGxTaG9ydGN1dHMoJyR7bmFtZX0nKSI+8J+UlyBPcGVuIGFsbDwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImNoaXAtYnRuIiBvbmNsaWNrPSJBcHAudG9nZ2xlSGVhZGluZ0FjdGlvbnMoZXZlbnQsJyR7bmFtZX0nKSI+4ouvPC9idXR0b24+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZHJvcGRvd24gbWluaS1tZW51IiBpZD0iaGEtJHtuYW1lfSI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPjxidXR0b24gY2xhc3M9ImNoaXAtYnRuIiBvbmNsaWNrPSJBcHAuYWRkU2hvcnRjdXRJbmxpbmUoJyR7bmFtZX0nKSI+4p6VIEFkZCBzaG9ydGN1dCBoZXJlPC9idXR0b24+PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciIHN0eWxlPSJtYXJnaW4tdG9wOjZweCI+PGJ1dHRvbiBjbGFzcz0iY2hpcC1idG4iIG9uY2xpY2s9IkFwcC5tb3ZlSGVhZGluZygnJHtuYW1lfScsIC0xKSI+4qyGIE1vdmUgdXA8L2J1dHRvbj48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyIgc3R5bGU9Im1hcmdpbi10b3A6NnB4Ij48YnV0dG9uIGNsYXNzPSJjaGlwLWJ0biIgb25jbGljaz0iQXBwLm1vdmVIZWFkaW5nKCcke25hbWV9JywgMSkiPuKshyBNb3ZlIGRvd248L2J1dHRvbj48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyIgc3R5bGU9Im1hcmdpbi10b3A6NnB4Ij48YnV0dG9uIGNsYXNzPSJjaGlwLWJ0biIgb25jbGljaz0iQXBwLnJlbmFtZUhlYWRpbmcoJyR7bmFtZX0nKSI+4pyP77iPIFJlbmFtZTwvYnV0dG9uPjwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icm93IiBzdHlsZT0ibWFyZ2luLXRvcDo2cHgiPjxidXR0b24gY2xhc3M9ImNoaXAtYnRuIiBvbmNsaWNrPSJBcHAuZGVsZXRlSGVhZGluZygnJHtuYW1lfScpIj7wn5eR77iPIERlbGV0ZTwvYnV0dG9uPjwvZGl2PgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZHMgJHtpc0NvbGxhcHNlZCA/ICcnIDogJ29wZW4nfSIgaWQ9ImNhcmRzLSR7bmFtZX0iPjwvZGl2PmA7CiAgICAgICAgcm9vdC5hcHBlbmRDaGlsZChibG9jayk7CiAgICAgIH0pOwoKICAgICAgLy8gVG9nZ2xlIGhhbmRsZXJzIChpbnN0YW50IGFycm93IHVwZGF0ZSkKICAgICAgcm9vdC5xdWVyeVNlbGVjdG9yQWxsKCcuaGVhZGluZy10b2dnbGUnKS5mb3JFYWNoKGJ0bj0+ewogICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57CiAgICAgICAgICBjb25zdCBuYW1lID0gYnRuLmRhdGFzZXQubmFtZTsgY29uc3QgaXNDb2xsYXBzZWQgPSAhIUFwcC5zdGF0ZS5jb2xsYXBzZWRbbmFtZV07IGNvbnN0IG5leHQgPSAhaXNDb2xsYXBzZWQ7IEFwcC5zdGF0ZS5jb2xsYXBzZWRbbmFtZV0gPSBuZXh0ID8gMSA6IDA7IFN0b3JhZ2Uuc2V0KCdjb2xsYXBzZWRIZWFkaW5ncycsIEFwcC5zdGF0ZS5jb2xsYXBzZWQpOyBjb25zdCBjYXJkcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjYXJkcy0ke25hbWV9YCk7IGlmKG5leHQpeyBjYXJkcy5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuJyk7IGJ0bi50ZXh0Q29udGVudD0n4pa2JzsgfSBlbHNlIHsgY2FyZHMuY2xhc3NMaXN0LmFkZCgnb3BlbicpOyBidG4udGV4dENvbnRlbnQ9J+KWvCc7IH0KICAgICAgICB9KTsKICAgICAgfSk7CgogICAgICAvLyBEcm9wIHRhcmdldHMKICAgICAgQXBwLnN0YXRlLmhlYWRpbmdzLmZvckVhY2gobmFtZT0+ewogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjYXJkcy0ke25hbWV9YCk7IGlmKCFjb250YWluZXIpIHJldHVybjsKICAgICAgICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCAoZSk9PiBlLnByZXZlbnREZWZhdWx0KCkpOwogICAgICAgIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgKGUpPT57IGUucHJldmVudERlZmF1bHQoKTsgY29uc3QgZHJhZ2dlZElkID0gZS5kYXRhVHJhbnNmZXIuZ2V0RGF0YSgndGV4dC9wbGFpbicpOyBjb25zdCBzcmNIZWFkaW5nID0gZS5kYXRhVHJhbnNmZXIuZ2V0RGF0YSgndGV4dC94LXNyY0hlYWRpbmcnKTsgY29uc3QgZHJhZ2dlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRyYWdnZWRJZCk7IGlmKCFkcmFnZ2VkKSByZXR1cm47IGlmKGRyYWdnZWQucGFyZW50RWxlbWVudCAhPT0gY29udGFpbmVyKSBjb250YWluZXIuYXBwZW5kQ2hpbGQoZHJhZ2dlZCk7IGNvbnN0IGlkTnVtID0gTnVtYmVyKGRyYWdnZWRJZC5yZXBsYWNlKCdjYXJkLScsJycpKTsgQXBwLm1vdmVTaG9ydGN1dEJldHdlZW5IZWFkaW5ncyhpZE51bSwgc3JjSGVhZGluZywgbmFtZSk7IH0pOwogICAgICB9KTsKICAgIH0sCgogICAgb3BlbkFsbFNob3J0Y3V0cyhoZWFkaW5nKXsKICAgICAgY29uc3QgYnVja2V0ID0gQXBwLnN0YXRlLnNob3J0Y3V0cy5maW5kKGg9PmguaGVhZGluZz09PWhlYWRpbmcpOwogICAgICBpZighYnVja2V0IHx8ICFidWNrZXQuc2hvcnRjdXRzPy5sZW5ndGgpIHJldHVybjsKICAgICAgY29uc3QgdXJscyA9IGJ1Y2tldC5zaG9ydGN1dHMubWFwKHNjPT5zYy51cmwpLmZpbHRlcihCb29sZWFuKTsKICAgICAgY29uc3QgTUFYID0gODsgLy8gbW9zdCBicm93c2VycyBhbGxvdyBhIGJ1cnN0IGlmIHdpdGhpbiBjbGljayBnZXN0dXJlCiAgICAgIGNvbnN0IHRvT3BlbiA9IHVybHMuc2xpY2UoMCwgTUFYKTsKICAgICAgbGV0IG9wZW5lZCA9IDA7CiAgICAgIHRvT3Blbi5mb3JFYWNoKHU9PnsgdHJ5eyBjb25zdCBhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsgYS5ocmVmPXU7IGEudGFyZ2V0PSdfYmxhbmsnOyBhLnJlbD0nbm9vcGVuZXInOyBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOyBhLmNsaWNrKCk7IGEucmVtb3ZlKCk7IG9wZW5lZCsrOyB9Y2F0Y2h7fSB9KTsKICAgICAgaWYodXJscy5sZW5ndGggPiBNQVgpeyBBcHAuc2hvd1RvYXN0KGBPcGVuZWQgJHtvcGVuZWR9IHRhYnMgKGZpcnN0ICR7TUFYfSkuIENsaWNrIGFnYWluIHRvIG9wZW4gdGhlIG5leHQgc2V0LmAsICfwn5SXJyk7IH0KICAgICAgaWYob3BlbmVkPT09MCl7IEFwcC5zaG93VG9hc3QoJ1lvdXIgYnJvd3NlciBibG9ja2VkIHBvcC11cHMuIEFsbG93IHBvcC11cHMgZm9yIHRoaXMgcGFnZSB0byBvcGVuIGFsbC4nLCAn4pqg77iPJyk7IH0KICAgIH0sCgogICAgcmVuZGVyU2hvcnRjdXRzSW50b0hlYWRpbmdzKCl7CiAgICAgIGNvbnN0IG1hcCA9IG5ldyBNYXAoQXBwLnN0YXRlLnNob3J0Y3V0cy5tYXAoaD0+W2guaGVhZGluZywgaC5zaG9ydGN1dHNdKSk7CiAgICAgIEFwcC5zdGF0ZS5oZWFkaW5ncy5mb3JFYWNoKG5hbWU9PnsgY29uc3QgY29udGFpbmVyPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjYXJkcy0ke25hbWV9YCk7IGlmKCFjb250YWluZXIpIHJldHVybjsgY29udGFpbmVyLmlubmVySFRNTD0nJzsgKG1hcC5nZXQobmFtZSkgfHwgW10pLmZvckVhY2goaXRlbT0+IEFwcC5jcmVhdGVDYXJkKGNvbnRhaW5lciwgbmFtZSwgaXRlbSkpOyB9KTsKICAgIH0sCgogICAgY3JlYXRlQ2FyZChjb250YWluZXIsIGhlYWRpbmdOYW1lLCBpdGVtKXsKICAgICAgY29uc3QgY2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBjYXJkLmNsYXNzTmFtZT0nY2FyZCc7IGNhcmQuaWQgPSBgY2FyZC0ke2l0ZW0uaWR9YDsgY29uc3QgaGV4ID0gQ09MT1JTW2l0ZW0uY29sb3JOYW1lXSB8fCBpdGVtLmNvbG9yIHx8ICd2YXIoLS1jYXJkKSc7IGNhcmQuc3R5bGUuYmFja2dyb3VuZCA9IGhleDsKICAgICAgdHJ5eyBjb25zdCB1cmwgPSBuZXcgVVJMKGl0ZW0udXJsKTsgY29uc3QgZmF2aWNvbiA9IGBodHRwczovL3d3dy5nb29nbGUuY29tL3MyL2Zhdmljb25zP3N6PTY0JmRvbWFpbj0ke3VybC5ob3N0bmFtZX1gOyBjYXJkLmlubmVySFRNTCA9IGA8aW1nIHNyYz0iJHtmYXZpY29ufSIgYWx0PSIiLz48cD4ke2l0ZW0ubmFtZX08L3A+YDsgfWNhdGNoeyBjYXJkLmlubmVySFRNTCA9IGA8cD4ke2l0ZW0ubmFtZX08L3A+YDsgfQogICAgICBjYXJkLm9uY2xpY2sgPSAoZSk9PnsgaWYoZS50YXJnZXQuY2xvc2VzdCgnYnV0dG9uLHNlbGVjdCcpKSByZXR1cm47IHdpbmRvdy5vcGVuKGl0ZW0udXJsLCdfYmxhbmsnKTsgfTsKICAgICAgY2FyZC5kcmFnZ2FibGU9dHJ1ZTsgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCAoZSk9PnsgY2FyZC5jbGFzc0xpc3QuYWRkKCdkcmFnZ2luZycpOyBlLmRhdGFUcmFuc2Zlci5zZXREYXRhKCd0ZXh0L3BsYWluJywgY2FyZC5pZCk7IGUuZGF0YVRyYW5zZmVyLnNldERhdGEoJ3RleHQveC1zcmNIZWFkaW5nJywgaGVhZGluZ05hbWUpOyB9KTsgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgKCk9PiBjYXJkLmNsYXNzTGlzdC5yZW1vdmUoJ2RyYWdnaW5nJykpOwogICAgICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCAoZSk9PiBlLnByZXZlbnREZWZhdWx0KCkpOwogICAgICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIChlKT0+eyBlLnByZXZlbnREZWZhdWx0KCk7IGNvbnN0IGRyYWdnZWRJZD1lLmRhdGFUcmFuc2Zlci5nZXREYXRhKCd0ZXh0L3BsYWluJyk7IGNvbnN0IGRyYWdnZWQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZHJhZ2dlZElkKTsgaWYoZHJhZ2dlZCAmJiBkcmFnZ2VkIT09Y2FyZCl7IGNvbnRhaW5lci5pbnNlcnRCZWZvcmUoZHJhZ2dlZCwgY2FyZCk7IEFwcC5wZXJzaXN0Q2FyZHNPcmRlcihoZWFkaW5nTmFtZSk7IH0gfSk7CiAgICAgIEFwcC5pbmplY3RTaG9ydGN1dFJvdyhoZWFkaW5nTmFtZSwgaXRlbSk7CiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjYXJkKTsKICAgIH0sCgogICAgaW5qZWN0U2hvcnRjdXRSb3coaGVhZGluZ05hbWUsIGl0ZW0pewogICAgICBjb25zdCBsaXN0V3JhcElkID0gYGFkbWluLSR7aGVhZGluZ05hbWV9YDsgbGV0IHdyYXA9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobGlzdFdyYXBJZCk7CiAgICAgIGlmKCF3cmFwKXsgd3JhcD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgd3JhcC5pZD1saXN0V3JhcElkOyB3cmFwLnN0eWxlLm1hcmdpblRvcD0nOHB4Jzsgd3JhcC5pbm5lckhUTUw9YDxoNCBzdHlsZT0ibWFyZ2luOjhweCAwIDZweCI+JHtoZWFkaW5nTmFtZX08L2g0PmA7IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG9ydGN1dExpc3QnKS5hcHBlbmRDaGlsZCh3cmFwKTsgfQogICAgICBpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgcm93LSR7aXRlbS5pZH1gKSkgcmV0dXJuOwogICAgICBjb25zdCByb3c9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IHJvdy5pZD1gcm93LSR7aXRlbS5pZH1gOyByb3cuc3R5bGUuZGlzcGxheT0nZmxleCc7IHJvdy5zdHlsZS5hbGlnbkl0ZW1zPSdjZW50ZXInOyByb3cuc3R5bGUuZ2FwPSc2cHgnOyByb3cuc3R5bGUubWFyZ2luPSc2cHggMCc7CiAgICAgIHJvdy5pbm5lckhUTUwgPSBgPHNwYW4gc3R5bGU9ImZsZXg6MSI+JHtpdGVtLm5hbWV9PC9zcGFuPjxidXR0b24gY2xhc3M9ImNoaXAtYnRuIiBvbmNsaWNrPSJBcHAuZWRpdFNob3J0Y3V0KCR7aXRlbS5pZH0pIj7inI/vuI88L2J1dHRvbj48c2VsZWN0IGNsYXNzPSJzbWFsbC1zZWxlY3QiIG9uY2hhbmdlPSJBcHAuY2hhbmdlU2hvcnRjdXRDb2xvcigke2l0ZW0uaWR9LCB0aGlzLnZhbHVlKSI+JHtPYmplY3Qua2V5cyhDT0xPUlMpLm1hcChuPT5gPG9wdGlvbiB2YWx1ZT0nJHtufScgJHtpdGVtLmNvbG9yTmFtZT09PW4/InNlbGVjdGVkIjoiIn0+JHtufTwvb3B0aW9uPmApLmpvaW4oJycpfTwvc2VsZWN0PjxidXR0b24gY2xhc3M9ImNoaXAtYnRuIiBvbmNsaWNrPSJBcHAuZGVsZXRlU2hvcnRjdXQoJHtpdGVtLmlkfSkiPvCfl5HvuI88L2J1dHRvbj5gOwogICAgICB3cmFwLmFwcGVuZENoaWxkKHJvdyk7CiAgICB9LAoKICAgIHBvcHVsYXRlSGVhZGluZ1NlbGVjdCgpeyBjb25zdCBzZWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlYWRpbmdTZWxlY3QnKTsgc2VsLmlubmVySFRNTCA9IEFwcC5zdGF0ZS5oZWFkaW5ncy5tYXAoaD0+YDxvcHRpb24gdmFsdWU9IiR7aH0iPiR7aH08L29wdGlvbj5gKS5qb2luKCcnKTsgfSwKICAgIGFkZEhlYWRpbmcoKXsgY29uc3QgbmFtZT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVhZGluZ05hbWUnKS52YWx1ZS50cmltKCk7IGlmKCFuYW1lIHx8IEFwcC5zdGF0ZS5oZWFkaW5ncy5pbmNsdWRlcyhuYW1lKSkgcmV0dXJuOyBBcHAuc3RhdGUuaGVhZGluZ3MucHVzaChuYW1lKTsgU3RvcmFnZS5zZXQoJ2hlYWRpbmdzJywgQXBwLnN0YXRlLmhlYWRpbmdzKTsgQXBwLnJlbmRlckhlYWRpbmdzVUkoKTsgQXBwLnBvcHVsYXRlSGVhZGluZ1NlbGVjdCgpOyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVhZGluZ05hbWUnKS52YWx1ZT0nJzsgfSwKICAgIHJlbmFtZUhlYWRpbmcob2xkTmFtZSl7IGNvbnN0IG5uPXByb21wdCgnTmV3IGhlYWRpbmcgbmFtZTonLCBvbGROYW1lKTsgaWYoIW5uIHx8IG5uPT09b2xkTmFtZSB8fCBBcHAuc3RhdGUuaGVhZGluZ3MuaW5jbHVkZXMobm4pKSByZXR1cm47IEFwcC5zdGF0ZS5oZWFkaW5ncyA9IEFwcC5zdGF0ZS5oZWFkaW5ncy5tYXAoaD0+IGg9PT1vbGROYW1lID8gbm4gOiBoKTsgU3RvcmFnZS5zZXQoJ2hlYWRpbmdzJywgQXBwLnN0YXRlLmhlYWRpbmdzKTsgQXBwLnN0YXRlLnNob3J0Y3V0cy5mb3JFYWNoKGg9PnsgaWYoaC5oZWFkaW5nPT09b2xkTmFtZSkgaC5oZWFkaW5nPW5uOyB9KTsgU3RvcmFnZS5zZXQoJ3Nob3J0Y3V0cycsIEFwcC5zdGF0ZS5zaG9ydGN1dHMpOyBpZihBcHAuc3RhdGUuY29sbGFwc2VkW29sZE5hbWVdIT09dW5kZWZpbmVkKXsgQXBwLnN0YXRlLmNvbGxhcHNlZFtubl09QXBwLnN0YXRlLmNvbGxhcHNlZFtvbGROYW1lXTsgZGVsZXRlIEFwcC5zdGF0ZS5jb2xsYXBzZWRbb2xkTmFtZV07IFN0b3JhZ2Uuc2V0KCdjb2xsYXBzZWRIZWFkaW5ncycsIEFwcC5zdGF0ZS5jb2xsYXBzZWQpOyB9IEFwcC5yZW5kZXJBbGwoKTsgfSwKICAgIGRlbGV0ZUhlYWRpbmcobmFtZSl7IGlmKCFjb25maXJtKGBEZWxldGUgaGVhZGluZyAiJHtuYW1lfSIgYW5kIGl0cyBzaG9ydGN1dHM/YCkpIHJldHVybjsgQXBwLnN0YXRlLmhlYWRpbmdzID0gQXBwLnN0YXRlLmhlYWRpbmdzLmZpbHRlcihoPT5oIT09bmFtZSk7IFN0b3JhZ2Uuc2V0KCdoZWFkaW5ncycsIEFwcC5zdGF0ZS5oZWFkaW5ncyk7IEFwcC5zdGF0ZS5zaG9ydGN1dHMgPSBBcHAuc3RhdGUuc2hvcnRjdXRzLmZpbHRlcihoPT5oLmhlYWRpbmchPT1uYW1lKTsgU3RvcmFnZS5zZXQoJ3Nob3J0Y3V0cycsIEFwcC5zdGF0ZS5zaG9ydGN1dHMpOyBkZWxldGUgQXBwLnN0YXRlLmNvbGxhcHNlZFtuYW1lXTsgU3RvcmFnZS5zZXQoJ2NvbGxhcHNlZEhlYWRpbmdzJywgQXBwLnN0YXRlLmNvbGxhcHNlZCk7IEFwcC5yZW5kZXJBbGwoKTsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0TGlzdCcpLmlubmVySFRNTD0nJzsgfSwKICAgIG1vdmVIZWFkaW5nKG5hbWUsIGRpcil7IGNvbnN0IGk9QXBwLnN0YXRlLmhlYWRpbmdzLmluZGV4T2YobmFtZSk7IGNvbnN0IGo9aStkaXI7IGlmKGk8MHx8ajwwfHxqPj1BcHAuc3RhdGUuaGVhZGluZ3MubGVuZ3RoKSByZXR1cm47IFtBcHAuc3RhdGUuaGVhZGluZ3NbaV0sIEFwcC5zdGF0ZS5oZWFkaW5nc1tqXV0gPSBbQXBwLnN0YXRlLmhlYWRpbmdzW2pdLCBBcHAuc3RhdGUuaGVhZGluZ3NbaV1dOyBTdG9yYWdlLnNldCgnaGVhZGluZ3MnLCBBcHAuc3RhdGUuaGVhZGluZ3MpOyBBcHAucmVuZGVySGVhZGluZ3NVSSgpOyBBcHAucmVuZGVyU2hvcnRjdXRzSW50b0hlYWRpbmdzKCk7IH0sCiAgICBwZXJzaXN0Q2FyZHNPcmRlcihoZWFkaW5nKXsgY29uc3Qgd3JhcD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChgY2FyZHMtJHtoZWFkaW5nfWApOyBjb25zdCBpZHM9Wy4uLndyYXAucXVlcnlTZWxlY3RvckFsbCgnLmNhcmQnKV0ubWFwKG49PiBOdW1iZXIobi5pZC5yZXBsYWNlKCdjYXJkLScsJycpKSk7IGNvbnN0IGJ1Y2tldD1BcHAuc3RhdGUuc2hvcnRjdXRzLmZpbmQoaD0+aC5oZWFkaW5nPT09aGVhZGluZyk7IGlmKCFidWNrZXQpIHJldHVybjsgY29uc3QgbWFwPW5ldyBNYXAoYnVja2V0LnNob3J0Y3V0cy5tYXAocz0+W3MuaWQsc10pKTsgYnVja2V0LnNob3J0Y3V0cyA9IGlkcy5tYXAoaWQ9PiBtYXAuZ2V0KGlkKSkuZmlsdGVyKEJvb2xlYW4pOyBTdG9yYWdlLnNldCgnc2hvcnRjdXRzJywgQXBwLnN0YXRlLnNob3J0Y3V0cyk7IH0sCiAgICBmaW5kU2hvcnRjdXQoaWQpeyBmb3IoY29uc3QgYnVja2V0IG9mIEFwcC5zdGF0ZS5zaG9ydGN1dHMpeyBjb25zdCBpZHg9YnVja2V0LnNob3J0Y3V0cy5maW5kSW5kZXgocz0+IHMuaWQ9PT1pZCk7IGlmKGlkeCE9PS0xKSByZXR1cm4geyBidWNrZXQsIGlkeCB9OyB9IHJldHVybiBudWxsOyB9LAoKICAgIC8qIE5hdmlnYXRvciAqLwogICAgcmVuZGVyTmF2aWdhdG9yKHF1ZXJ5KXsgY29uc3QgcT0ocXVlcnl8fCcnKS50b0xvd2VyQ2FzZSgpLnRyaW0oKTsgY29uc3QgcmVzRWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hdlJlc3VsdHMnKTsgY29uc3Qgcm93cz1BcHAuc3RhdGUuaGVhZGluZ3MuZmlsdGVyKGg9PiAhcSB8fCBoLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocSkpOyByZXNFbC5pbm5lckhUTUwgPSByb3dzLm1hcChoPT5gPGRpdiBjbGFzcz0ncmVzdWx0LWl0ZW0nIG9uY2xpY2s9IkFwcC5qdW1wVG9IZWFkaW5nKCcke2h9JykiPjxzdHJvbmc+JHtofTwvc3Ryb25nPjwvZGl2PmApLmpvaW4oJycpIHx8IGA8ZGl2IHN0eWxlPSdwYWRkaW5nOjEycHg7Y29sb3I6dmFyKC0tbXV0ZWQpJz5ObyBoZWFkaW5ncyB5ZXQ8L2Rpdj5gOyB9LAogICAganVtcFRvSGVhZGluZyhuYW1lKXsgY29uc3QgZWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4taGVhZGluZy0nK25hbWUpOyBpZighZWwpIHJldHVybjsgZWwuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjonc21vb3RoJywgYmxvY2s6J3N0YXJ0JyB9KTsgaGlkZUFsbERyb3Bkb3ducygpOyB9LAoKICAgIC8qIFRhc2tzICovCiAgICB0b2dnbGVUYXNrcygpeyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza3NQYW5lbCcpLmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKTsgfSwKICAgIGFkZFRhc2soKXsgY29uc3QgbmFtZT1wcm9tcHQoJ1Rhc2sgbmFtZTonKTsgaWYoIW5hbWUpIHJldHVybjsgY29uc3QgaWQ9YHRhc2stJHtEYXRlLm5vdygpfWA7IGNvbnN0IHQ9eyBpZCwgbmFtZSwgbm90ZXM6JycsIGNvbG9yTmFtZTonR3JheScsIGRvbmU6ZmFsc2UgfTsgQXBwLnN0YXRlLnRhc2tzLnB1c2godCk7IFN0b3JhZ2Uuc2V0KCd0YXNrcycsIEFwcC5zdGF0ZS50YXNrcyk7IEFwcC5yZW5kZXJUYXNrcygpOyB9LAogICAgcmVuZGVyVGFza3MoKXsgY29uc3QgYm9keT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza3NCb2R5Jyk7IGJvZHkuaW5uZXJIVE1MPScnOyBBcHAuc3RhdGUudGFza3MuZm9yRWFjaCh0PT57IGNvbnN0IGNhcmQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IGNhcmQuY2xhc3NOYW1lPSd0YXNrLWNhcmQnOyBjYXJkLmlkPXQuaWQ7IGNvbnN0IGhleCA9IENPTE9SU1t0LmNvbG9yTmFtZV0gfHwgJyM5Y2EzYWYnOyBjYXJkLnN0eWxlLmJhY2tncm91bmQgPSBoZXg7IGlmKCh0LmNvbG9yTmFtZXx8JycpLnRvTG93ZXJDYXNlKCk9PT0nd2hpdGUnIHx8IGhleC50b0xvd2VyQ2FzZSgpPT09JyNmZmZmZmYnKXsgY2FyZC5jbGFzc0xpc3QuYWRkKCd3aGl0ZScpOyB9IGNhcmQuaW5uZXJIVE1MID0gYDxkaXYgY2xhc3M9J3Rhc2stYWN0aW9ucyc+PGJ1dHRvbiBjbGFzcz1cImNoaXAtYnRuXCIgdGl0bGU9XCJNb3ZlIHVwXCIgb25jbGljaz1cIkFwcC5tb3ZlVGFzaygnJHt0LmlkfScsIC0xKVwiPuKshjwvYnV0dG9uPjxidXR0b24gY2xhc3M9XCJjaGlwLWJ0blwiIHRpdGxlPVwiTW92ZSBkb3duXCIgb25jbGljaz1cIkFwcC5tb3ZlVGFzaygnJHt0LmlkfScsIDEpXCI+4qyHPC9idXR0b24+PGlucHV0IHR5cGU9J2NoZWNrYm94JyAke3QuZG9uZT8nY2hlY2tlZCc6Jyd9IG9uY2hhbmdlPSJBcHAudG9nZ2xlRG9uZSgnJHt0LmlkfScsIHRoaXMuY2hlY2tlZCkiIC8+PHNlbGVjdCBjbGFzcz0nc21hbGwtc2VsZWN0JyBvbmNoYW5nZT0iQXBwLmNoYW5nZVRhc2tDb2xvcignJHt0LmlkfScsIHRoaXMudmFsdWUpIj4ke09iamVjdC5rZXlzKENPTE9SUykubWFwKG49PmA8b3B0aW9uIHZhbHVlPScke259JyAke3QuY29sb3JOYW1lPT09bj8ic2VsZWN0ZWQiOiIifT4ke259PC9vcHRpb24+YCkuam9pbignJyl9PG9wdGlvbiB2YWx1ZT0nV2hpdGUnICR7dC5jb2xvck5hbWU9PT0nV2hpdGUnPyJzZWxlY3RlZCI6IiJ9PldoaXRlPC9vcHRpb24+PC9zZWxlY3Q+PGJ1dHRvbiBjbGFzcz0nY2hpcC1idG4nIG9uY2xpY2s9IkFwcC50b2dnbGVOb3RlcygnJHt0LmlkfScpIj7wn5OdPC9idXR0b24+PGJ1dHRvbiBjbGFzcz0nY2hpcC1idG4nIG9uY2xpY2s9IkFwcC5lZGl0VGFzaygnJHt0LmlkfScpIj7inI/vuI88L2J1dHRvbj48YnV0dG9uIGNsYXNzPSdjaGlwLWJ0bicgb25jbGljaz0iQXBwLmRlbGV0ZVRhc2soJyR7dC5pZH0nKSI+8J+Xke+4jzwvYnV0dG9uPjwvZGl2PjxwIGNsYXNzPSd0YXNrLXRpdGxlICR7dC5kb25lPydkb25lJzonJ30nIGlkPSd0dGwtJHt0LmlkfSc+JHt0Lm5hbWV9PC9wPjx0ZXh0YXJlYSBjbGFzcz0ndGFzay1ub3RlcycgaWQ9J250LSR7dC5pZH0nIHN0eWxlPSdkaXNwbGF5Om5vbmUnPiR7dC5ub3Rlc3x8Jyd9PC90ZXh0YXJlYT5gOyBib2R5LmFwcGVuZENoaWxkKGNhcmQpOyB9KTsgYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay1ub3RlcycpLmZvckVhY2goZWw9PiBlbC5vbmlucHV0ID0gQXBwLnNhdmVUYXNrcyk7IH0sCiAgICB0b2dnbGVEb25lKGlkLCBjaGVja2VkKXsgY29uc3QgdD1BcHAuc3RhdGUudGFza3MuZmluZCh4PT54LmlkPT09aWQpOyBpZighdCkgcmV0dXJuOyB0LmRvbmU9Y2hlY2tlZDsgU3RvcmFnZS5zZXQoJ3Rhc2tzJywgQXBwLnN0YXRlLnRhc2tzKTsgY29uc3QgdHRsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dGwtJytpZCk7IGlmKHR0bCkgdHRsLmNsYXNzTGlzdC50b2dnbGUoJ2RvbmUnLCBjaGVja2VkKTsgfSwKICAgIHRvZ2dsZU5vdGVzKGlkKXsgY29uc3QgZWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ250LScraWQpOyBlbC5zdHlsZS5kaXNwbGF5ID0gKGVsLnN0eWxlLmRpc3BsYXk9PT0nbm9uZScgPyAnYmxvY2snIDogJ25vbmUnKTsgfSwKICAgIGVkaXRUYXNrKGlkKXsgY29uc3QgdD1BcHAuc3RhdGUudGFza3MuZmluZCh4PT54LmlkPT09aWQpOyBpZighdCkgcmV0dXJuOyBjb25zdCBubj1wcm9tcHQoJ1Rhc2sgbmFtZTonLCB0Lm5hbWUpOyBpZighbm4pIHJldHVybjsgdC5uYW1lPW5uOyBTdG9yYWdlLnNldCgndGFza3MnLCBBcHAuc3RhdGUudGFza3MpOyBBcHAucmVuZGVyVGFza3MoKTsgfSwKICAgIGNoYW5nZVRhc2tDb2xvcihpZCwgbmFtZSl7IGNvbnN0IHQ9QXBwLnN0YXRlLnRhc2tzLmZpbmQoeD0+eC5pZD09PWlkKTsgaWYoIXQpIHJldHVybjsgdC5jb2xvck5hbWU9bmFtZTsgU3RvcmFnZS5zZXQoJ3Rhc2tzJywgQXBwLnN0YXRlLnRhc2tzKTsgY29uc3QgY2FyZD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7IGlmKCFjYXJkKSByZXR1cm47IGNvbnN0IGhleCA9IG5hbWU9PT0nV2hpdGUnID8gJyNmZmZmZmYnIDogKENPTE9SU1tuYW1lXXx8JyM5Y2EzYWYnKTsgY2FyZC5zdHlsZS5iYWNrZ3JvdW5kID0gaGV4OyBpZihuYW1lPT09J1doaXRlJyl7IGNhcmQuY2xhc3NMaXN0LmFkZCgnd2hpdGUnKTsgfSBlbHNlIHsgY2FyZC5jbGFzc0xpc3QucmVtb3ZlKCd3aGl0ZScpOyB9IH0sCiAgICBkZWxldGVUYXNrKGlkKXsgQXBwLnN0YXRlLnRhc2tzID0gQXBwLnN0YXRlLnRhc2tzLmZpbHRlcih4PT54LmlkIT09aWQpOyBTdG9yYWdlLnNldCgndGFza3MnLCBBcHAuc3RhdGUudGFza3MpOyBBcHAucmVuZGVyVGFza3MoKTsgfSwKICAgIHNhdmVUYXNrcygpeyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay1jYXJkJykuZm9yRWFjaChjYXJkPT57IGNvbnN0IGlkPWNhcmQuaWQ7IGNvbnN0IHQ9QXBwLnN0YXRlLnRhc2tzLmZpbmQoeD0+eC5pZD09PWlkKTsgaWYoIXQpIHJldHVybjsgdC5ub3RlcyA9IGNhcmQucXVlcnlTZWxlY3RvcignLnRhc2stbm90ZXMnKS52YWx1ZTsgfSk7IFN0b3JhZ2Uuc2V0KCd0YXNrcycsIEFwcC5zdGF0ZS50YXNrcyk7IH0sCgogICAgLyogVGhlbWUgJiBXYWxscGFwZXIgKi8KICAgIGNoYW5nZVRoZW1lKHZhbCl7IEFwcC5zdGF0ZS50aGVtZSA9IHZhbDsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3RoZW1lJywgdmFsKTsgQXBwLmFwcGx5VGhlbWUoKTsgY29uc3QgdHM9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lU2VsZWN0Jyk7IGlmKHRzKSB0cy52YWx1ZT12YWw7IH0sCiAgICBjaGFuZ2VXYWxscGFwZXIoa2V5KXsgQXBwLnN0YXRlLndhbGxwYXBlcj1rZXk7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd3YWxscGFwZXInLCBrZXkpOyBBcHAuYXBwbHlUaGVtZSgpOyBjb25zdCB3cz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2FsbHBhcGVyU2VsZWN0Jyk7IGlmKHdzKSB3cy52YWx1ZT1rZXk7IH0sCiAgICBhcHBseVRoZW1lKCl7IGNvbnN0IHRoPVRIRU1FU1tBcHAuc3RhdGUudGhlbWVdfHxUSEVNRVMub2NlYW47IGNvbnN0IHdwPVdBTExQQVBFUlNbQXBwLnN0YXRlLndhbGxwYXBlcl18fCcnOyBkb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmQ9dGguYmc7IGRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZEltYWdlPSdub25lJzsgZG9jdW1lbnQuYm9keS5zdHlsZS5jb2xvcj10aC50ZXh0OyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tcGFuZWwnLCB0aC5wYW5lbCk7IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1jYXJkJywgdGguY2FyZCk7IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS10ZXh0JywgdGgudGV4dCk7IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1icmFuZCcsIHRoLmFjY2VudCk7IGNvbnN0IHN0YXR1cz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3BTdGF0dXMnKTsgaWYoIXdwKXsgaWYoc3RhdHVzKSBzdGF0dXMudGV4dENvbnRlbnQ9J05vIHdhbGxwYXBlciBzZWxlY3RlZC4nOyByZXR1cm47IH0gY29uc3QgaW1nPW5ldyBJbWFnZSgpOyBpbWcub25sb2FkPSgpPT57IGRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZEltYWdlPWB1cmwoJyR7d3B9JylgOyBkb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmRSZXBlYXQ9J25vLXJlcGVhdCc7IGRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZFNpemU9J2NvdmVyJzsgZG9jdW1lbnQuYm9keS5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb249J2NlbnRlcic7IGRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZEF0dGFjaG1lbnQ9J2ZpeGVkJzsgaWYoc3RhdHVzKSBzdGF0dXMudGV4dENvbnRlbnQgPSBgTG9hZGVkICR7d3B9YDsgfTsgaW1nLm9uZXJyb3I9KCk9PnsgaWYoc3RhdHVzKSBzdGF0dXMudGV4dENvbnRlbnQ9YENvdWxkIG5vdCBmaW5kICR7d3B9LiBNYWtlIHN1cmUgQmVhY2guanBnIC8gTmF0dXJlLmpwZyAvIEZhbGwuanBnIHNpdCBuZXh0IHRvIHRoaXMgSFRNTC5gOyB9OyBpbWcuc3JjPXdwOyB9LAoKICAgIC8qIENsb2NrICovCiAgICBzZXRUaW1lRm9ybWF0KGZtdCl7IEFwcC5zdGF0ZS5jbG9ja0Zvcm1hdD1mbXQ7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjbG9ja0Zvcm1hdCcsIGZtdCk7IEFwcC5hcHBseUNsb2NrKCk7IH0sCiAgICB0b2dnbGVDbG9jaygpeyBBcHAuc3RhdGUuY2xvY2tWaXNpYmxlPSFBcHAuc3RhdGUuY2xvY2tWaXNpYmxlOyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2xvY2tWaXNpYmxlJywgQXBwLnN0YXRlLmNsb2NrVmlzaWJsZSk7IEFwcC5hcHBseUNsb2NrKCk7IH0sCiAgICBhcHBseUNsb2NrKHRpY2s9ZmFsc2UpeyBjb25zdCBlbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZURpc3BsYXknKTsgZWwuc3R5bGUuZGlzcGxheSA9IEFwcC5zdGF0ZS5jbG9ja1Zpc2libGUgPyAnYmxvY2snOidub25lJzsgY29uc3Qgbm93PW5ldyBEYXRlKCk7IGxldCBzPScnOyBpZihBcHAuc3RhdGUuY2xvY2tGb3JtYXQ9PT0nMTJoJyl7IGxldCBoPW5vdy5nZXRIb3VycygpJTEyIHx8IDEyOyBsZXQgbT1ub3cuZ2V0TWludXRlcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwnMCcpOyBzPWAke2h9OiR7bX0gJHtub3cuZ2V0SG91cnMoKT49MTI/J1BNJzonQU0nfWA7IH0gZWxzZSBpZihBcHAuc3RhdGUuY2xvY2tGb3JtYXQ9PT0nMjRoJyl7IGxldCBoPW5vdy5nZXRIb3VycygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwnMCcpOyBsZXQgbT1ub3cuZ2V0TWludXRlcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwnMCcpOyBzPWAke2h9OiR7bX1gOyB9IGVsc2UgaWYoQXBwLnN0YXRlLmNsb2NrRm9ybWF0PT09J2RhdGUnKXsgcyA9IG5vdy50b0lTT1N0cmluZygpLnNsaWNlKDAsMTApOyB9IGVsc2UgaWYoQXBwLnN0YXRlLmNsb2NrRm9ybWF0PT09J2RheScpeyBzPVsnU3VuZGF5JywnTW9uZGF5JywnVHVlc2RheScsJ1dlZG5lc2RheScsJ1RodXJzZGF5JywnRnJpZGF5JywnU2F0dXJkYXknXVtub3cuZ2V0RGF5KCldOyB9IGVsLnRleHRDb250ZW50PXM7IGlmKHRpY2shPT1mYWxzZSkgc2V0VGltZW91dCgoKT0+QXBwLmFwcGx5Q2xvY2sodHJ1ZSksMTAwMCk7IH0sCgogICAgLyogQ2FsZW5kYXIgKi8KICAgIG5vcm1hbGl6ZUdvb2dsZUVtYmVkKHVybCl7IHRyeXsgY29uc3QgdT1uZXcgVVJMKHVybCk7IGlmKHUuaG9zdG5hbWUhPT0nY2FsZW5kYXIuZ29vZ2xlLmNvbScpIHJldHVybiB1cmw7IGlmKHUucGF0aG5hbWUuaW5jbHVkZXMoJy9jYWxlbmRhci9lbWJlZCcpKSByZXR1cm4gdXJsOyBpZih1LnNlYXJjaFBhcmFtcy5oYXMoJ2NpZCcpKXsgY29uc3QgY2lkPXUuc2VhcmNoUGFyYW1zLmdldCgnY2lkJyk7IGNvbnN0IHR6PXUuc2VhcmNoUGFyYW1zLmdldCgnY3R6Jyl8fCdBbWVyaWNhL0RldHJvaXQnOyByZXR1cm4gYGh0dHBzOi8vY2FsZW5kYXIuZ29vZ2xlLmNvbS9jYWxlbmRhci9lbWJlZD9oZWlnaHQ9NjAwJndrc3Q9MSZiZ2NvbG9yPSUyMzBCMEYxNCZjdHo9JHtlbmNvZGVVUklDb21wb25lbnQodHopfSZzcmM9JHtlbmNvZGVVUklDb21wb25lbnQoY2lkKX0mY29sb3I9JTIzMDM5YmU1JnNob3dQcmludD0wYDsgfSB9Y2F0Y2h7fSBpZigvXlteQF0rQGdyb3VwXC5jYWxlbmRhclwuZ29vZ2xlXC5jb20kLy50ZXN0KHVybCkgfHwgL0BnbWFpbFwuY29tJC8udGVzdCh1cmwpKXsgY29uc3QgdHo9J0FtZXJpY2EvRGV0cm9pdCc7IHJldHVybiBgaHR0cHM6Ly9jYWxlbmRhci5nb29nbGUuY29tL2NhbGVuZGFyL2VtYmVkP2hlaWdodD02MDAmd2tzdD0xJmJnY29sb3I9JTIzMEIwRjE0JmN0ej0ke2VuY29kZVVSSUNvbXBvbmVudCh0eil9JnNyYz0ke2VuY29kZVVSSUNvbXBvbmVudCh1cmwpfSZjb2xvcj0lMjMwMzliZTUmc2hvd1ByaW50PTBgOyB9IHJldHVybiB1cmw7IH0sCiAgICBhZGRDYWxlbmRhcigpeyBjb25zdCBwcm92PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxQcm92aWRlcicpLnZhbHVlOyBsZXQgdXJsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxlbmRhclVSTCcpLnZhbHVlLnRyaW0oKTsgaWYocHJvdj09PSdnb29nbGUnKXsgdXJsPUFwcC5ub3JtYWxpemVHb29nbGVFbWJlZCh1cmwpOyBjb25zdCBvaz11cmwuc3RhcnRzV2l0aCgnaHR0cHM6Ly9jYWxlbmRhci5nb29nbGUuY29tL2NhbGVuZGFyL2VtYmVkPycpOyBpZighb2speyBhbGVydCgnR29vZ2xlOiBwYXN0ZSBhbiBFbWJlZCBVUkwgb3IgdGhlIGNhbGVuZGFyIElELicpOyByZXR1cm47IH0gfSBlbHNlIHsgY29uc3Qgb2sgPSB1cmwuc3RhcnRzV2l0aCgnaHR0cHM6Ly9vdXRsb29rLmxpdmUuY29tL2NhbGVuZGFyL2VtYmVkPycpIHx8IHVybC5zdGFydHNXaXRoKCdodHRwczovL291dGxvb2sub2ZmaWNlLmNvbS8nKTsgaWYoIW9rKXsgYWxlcnQoJ01pY3Jvc29mdDogcGFzdGUgYSBwdWJsaXNoZWQgRW1iZWQgbGluay4nKTsgcmV0dXJuOyB9IH0gQXBwLnN0YXRlLmNhbC51cmw9dXJsOyBBcHAuc3RhdGUuY2FsLnZpc2libGU9dHJ1ZTsgU3RvcmFnZS5zZXQoJ2NhbGVuZGFyU2V0dGluZ3MnLCBBcHAuc3RhdGUuY2FsKTsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhbGVuZGFyVVJMJywgdXJsKTsgQXBwLm9wZW5DYWxlbmRhcigpOyBoaWRlQWxsRHJvcGRvd25zKCk7IH0sCiAgICBvcGVuQ2FsZW5kYXIoc2tpcFNob3dEcm9wKXsgY29uc3Qgd2Fybj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FsV2FybicpOyBpZighQXBwLnN0YXRlLmNhbC51cmwpIHJldHVybjsgY29uc3Qgd2luPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxXaW4nKTsgY29uc3QgZj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FsZW5kYXJGcmFtZScpOyB3YXJuLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOyB3YXJuLnRleHRDb250ZW50PScnOyBpZihsb2NhdGlvbi5wcm90b2NvbD09PSdmaWxlOicpeyB3YXJuLnRleHRDb250ZW50PSdPcGVuaW5nIGFzIGEgbG9jYWwgZmlsZSBjYW4gYmxvY2sgY2FsZW5kYXIgZW1iZWRzLiBDbGljayDihpcgdG8gb3BlbiBpbiBhIHRhYiwgb3Igc2VydmUgb3ZlciBodHRwOi8vIChlLmcuLCBWUyBDb2RlIExpdmUgU2VydmVyKS4nOyB3YXJuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOyB9IGYuc3JjPUFwcC5zdGF0ZS5jYWwudXJsOyBsZXQgbG9hZGVkPWZhbHNlOyBjb25zdCB0PXNldFRpbWVvdXQoKCk9PnsgaWYoIWxvYWRlZCl7IHdhcm4udGV4dENvbnRlbnQ9J0NhbGVuZGFyIGZhaWxlZCB0byBsb2FkLiBFbnN1cmUgaXQgaXMgcHVibGljL3B1Ymxpc2hlZCBhbmQgdGhhdCB0aGlzIGlzIHRoZSBFbWJlZCBVUkwuJzsgd2Fybi5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsgfSB9LDM1MDApOyBmLm9ubG9hZD0oKT0+eyBsb2FkZWQ9dHJ1ZTsgY2xlYXJUaW1lb3V0KHQpOyB9OyB3aW4uc3R5bGUuZGlzcGxheT0nYmxvY2snOyB3aW4uc3R5bGUud2lkdGg9QXBwLnN0YXRlLmNhbC53aWR0aHx8Jzg2MHB4Jzsgd2luLnN0eWxlLmhlaWdodD1BcHAuc3RhdGUuY2FsLmhlaWdodHx8JzYyMHB4Jzsgd2luLnN0eWxlLmxlZnQ9QXBwLnN0YXRlLmNhbC5sZWZ0fHwnMTIwcHgnOyB3aW4uc3R5bGUudG9wPUFwcC5zdGF0ZS5jYWwudG9wfHwnMTIwcHgnOyBBcHAuc3RhdGUuY2FsLnZpc2libGU9dHJ1ZTsgU3RvcmFnZS5zZXQoJ2NhbGVuZGFyU2V0dGluZ3MnLCBBcHAuc3RhdGUuY2FsKTsgaWYoIXNraXBTaG93RHJvcCkgaGlkZUFsbERyb3Bkb3ducygpOyB9LAogICAgY2xvc2VDYWxlbmRhcigpeyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FsV2luJykuc3R5bGUuZGlzcGxheT0nbm9uZSc7IEFwcC5zdGF0ZS5jYWwudmlzaWJsZT1mYWxzZTsgU3RvcmFnZS5zZXQoJ2NhbGVuZGFyU2V0dGluZ3MnLCBBcHAuc3RhdGUuY2FsKTsgfSwKICAgIHJlc2l6ZUNhbGVuZGFyKGFtb3VudCl7IGNvbnN0IHdpbj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FsV2luJyk7IGNvbnN0IHc9TWF0aC5tYXgoNDIwLCB3aW4uY2xpZW50V2lkdGgrYW1vdW50KTsgY29uc3QgaD1NYXRoLm1heCgzNjAsIHdpbi5jbGllbnRIZWlnaHQrTWF0aC5yb3VuZChhbW91bnQqMC43NSkpOyB3aW4uc3R5bGUud2lkdGg9dysncHgnOyB3aW4uc3R5bGUuaGVpZ2h0PWgrJ3B4JzsgQXBwLnNhdmVDYWxSZWN0KCk7IH0sCiAgICBtb3VudENhbGVuZGFyRHJhZygpeyBjb25zdCBoZWFkZXI9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbERyYWcnKTsgY29uc3Qgd2luPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxXaW4nKTsgbGV0IGRyYWc9ZmFsc2UsIG94PTAsIG95PTA7IGhlYWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLChlKT0+eyBkcmFnPXRydWU7IG94PWUuY2xpZW50WC13aW4ub2Zmc2V0TGVmdDsgb3k9ZS5jbGllbnRZLXdpbi5vZmZzZXRUb3A7IGhlYWRlci5zdHlsZS5jdXJzb3I9J2dyYWJiaW5nJzsgfSk7IGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsKGUpPT57IGlmKCFkcmFnKSByZXR1cm47IHdpbi5zdHlsZS5sZWZ0PShlLmNsaWVudFgtb3gpKydweCc7IHdpbi5zdHlsZS50b3A9KGUuY2xpZW50WS1veSkrJ3B4JzsgfSk7IGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCgpPT57IGlmKCFkcmFnKSByZXR1cm47IGRyYWc9ZmFsc2U7IGhlYWRlci5zdHlsZS5jdXJzb3I9J2dyYWInOyBBcHAuc2F2ZUNhbFJlY3QoKTsgfSk7IH0sCiAgICBtb3VudENhbGVuZGFyUmVzaXplcnMoKXsgY29uc3Qgd2luPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxXaW4nKTsgbGV0IHJlc2l6aW5nPWZhbHNlOyBsZXQgZGlyPScnOyBsZXQgc3g9MCwgc3k9MDsgbGV0IHN3PTAsIHNoPTAsIHNsPTAsIHN0PTA7IGNvbnN0IHN0YXJ0PShkLGUpPT57IGUucHJldmVudERlZmF1bHQoKTsgcmVzaXppbmc9dHJ1ZTsgZGlyPWQ7IHN4PWUuY2xpZW50WDsgc3k9ZS5jbGllbnRZOyBjb25zdCByPXdpbi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsgc3c9ci53aWR0aDsgc2g9ci5oZWlnaHQ7IHNsPXIubGVmdDsgc3Q9ci50b3A7IGRvY3VtZW50LmJvZHkuc3R5bGUudXNlclNlbGVjdD0nbm9uZSc7IH07IGNvbnN0IG1vdmU9KGUpPT57IGlmKCFyZXNpemluZykgcmV0dXJuOyBsZXQgZHg9ZS5jbGllbnRYLXN4OyBsZXQgZHk9ZS5jbGllbnRZLXN5OyBpZihkaXIuaW5jbHVkZXMoJ2UnKSl7IHdpbi5zdHlsZS53aWR0aD1NYXRoLm1heCg0MjAsIHN3K2R4KSsncHgnOyB9IGlmKGRpci5pbmNsdWRlcygncycpKXsgd2luLnN0eWxlLmhlaWdodD1NYXRoLm1heCgzNjAsIHNoK2R5KSsncHgnOyB9IGlmKGRpci5pbmNsdWRlcygndycpKXsgY29uc3Qgbnc9TWF0aC5tYXgoNDIwLCBzdy1keCk7IHdpbi5zdHlsZS53aWR0aD1udysncHgnOyB3aW4uc3R5bGUubGVmdD0oc2wrKHN3LW53KSkrJ3B4JzsgfSBpZihkaXIuaW5jbHVkZXMoJ24nKSl7IGNvbnN0IG5oPU1hdGgubWF4KDM2MCwgc2gtZHkpOyB3aW4uc3R5bGUuaGVpZ2h0PW5oKydweCc7IHdpbi5zdHlsZS50b3A9KHN0KyhzaC1uaCkpKydweCc7IH0gfTsgY29uc3QgZW5kPSgpPT57IGlmKCFyZXNpemluZykgcmV0dXJuOyByZXNpemluZz1mYWxzZTsgZG9jdW1lbnQuYm9keS5zdHlsZS51c2VyU2VsZWN0PScnOyBBcHAuc2F2ZUNhbFJlY3QoKTsgfTsgWydlJywndycsJ3MnLCduJywnc2UnLCdzdycsJ25lJywnbncnXS5mb3JFYWNoKGQ9PnsgY29uc3QgZWw9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhbC1yZXNpemVyLicrZCk7IGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHN0YXJ0LmJpbmQobnVsbCxkKSk7IH0pOyBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBtb3ZlKTsgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIGVuZCk7IH0sCiAgICBzYXZlQ2FsUmVjdCgpeyBjb25zdCB3aW49ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbFdpbicpOyBBcHAuc3RhdGUuY2FsLndpZHRoPXdpbi5zdHlsZS53aWR0aDsgQXBwLnN0YXRlLmNhbC5oZWlnaHQ9d2luLnN0eWxlLmhlaWdodDsgQXBwLnN0YXRlLmNhbC5sZWZ0PXdpbi5zdHlsZS5sZWZ0OyBBcHAuc3RhdGUuY2FsLnRvcD13aW4uc3R5bGUudG9wOyBTdG9yYWdlLnNldCgnY2FsZW5kYXJTZXR0aW5ncycsIEFwcC5zdGF0ZS5jYWwpOyB9LAoKICAgIC8qIFJlbWluZGVycyAqLwogICAgb3BlblJlbWluZGVyKCl7IEFwcC5sb2FkUmVtaW5kZXJzKCk7IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW1Nb2RhbCcpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtT3ZlcmxheScpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOyB9LAogICAgY2xvc2VSZW1pbmRlcigpeyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtTW9kYWwnKS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlbU92ZXJsYXknKS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsgfSwKICAgIHNhdmVSZW1pbmRlcigpeyBjb25zdCB0aXRsZT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtVGl0bGUnKS52YWx1ZS50cmltKCk7IGNvbnN0IGRhdGVUaW1lPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW1EVCcpLnZhbHVlOyBjb25zdCBlbW9qaT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtRW1vamknKS52YWx1ZTsgaWYoIXRpdGxlfHwhZGF0ZVRpbWUpeyBhbGVydCgnQWRkIHRpdGxlICYgZGF0ZS90aW1lJyk7IHJldHVybjsgfSBjb25zdCByZW1pbmRlcnM9U3RvcmFnZS5nZXQoJ3JlbWluZGVycycsW10pOyByZW1pbmRlcnMucHVzaCh7IGlkOkRhdGUubm93KCksIHRpdGxlLCBkYXRlVGltZSwgZW1vamkgfSk7IFN0b3JhZ2Uuc2V0KCdyZW1pbmRlcnMnLCByZW1pbmRlcnMpOyBBcHAubG9hZFJlbWluZGVycygpOyBBcHAuY2xvc2VSZW1pbmRlcigpOyB9LAogICAgbG9hZFJlbWluZGVycygpeyBjb25zdCBsaXN0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW1MaXN0Jyk7IGxpc3QuaW5uZXJIVE1MPScnOyBjb25zdCByZW1pbmRlcnM9U3RvcmFnZS5nZXQoJ3JlbWluZGVycycsW10pOyByZW1pbmRlcnMuc29ydCgoYSxiKT0+IG5ldyBEYXRlKGEuZGF0ZVRpbWUpLW5ldyBEYXRlKGIuZGF0ZVRpbWUpKTsgcmVtaW5kZXJzLmZvckVhY2gocj0+eyBjb25zdCBsaT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOyBjb25zdCB3aGVuPW5ldyBEYXRlKHIuZGF0ZVRpbWUpLnRvTG9jYWxlU3RyaW5nKCk7IGxpLmlubmVySFRNTCA9IGAke3IuZW1vaml8fCcnfSA8c3Ryb25nPiR7ci50aXRsZX08L3N0cm9uZz4gPHNtYWxsIHN0eWxlPSdjb2xvcjp2YXIoLS1tdXRlZCknPigke3doZW59KTwvc21hbGw+IDxidXR0b24gY2xhc3M9J2NoaXAtYnRuJyBzdHlsZT0nZmxvYXQ6cmlnaHQnIG9uY2xpY2s9J0FwcC5kZWxldGVSZW1pbmRlcigke3IuaWR9KSc+4p2MPC9idXR0b24+YDsgbGlzdC5hcHBlbmRDaGlsZChsaSk7IH0pOyB9LAogICAgZGVsZXRlUmVtaW5kZXIoaWQpeyBjb25zdCBycz1TdG9yYWdlLmdldCgncmVtaW5kZXJzJyxbXSkuZmlsdGVyKHI9PnIuaWQhPT1pZCk7IFN0b3JhZ2Uuc2V0KCdyZW1pbmRlcnMnLCBycyk7IEFwcC5sb2FkUmVtaW5kZXJzKCk7IH0sCiAgICBzaG93VG9hc3QodGV4dCwgZW1vamkpeyBjb25zdCB0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW1Ub2FzdCcpOyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtVG9hc3RUZXh0JykudGV4dENvbnRlbnQ9dGV4dDsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlbVRvYXN0RW1vamknKS50ZXh0Q29udGVudD1lbW9qaXx8J/CflJQnOyB0LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOyB2b2lkIHQub2Zmc2V0V2lkdGg7IHQuc3R5bGUub3BhY2l0eT0xOyBzZXRUaW1lb3V0KEFwcC5oaWRlVG9hc3QsIDYwMDAwKTsgfSwKICAgIGhpZGVUb2FzdCgpeyBjb25zdCB0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW1Ub2FzdCcpOyB0LnN0eWxlLm9wYWNpdHk9MDsgc2V0VGltZW91dCgoKT0+dC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKSwxODApOyB9LAogICAgY2hlY2tSZW1pbmRlcnMoKXsgY29uc3Qgbm93PW5ldyBEYXRlKCk7IGxldCBycz1TdG9yYWdlLmdldCgncmVtaW5kZXJzJyxbXSk7IGNvbnN0IGR1ZT1ycy5maWx0ZXIocj0+eyBjb25zdCB0PW5ldyBEYXRlKHIuZGF0ZVRpbWUpOyByZXR1cm4gbm93Pj10ICYmIChub3ctdCk8NjAwMDA7IH0pOyBpZihkdWUubGVuZ3RoKXsgY29uc3Qgcj1kdWVbMF07IEFwcC5zaG93VG9hc3QoYCR7ci50aXRsZX1gLCByLmVtb2ppfHwn8J+UlCcpOyBycyA9IHJzLmZpbHRlcih4PT54LmlkIT09ci5pZCk7IFN0b3JhZ2Uuc2V0KCdyZW1pbmRlcnMnLCBycyk7IH0gfSwKCgogIGRhaWx5TWVzc2FnZXM6ewogICAgYmlibGljYWw6WwogICAgICAiVGhlIExvcmQgaXMgbXkgc2hlcGhlcmQ7IEkgc2hhbGwgbm90IHdhbnQuIiwKICAgICAgIkkgY2FuIGRvIGFsbCB0aGluZ3MgdGhyb3VnaCBDaHJpc3Qgd2hvIHN0cmVuZ3RoZW5zIG1lLiIsCiAgICAgICJCZSBzdHJvbmcgYW5kIGNvdXJhZ2VvdXMuIERvIG5vdCBiZSBhZnJhaWQuIiwKICAgICAgIkxvdmUgeW91ciBuZWlnaGJvciBhcyB5b3Vyc2VsZi4iCiAgICBdLAogICAgbW90aXZhdGlvbmFsOlsKICAgICAgIkJlbGlldmUgeW91IGNhbiBhbmQgeW91J3JlIGhhbGZ3YXkgdGhlcmUuIiwKICAgICAgIlNtYWxsIHN0ZXBzIGV2ZXJ5IGRheSBsZWFkIHRvIGJpZyByZXN1bHRzLiIsCiAgICAgICJEcmVhbSBiaWcuIFdvcmsgaGFyZC4gU3RheSBmb2N1c2VkLiIsCiAgICAgICJZb3VyIGxpbWl0YXRpb27igJRpdCdzIG9ubHkgeW91ciBpbWFnaW5hdGlvbi4iCiAgICBdCiAgfSwKCiAgY2hlY2tEYWlseU1lc3NhZ2UoKXsKICAgIGNvbnN0IGVuYWJsZWQ9bG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2RhaWx5TXNnRW5hYmxlZCcpPT09J3RydWUnOwogICAgaWYoIWVuYWJsZWQpIHJldHVybjsKICAgIGNvbnN0IG5vdz1uZXcgRGF0ZSgpOwogICAgaWYobm93LmdldEhvdXJzKCk9PT04ICYmIG5vdy5nZXRNaW51dGVzKCk9PT0wKXsKICAgICAgY29uc3QgdHlwZT1sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZGFpbHlNc2dUeXBlJyl8fCdtb3RpdmF0aW9uYWwnOwogICAgICBjb25zdCBhcnI9QXBwLmRhaWx5TWVzc2FnZXNbdHlwZV18fFtdOwogICAgICBjb25zdCBtc2c9YXJyW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSphcnIubGVuZ3RoKV18fCdIYXZlIGEgZ3JlYXQgZGF5ISc7CiAgICAgIEFwcC5zaG93RGFpbHlQb3B1cChtc2cpOwogICAgfQogIH0sCgogIHNob3dEYWlseVBvcHVwKHRleHQpewogICAgY29uc3QgZWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhaWx5UG9wdXAnKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYWlseVBvcHVwVGV4dCcpLnRleHRDb250ZW50PXRleHQ7CiAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsgZWwuc3R5bGUucG9pbnRlckV2ZW50cz0nYXV0byc7CiAgICB2b2lkIGVsLm9mZnNldFdpZHRoOyBlbC5zdHlsZS5vcGFjaXR5PTE7CiAgfSwKCiAgaGlkZURhaWx5UG9wdXAoKXsKICAgIGNvbnN0IGVsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYWlseVBvcHVwJyk7CiAgICBlbC5zdHlsZS5vcGFjaXR5PTA7IHNldFRpbWVvdXQoKCk9PnsgZWwuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7IGVsLnN0eWxlLnBvaW50ZXJFdmVudHM9J25vbmUnOyB9LDMwMCk7CiAgfSwKCiAgICAvKiBXZWF0aGVyICovCiAgICBhc3luYyBzZWFyY2hXZWF0aGVyKCl7IGNvbnN0IHE9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3d4UXVlcnknKS52YWx1ZS50cmltKCk7IGNvbnN0IGJveD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3hSZXN1bHRzJyk7IGJveC5pbm5lckhUTUw9J1NlYXJjaGluZ+KApic7IGlmKCFxKXsgYm94LmlubmVySFRNTD0nPHNwYW4gc3R5bGU9ImNvbG9yOnZhcigtLW11dGVkKSI+VHlwZSBhIGNpdHk8L3NwYW4+JzsgcmV0dXJuOyB9IHRyeXsgY29uc3QgdXJsPWBodHRwczovL2dlb2NvZGluZy1hcGkub3Blbi1tZXRlby5jb20vdjEvc2VhcmNoP25hbWU9JHtlbmNvZGVVUklDb21wb25lbnQocSl9JmNvdW50PTVgOyBjb25zdCBnZW89YXdhaXQgZmV0Y2hKU09OKHVybCk7IGlmKCFnZW8/LnJlc3VsdHM/Lmxlbmd0aCl7IGJveC5pbm5lckhUTUw9JzxzcGFuIHN0eWxlPSJjb2xvcjp2YXIoLS1tdXRlZCkiPk5vIHJlc3VsdHM8L3NwYW4+JzsgcmV0dXJuOyB9IGJveC5pbm5lckhUTUwgPSBnZW8ucmVzdWx0cy5tYXAoKHIsaSk9PmA8ZGl2IGNsYXNzPSJyZXN1bHQtaXRlbSIgZGF0YS1pZHg9IiR7aX0iPiR7W3IubmFtZSwgci5yZWdpb24sIHIuY291bnRyeV0uZmlsdGVyKEJvb2xlYW4pLmpvaW4oJywgJyl9PC9kaXY+YCkuam9pbignJyk7IGJveC5xdWVyeVNlbGVjdG9yQWxsKCcucmVzdWx0LWl0ZW0nKS5mb3JFYWNoKGVsPT57IGNvbnN0IGk9TnVtYmVyKGVsLmRhdGFzZXQuaWR4KTsgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+eyBjb25zdCByPWdlby5yZXN1bHRzW2ldOyBjb25zdCBuYW1lPVtyLm5hbWUsIHIucmVnaW9uLCByLmNvdW50cnldLmZpbHRlcihCb29sZWFuKS5qb2luKCcsICcpOyBBcHAucGlja1dlYXRoZXIoci5sYXRpdHVkZSwgci5sb25naXR1ZGUsIG5hbWUpOyB9KTsgfSk7IH1jYXRjaChlKXsgYm94LmlubmVySFRNTD0nPHNwYW4gc3R5bGU9ImNvbG9yOnZhcigtLW11dGVkKSI+RXJyb3Igc2VhcmNoaW5nIChzZWUgY29uc29sZSk8L3NwYW4+JzsgY29uc29sZS5lcnJvcihlKTsgfSB9LAogICAgYXN5bmMgcGlja1dlYXRoZXIobGF0LGxvbixuYW1lKXsgQXBwLnN0YXRlLndlYXRoZXI9eyBuYW1lLCBsYXQsIGxvbiwgdGVtcDpudWxsIH07IFN0b3JhZ2Uuc2V0KCd3ZWF0aGVyJywgQXBwLnN0YXRlLndlYXRoZXIpOyBhd2FpdCBBcHAucmVmcmVzaFdlYXRoZXIoKTsgfSwKICAgIGFzeW5jIHJlZnJlc2hXZWF0aGVyKCl7IGNvbnN0IGNpdHk9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dlYXRoZXJDaXR5Jyk7IGNvbnN0IG5vd0VsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3ZWF0aGVyTm93Jyk7IGNvbnN0IGN1ckJveD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3hDdXJyZW50Jyk7IGNvbnN0IHc9QXBwLnN0YXRlLndlYXRoZXI7IGlmKCF3LmxhdHx8IXcubG9uKXsgY2l0eS50ZXh0Q29udGVudD0nJzsgbm93RWwudGV4dENvbnRlbnQ9Jy0twrAnOyBjdXJCb3guaW5uZXJIVE1MPSc8c3BhbiBzdHlsZT0iY29sb3I6dmFyKC0tbXV0ZWQpIj5QaWNrIGEgY2l0eSB0byBzZWUgd2VhdGhlci48L3NwYW4+JzsgcmV0dXJuOyB9IGNpdHkudGV4dENvbnRlbnQ9dy5uYW1lOyBjdXJCb3guaW5uZXJIVE1MPSdMb2FkaW5n4oCmJzsgdHJ5eyBjb25zdCB1cmw9YGh0dHBzOi8vYXBpLm9wZW4tbWV0ZW8uY29tL3YxL2ZvcmVjYXN0P2xhdGl0dWRlPSR7dy5sYXR9JmxvbmdpdHVkZT0ke3cubG9ufSZjdXJyZW50PXRlbXBlcmF0dXJlXzJtLHdlYXRoZXJfY29kZSZkYWlseT10ZW1wZXJhdHVyZV8ybV9tYXgsdGVtcGVyYXR1cmVfMm1fbWluLHdlYXRoZXJfY29kZSZ0aW1lem9uZT1hdXRvJnRlbXBlcmF0dXJlX3VuaXQ9ZmFocmVuaGVpdGA7IGNvbnN0IGRhdGE9YXdhaXQgZmV0Y2hKU09OKHVybCk7IGlmKCFkYXRhPy5jdXJyZW50fHwhZGF0YT8uZGFpbHkpIHRocm93IG5ldyBFcnJvcignQmFkIHdlYXRoZXIgc2hhcGUnKTsgY29uc3QgdD1NYXRoLnJvdW5kKGRhdGEuY3VycmVudC50ZW1wZXJhdHVyZV8ybSk7IG5vd0VsLnRleHRDb250ZW50PXQrJ8KwJzsgY29uc3QgZGF5cz1bMCwxLDJdLmZpbHRlcihpPT4gZGF0YS5kYWlseS50aW1lPy5baV0gIT0gbnVsbCk7IGN1ckJveC5pbm5lckhUTUwgPSBgPGRpdiBzdHlsZT0nZGlzcGxheTpmbGV4O2dhcDoxMHB4O2FsaWduLWl0ZW1zOmNlbnRlcjttYXJnaW4tdG9wOjZweCc+PGRpdiBzdHlsZT0nZm9udC13ZWlnaHQ6ODAwO2ZvbnQtc2l6ZToxOHB4Jz4ke3R9wrAgbm93PC9kaXY+PGRpdiBzdHlsZT0nY29sb3I6dmFyKC0tbXV0ZWQpJz4ke3cubmFtZX08L2Rpdj48L2Rpdj48ZGl2IHN0eWxlPSdkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdCgke2RheXMubGVuZ3RofSwxZnIpO2dhcDo4cHg7bWFyZ2luLXRvcDo4cHgnPiR7ZGF5cy5tYXAoaT0+YDxkaXYgc3R5bGU9J2JhY2tncm91bmQ6dmFyKC0tY2FyZCk7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LC4wOCk7Ym9yZGVyLXJhZGl1czoxMHB4O3BhZGRpbmc6OHB4O3RleHQtYWxpZ246Y2VudGVyJz48ZGl2IHN0eWxlPSdmb250LXdlaWdodDo3MDAnPiR7bmV3IERhdGUoZGF0YS5kYWlseS50aW1lW2ldKS50b0xvY2FsZURhdGVTdHJpbmcodW5kZWZpbmVkLHt3ZWVrZGF5OidzaG9ydCd9KX08L2Rpdj48ZGl2PjxzdHJvbmc+JHtNYXRoLnJvdW5kKGRhdGEuZGFpbHkudGVtcGVyYXR1cmVfMm1fbWF4W2ldKX3CsDwvc3Ryb25nPiAvICR7TWF0aC5yb3VuZChkYXRhLmRhaWx5LnRlbXBlcmF0dXJlXzJtX21pbltpXSl9wrA8L2Rpdj48L2Rpdj5gKS5qb2luKCcnKX08L2Rpdj5gOyB9Y2F0Y2goZSl7IGNvbnNvbGUuZXJyb3IoJ1tXWF0nLGUpOyBub3dFbC50ZXh0Q29udGVudD0nLS3CsCc7IGN1ckJveC5pbm5lckhUTUw9JzxzcGFuIHN0eWxlPSJjb2xvcjp2YXIoLS1tdXRlZCkiPldlYXRoZXIgdW5hdmFpbGFibGUgKHNlZSBjb25zb2xlKTwvc3Bhbj4nOyB9IH0sCgogICAgLyogSW50ZXJuZXQgKHNlYXJjaCBiYXIgb25seSkgKi8KICAgIHRvZ2dsZUlFWCgpeyBBcHAuc3RhdGUuaWV4LnZpc2libGUgPSAhQXBwLnN0YXRlLmlleC52aXNpYmxlOyBTdG9yYWdlLnNldCgnaWV4JywgQXBwLnN0YXRlLmlleCk7IGlmKEFwcC5zdGF0ZS5pZXgudmlzaWJsZSkgQXBwLnNob3dJRVgoKTsgZWxzZSBBcHAuaGlkZUlFWCgpOyB9LAogICAgc2hvd0lFWCgpeyBjb25zdCBwPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZXhQYW5lbCcpOyBwLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOyBBcHAuYXBwbHlJRVhTdHlsZSgpOyBoaWRlQWxsRHJvcGRvd25zKCk7IFN0b3JhZ2Uuc2V0KCdpZXgnLCBBcHAuc3RhdGUuaWV4KTsgfSwKICAgIGhpZGVJRVgoKXsgY29uc3QgcD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWV4UGFuZWwnKTsgcC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsgaGlkZUFsbERyb3Bkb3ducygpOyBTdG9yYWdlLnNldCgnaWV4JywgQXBwLnN0YXRlLmlleCk7IH0sCiAgICBzZXRJRVhFbmdpbmUodmFsKXsgQXBwLnN0YXRlLmlleC5lbmdpbmU9dmFsOyBTdG9yYWdlLnNldCgnaWV4JywgQXBwLnN0YXRlLmlleCk7IH0sCiAgICBzZXRJRVhTdHlsZSh2YWwpeyBBcHAuc3RhdGUuaWV4LnN0eWxlPXZhbDsgU3RvcmFnZS5zZXQoJ2lleCcsIEFwcC5zdGF0ZS5pZXgpOyBBcHAuYXBwbHlJRVhTdHlsZSgpOyB9LAogICAgYXBwbHlJRVhTdHlsZSgpeyBjb25zdCBwPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZXhQYW5lbCcpOyBwLmNsYXNzTmFtZSA9IGBpZXggaWV4LS0ke0FwcC5zdGF0ZS5pZXguc3R5bGUgfHwgJ3BpbmtibHVlJ30gJHtBcHAuc3RhdGUuaWV4LnZpc2libGUgPyAnJyA6ICdoaWRkZW4nfWAudHJpbSgpOyB9LAogICAgaWV4TmF2aWdhdGUoKXsgY29uc3QgcT0oZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lleElucHV0JykudmFsdWV8fCcnKS50cmltKCk7IGlmKCFxKSByZXR1cm47IGNvbnN0IGVuZz1BcHAuc3RhdGUuaWV4LmVuZ2luZXx8J2JyYXZlJzsgY29uc3QgdXJsPUFwcC5zZWFyY2hVUkwoZW5nLCBxKTsgd2luZG93Lm9wZW4odXJsLCAnX2JsYW5rJyk7IH0sCiAgICBzZWFyY2hVUkwoZW5naW5lLCBxdWVyeSl7IHN3aXRjaChlbmdpbmUpeyBjYXNlICdnb29nbGUnOiByZXR1cm4gYGh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vc2VhcmNoP3E9JHtlbmNvZGVVUklDb21wb25lbnQocXVlcnkpfWA7IGNhc2UgJ2JpbmcnOiByZXR1cm4gYGh0dHBzOi8vd3d3LmJpbmcuY29tL3NlYXJjaD9xPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KX1gOyBkZWZhdWx0OiByZXR1cm4gYGh0dHBzOi8vc2VhcmNoLmJyYXZlLmNvbS9zZWFyY2g/cT0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSl9YDsgfSB9LAoKICAgIC8qIExlZnQgRG9jayAoU3RvY2tzL05ld3MpICovCiAgICB0b2dnbGVEb2NrKG1vZGUpeyBpZihBcHAuc3RhdGUuZG9jay5vcGVuICYmIEFwcC5zdGF0ZS5kb2NrLm1vZGU9PT1tb2RlKXsgQXBwLmNsb3NlRG9jaygpOyByZXR1cm47IH0gQXBwLm9wZW5Eb2NrKG1vZGUpOyB9LAogICAgb3BlbkRvY2sobW9kZSwgcmVzdG9yaW5nPWZhbHNlKXsgY29uc3QgZG9jaz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVmdERvY2snKTsgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdkb2NrLW9wZW4nKTsgY29uc3QgdGl0bGU9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RvY2tUaXRsZScpOyBjb25zdCBzcmNTZWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RvY2tTb3VyY2UnKTsgY29uc3QgcHJlc2V0cyA9IChtb2RlPT09J3N0b2NrcycpID8gQXBwLnN0b2NrUHJlc2V0cygpIDogQXBwLm5ld3NQcmVzZXRzKCk7IHNyY1NlbC5pbm5lckhUTUwgPSBwcmVzZXRzLm1hcChwPT5gPG9wdGlvbiB2YWx1ZT0iJHtwLmtleX0iPiR7cC5uYW1lfTwvb3B0aW9uPmApLmpvaW4oJycpOyBjb25zdCBwaWNrZWQgPSBBcHAuc3RhdGUuZG9jay5zb3VyY2UgJiYgcHJlc2V0cy5zb21lKHA9PnAua2V5PT09QXBwLnN0YXRlLmRvY2suc291cmNlKSA/IEFwcC5zdGF0ZS5kb2NrLnNvdXJjZSA6IHByZXNldHNbMF0ua2V5OyBzcmNTZWwudmFsdWU9cGlja2VkOyB0aXRsZS50ZXh0Q29udGVudCA9IG1vZGU9PT0nc3RvY2tzJyA/ICdTdG9ja3MnIDogJ05ld3MnOyBkb2NrLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsgQXBwLnN0YXRlLmRvY2s9eyBvcGVuOnRydWUsIG1vZGUsIHNvdXJjZTpwaWNrZWQgfTsgU3RvcmFnZS5zZXQoJ2RvY2snLCBBcHAuc3RhdGUuZG9jayk7IEFwcC5sb2FkRG9ja1NvdXJjZShwaWNrZWQpOyB9LAogICAgY2xvc2VEb2NrKCl7IGNvbnN0IGRvY2s9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xlZnREb2NrJyk7IGRvY2suc3R5bGUuZGlzcGxheT0nbm9uZSc7IGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnZG9jay1vcGVuJyk7IEFwcC5zdGF0ZS5kb2NrLm9wZW49ZmFsc2U7IFN0b3JhZ2Uuc2V0KCdkb2NrJywgQXBwLnN0YXRlLmRvY2spOyB9LAogICAgc3RvY2tQcmVzZXRzKCl7IHJldHVybiBbIHtrZXk6J292ZXJ2aWV3JywgbmFtZTonTWFya2V0IE92ZXJ2aWV3J30sIHtrZXk6J3RhcGUnLCBuYW1lOidUaWNrZXIgVGFwZSd9LCB7a2V5OidjcnlwdG8nLCBuYW1lOidDcnlwdG8gU2NyZWVuZXInfSBdOyB9LAogICAgbmV3c1ByZXNldHMoKXsgcmV0dXJuIFsgeyBrZXk6J2huJywgbmFtZTonVGVjaDogSGFja2VyIE5ld3MnIH0sIHsga2V5OidiYmMtd29ybGQnLCBuYW1lOidCQkM6IFdvcmxkJyB9LCB7IGtleTonbnByLXRvcCcsIG5hbWU6J05QUjogVG9wIFN0b3JpZXMnIH0sIHsga2V5OidhcnMnLCBuYW1lOidBcnMgVGVjaG5pY2EnIH0gXTsgfSwKCiAgICBsb2FkRG9ja1NvdXJjZShrZXkpeyBjb25zdCBib2R5PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkb2NrQm9keScpOyBib2R5LmlubmVySFRNTD0nJzsgaWYoQXBwLnN0YXRlLmRvY2subW9kZT09PSdzdG9ja3MnKXsgQXBwLnN0YXRlLmRvY2suc291cmNlPWtleTsgU3RvcmFnZS5zZXQoJ2RvY2snLCBBcHAuc3RhdGUuZG9jayk7IGNvbnN0IHdyYXA9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IHdyYXAuY2xhc3NOYW1lPSd3aWRnZXQnOyBib2R5LmFwcGVuZENoaWxkKHdyYXApOyBpZihrZXk9PT0nb3ZlcnZpZXcnKSBBcHAuaW5qZWN0VFZXaWRnZXQod3JhcCwgJ21hcmtldC1vdmVydmlldycpOyBpZihrZXk9PT0ndGFwZScpIEFwcC5pbmplY3RUVldpZGdldCh3cmFwLCAndGlja2VyLXRhcGUnKTsgaWYoa2V5PT09J2NyeXB0bycpIEFwcC5pbmplY3RUVldpZGdldCh3cmFwLCAnY3J5cHRvJyk7IHJldHVybjsgfSBBcHAuc3RhdGUuZG9jay5zb3VyY2U9a2V5OyBTdG9yYWdlLnNldCgnZG9jaycsIEFwcC5zdGF0ZS5kb2NrKTsgaWYoa2V5PT09J2huJykgcmV0dXJuIEFwcC5yZW5kZXJITihib2R5KTsgaWYoa2V5PT09J2JiYy13b3JsZCcpIHJldHVybiBBcHAucmVuZGVyUlNTKGJvZHksICdodHRwczovL2ZlZWRzLmJiY2kuY28udWsvbmV3cy93b3JsZC9yc3MueG1sJyk7IGlmKGtleT09PSducHItdG9wJykgcmV0dXJuIEFwcC5yZW5kZXJSU1MoYm9keSwgJ2h0dHBzOi8vZmVlZHMubnByLm9yZy8xMDAxL3Jzcy54bWwnKTsgaWYoa2V5PT09J2FycycpIHJldHVybiBBcHAucmVuZGVyUlNTKGJvZHksICdodHRwczovL2ZlZWRzLmFyc3RlY2huaWNhLmNvbS9hcnN0ZWNobmljYS9pbmRleCcpOyB9LAoKICAgIGFzeW5jIHJlbmRlckhOKGJvZHkpeyBib2R5LmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPSdsaXN0Jz48ZGl2IGNsYXNzPSdpdGVtJz5Mb2FkaW5nIEhhY2tlciBOZXdz4oCmPC9kaXY+PC9kaXY+YDsgdHJ5eyBjb25zdCBpZHMgPSBhd2FpdCBmZXRjaEpTT04oJ2h0dHBzOi8vaGFja2VyLW5ld3MuZmlyZWJhc2Vpby5jb20vdjAvdG9wc3Rvcmllcy5qc29uJyk7IGNvbnN0IHRvcCA9IGlkcy5zbGljZSgwLDMwKTsgY29uc3QgaXRlbXMgPSBhd2FpdCBQcm9taXNlLmFsbCh0b3AubWFwKGFzeW5jIGlkPT57IHRyeXsgcmV0dXJuIGF3YWl0IGZldGNoSlNPTihgaHR0cHM6Ly9oYWNrZXItbmV3cy5maXJlYmFzZWlvLmNvbS92MC9pdGVtLyR7aWR9Lmpzb25gKTsgfWNhdGNoe3JldHVybiBudWxsO30gfSkpOyBjb25zdCBsaXN0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBsaXN0LmNsYXNzTmFtZT0nbGlzdCc7IGl0ZW1zLmZpbHRlcihCb29sZWFuKS5mb3JFYWNoKGl0PT57IGNvbnN0IGhyZWY9aXQudXJsIHx8IGBodHRwczovL25ld3MueWNvbWJpbmF0b3IuY29tL2l0ZW0/aWQ9JHtpdC5pZH1gOyBjb25zdCBkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IGRpdi5jbGFzc05hbWU9J2l0ZW0nOyBsZXQgZmF2PScnOyB0cnl7IGNvbnN0IHU9bmV3IFVSTChocmVmKTsgY29uc3QgZj1gaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9zMi9mYXZpY29ucz9zej02NCZkb21haW49JHt1Lmhvc3RuYW1lfWA7IGZhdiA9IGA8aW1nIGNsYXNzPSdmYXZpY29uJyBzcmM9JyR7Zn0nIGFsdD0nJz5gOyB9Y2F0Y2h7fSBkaXYuaW5uZXJIVE1MPWZhdjsgY29uc3QgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7IGEuaHJlZj1ocmVmOyBhLnRhcmdldD0nX2JsYW5rJzsgYS5yZWw9J25vb3BlbmVyJzsgYS50ZXh0Q29udGVudD1pdC50aXRsZTsgZGl2LmFwcGVuZENoaWxkKGEpOyBjb25zdCBtZXRhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBtZXRhLmNsYXNzTmFtZT0nbWV0YSc7IGNvbnN0IHdoZW49aXQudGltZSA/IG5ldyBEYXRlKGl0LnRpbWUqMTAwMCkudG9Mb2NhbGVTdHJpbmcoKSA6ICcnOyBtZXRhLnRleHRDb250ZW50ID0gYEhhY2tlciBOZXdzICR7d2hlbj8gJ+KAoiAnICsgd2hlbiA6ICcnfWA7IGRpdi5hcHBlbmRDaGlsZChtZXRhKTsgbGlzdC5hcHBlbmRDaGlsZChkaXYpOyB9KTsgYm9keS5pbm5lckhUTUw9Jyc7IGJvZHkuYXBwZW5kQ2hpbGQobGlzdCk7IH1jYXRjaChlKXsgY29uc29sZS5lcnJvcignW0hOXScsIGUpOyBib2R5LmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPSdlbXB0eSc+Q291bGQgbm90IGxvYWQgSGFja2VyIE5ld3MuPC9kaXY+YDsgfSB9LAoKICAgIGFzeW5jIHJlbmRlclJTUyhib2R5LCByc3NVcmwpeyBib2R5LmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPSdsaXN0Jz48ZGl2IGNsYXNzPSdpdGVtJz5Mb2FkaW5nIG5ld3PigKY8L2Rpdj48L2Rpdj5gOyBjb25zdCBkcmF3PShpdGVtcywgZmVlZFRpdGxlPScnKT0+eyBjb25zdCBsaXN0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBsaXN0LmNsYXNzTmFtZT0nbGlzdCc7IGl0ZW1zLnNsaWNlKDAsMzApLmZvckVhY2goZW50cnk9PnsgY29uc3QgaHJlZj1lbnRyeS5saW5rIHx8IGVudHJ5LnVybCB8fCAnIyc7IGNvbnN0IGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgZGl2LmNsYXNzTmFtZT0naXRlbSc7IGxldCBmYXY9Jyc7IHRyeXsgY29uc3QgdT1uZXcgVVJMKGhyZWYpOyBjb25zdCBmPWBodHRwczovL3d3dy5nb29nbGUuY29tL3MyL2Zhdmljb25zP3N6PTY0JmRvbWFpbj0ke3UuaG9zdG5hbWV9YDsgZmF2ID0gYDxpbWcgY2xhc3M9J2Zhdmljb24nIHNyYz0nJHtmfScgYWx0PScnPmA7IH1jYXRjaHt9IGRpdi5pbm5lckhUTUw9ZmF2OyBjb25zdCBhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsgYS5ocmVmPWhyZWY7IGEudGFyZ2V0PSdfYmxhbmsnOyBhLnJlbD0nbm9vcGVuZXInOyBhLnRleHRDb250ZW50PWVudHJ5LnRpdGxlIHx8ICcobm8gdGl0bGUpJzsgZGl2LmFwcGVuZENoaWxkKGEpOyBjb25zdCBtZXRhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBtZXRhLmNsYXNzTmFtZT0nbWV0YSc7IGNvbnN0IGRhdGU9ZW50cnkucHViRGF0ZSB8fCBlbnRyeS5kYXRlIHx8IGVudHJ5LnB1Ymxpc2hlZCB8fCAnJzsgY29uc3Qgd2hlbj1kYXRlID8gbmV3IERhdGUoZGF0ZSkudG9Mb2NhbGVTdHJpbmcoKSA6ICcnOyBtZXRhLnRleHRDb250ZW50ID0gYCR7ZmVlZFRpdGxlfSAke3doZW4/ICfigKIgJyArIHdoZW4gOiAnJ31gLnRyaW0oKTsgZGl2LmFwcGVuZENoaWxkKG1ldGEpOyBsaXN0LmFwcGVuZENoaWxkKGRpdik7IH0pOyBib2R5LmlubmVySFRNTD0nJzsgYm9keS5hcHBlbmRDaGlsZChsaXN0KTsgfTsKICAgICAgdHJ5eyBjb25zdCBhcGk9YGh0dHBzOi8vYXBpLnJzczJqc29uLmNvbS92MS9hcGkuanNvbj9yc3NfdXJsPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHJzc1VybCl9YDsgY29uc3QgZGF0YT1hd2FpdCBmZXRjaEpTT04oYXBpKTsgaWYoZGF0YT8uaXRlbXM/Lmxlbmd0aCkgcmV0dXJuIGRyYXcoZGF0YS5pdGVtcywgZGF0YS5mZWVkPy50aXRsZSB8fCAnJyk7IHRocm93IG5ldyBFcnJvcigncnNzMmpzb24gZW1wdHknKTsgfSBjYXRjaChlMSl7IHRyeXsgY29uc3QgcHJveD0odSk9PmBodHRwczovL3IuamluYS5haS8ke3Uuc3RhcnRzV2l0aCgnaHR0cCcpP3U6J2h0dHBzOi8vJyt1fWA7IGNvbnN0IHJlc3A9YXdhaXQgZmV0Y2gocHJveChyc3NVcmwpKTsgY29uc3QgeG1sVGV4dD1hd2FpdCByZXNwLnRleHQoKTsgY29uc3QgZG9jPW5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoeG1sVGV4dCwndGV4dC94bWwnKTsgY29uc3QgY2hhbm5lbFRpdGxlPWRvYy5xdWVyeVNlbGVjdG9yKCdjaGFubmVsPnRpdGxlJyk/LnRleHRDb250ZW50IHx8IGRvYy5xdWVyeVNlbGVjdG9yKCdmZWVkPnRpdGxlJyk/LnRleHRDb250ZW50IHx8ICcnOyBjb25zdCBpdGVtcz1bXTsgZG9jLnF1ZXJ5U2VsZWN0b3JBbGwoJ2l0ZW0sIGVudHJ5JykuZm9yRWFjaChuPT57IGl0ZW1zLnB1c2goeyB0aXRsZTpuLnF1ZXJ5U2VsZWN0b3IoJ3RpdGxlJyk/LnRleHRDb250ZW50IHx8ICcnLCBsaW5rOiBuLnF1ZXJ5U2VsZWN0b3IoJ2xpbmsnKT8uZ2V0QXR0cmlidXRlKCdocmVmJykgfHwgbi5xdWVyeVNlbGVjdG9yKCdsaW5rJyk/LnRleHRDb250ZW50IHx8ICcnLCBwdWJEYXRlOm4ucXVlcnlTZWxlY3RvcigncHViRGF0ZScpPy50ZXh0Q29udGVudCB8fCBuLnF1ZXJ5U2VsZWN0b3IoJ3VwZGF0ZWQnKT8udGV4dENvbnRlbnQgfHwgbi5xdWVyeVNlbGVjdG9yKCdwdWJsaXNoZWQnKT8udGV4dENvbnRlbnQgfHwgJycgfSk7IH0pOyBpZihpdGVtcy5sZW5ndGgpIHJldHVybiBkcmF3KGl0ZW1zLCBjaGFubmVsVGl0bGUpOyB0aHJvdyBuZXcgRXJyb3IoJ1BhcnNlZCAwIGl0ZW1zJyk7IH0gY2F0Y2goZTIpeyBjb25zb2xlLmVycm9yKCdbTkVXU10gYm90aCBmYWlsZWQnLCBlMSwgZTIpOyBib2R5LmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPSdlbXB0eSc+TmV3cyBmZWVkIGJsb2NrZWQgb3IgdW5hdmFpbGFibGUuIFRyeSBhbm90aGVyIHNvdXJjZS48L2Rpdj5gOyB9IH0KICAgIH0sCgogICAgLyogU3RvY2tzIHdpZGdldHMgKFRyYWRpbmdWaWV3IG9mZmljaWFsKSAqLwogICAgaW5qZWN0VFZXaWRnZXQoY29udGFpbmVyLCB0eXBlKXsgY29uc3Qgcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsgcy5hc3luYz10cnVlOyBpZih0eXBlPT09J3RpY2tlci10YXBlJyl7IHMuc3JjPSdodHRwczovL3MzLnRyYWRpbmd2aWV3LmNvbS9leHRlcm5hbC1lbWJlZGRpbmcvZW1iZWQtd2lkZ2V0LXRpY2tlci10YXBlLmpzJzsgcy5pbm5lckhUTUw9SlNPTi5zdHJpbmdpZnkoeyBzeW1ib2xzOlsge3Byb05hbWU6J0ZPUkVYQ09NOlNQWFVTRCcsdGl0bGU6J1MmUCA1MDAnfSx7cHJvTmFtZTonTkFTREFROk5EWCcsdGl0bGU6J05hc2RhcSAxMDAnfSx7cHJvTmFtZTonREpJJyx0aXRsZTonRG93IDMwJ30se3Byb05hbWU6J0NNRV9NSU5JOkVTMSEnLHRpdGxlOidTJlAgNTAwIEZ1dHVyZXMnfSx7cHJvTmFtZTonQklUU1RBTVA6QlRDVVNEJyx0aXRsZTonQlRDL1VTRCd9LHtwcm9OYW1lOidPQU5EQTpFVVJVU0QnLHRpdGxlOidFVVIvVVNEJ30gXSwgc2hvd1N5bWJvbExvZ286dHJ1ZSwgY29sb3JUaGVtZTonZGFyaycsIGlzVHJhbnNwYXJlbnQ6dHJ1ZSwgZGlzcGxheU1vZGU6J2FkYXB0aXZlJywgbG9jYWxlOidlbicgfSk7IH0gZWxzZSBpZih0eXBlPT09J2NyeXB0bycpeyBzLnNyYz0naHR0cHM6Ly9zMy50cmFkaW5ndmlldy5jb20vZXh0ZXJuYWwtZW1iZWRkaW5nL2VtYmVkLXdpZGdldC1zY3JlZW5lci5qcyc7IHMuaW5uZXJIVE1MPUpTT04uc3RyaW5naWZ5KHsgZGVmYXVsdENvbHVtbjonb3ZlcnZpZXcnLCBzY3JlZW5lcl90eXBlOidjcnlwdG9fbWt0JywgZGlzcGxheUN1cnJlbmN5OidVU0QnLCBjb2xvclRoZW1lOidkYXJrJywgaXNUcmFuc3BhcmVudDp0cnVlLCBsb2NhbGU6J2VuJywgd2lkdGg6JzEwMCUnLCBoZWlnaHQ6JzEwMCUnIH0pOyB9IGVsc2UgeyBzLnNyYz0naHR0cHM6Ly9zMy50cmFkaW5ndmlldy5jb20vZXh0ZXJuYWwtZW1iZWRkaW5nL2VtYmVkLXdpZGdldC1tYXJrZXQtb3ZlcnZpZXcuanMnOyBzLmlubmVySFRNTD1KU09OLnN0cmluZ2lmeSh7IGNvbG9yVGhlbWU6J2RhcmsnLCBkYXRlUmFuZ2U6JzFEJywgc2hvd0NoYXJ0OnRydWUsIGxvY2FsZTonZW4nLCBpc1RyYW5zcGFyZW50OnRydWUsIHdpZHRoOicxMDAlJywgaGVpZ2h0OicxMDAlJywgdGFiczpbIHt0aXRsZTonSW5kaWNlcycsIHN5bWJvbHM6W3tzOidGT1JFWENPTTpTUFhVU0QnfSx7czonTkFTREFROk5EWCd9LHtzOidESkknfSx7czonQ01FX01JTkk6RVMxISd9XX0sIHt0aXRsZTonRm9yZXgnLCBzeW1ib2xzOlt7czonT0FOREE6RVVSVVNEJ30se3M6J09BTkRBOkdCUFVTRCd9LHtzOidPQU5EQTpVU0RKUFknfV19LCB7dGl0bGU6J0NyeXB0bycsIHN5bWJvbHM6W3tzOidCSVRTVEFNUDpCVENVU0QnfSx7czonQ09JTkJBU0U6RVRIVVNEJ30se3M6J0JJTkFOQ0U6U09MVVNEVCd9XX0gXSB9KTsgfQogICAgICBjb25zdCBib3g9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IGJveC5jbGFzc05hbWU9J3RyYWRpbmd2aWV3LXdpZGdldC1jb250YWluZXInOyBjb25zdCBpbm5lcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgaW5uZXIuY2xhc3NOYW1lPSd0cmFkaW5ndmlldy13aWRnZXQtY29udGFpbmVyX193aWRnZXQnOyBib3guYXBwZW5kQ2hpbGQoaW5uZXIpOyBjb250YWluZXIuYXBwZW5kQ2hpbGQoYm94KTsgY29udGFpbmVyLmFwcGVuZENoaWxkKHMpOyB9LAogIH07CgogIC8vIERyb3Bkb3duIGhlbHBlcnMKICBmdW5jdGlvbiBoaWRlQWxsRHJvcGRvd25zKCl7IFsnc2hvcnRjdXRzRHJvcCcsJ3RoZW1lRHJvcCcsJ3RpbWVEcm9wJywnY2FsZW5kYXJEcm9wJywnd2VhdGhlckRyb3AnLCduYXZEcm9wJywnaW50ZXJuZXREcm9wJ10uZm9yRWFjaChpZD0+eyBjb25zdCBlbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7IGlmKGVsKSBlbC5zdHlsZS5kaXNwbGF5PSdub25lJzsgfSk7IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5taW5pLW1lbnUnKS5mb3JFYWNoKG09PiBtLnN0eWxlLmRpc3BsYXk9J25vbmUnKTsgfQogIGZ1bmN0aW9uIHRvZ2dsZURyb3Bkb3duKGlkKXsgY29uc3QgZWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOyBjb25zdCBvcGVuID0gZWwuc3R5bGUuZGlzcGxheT09PSdibG9jayc7IGhpZGVBbGxEcm9wZG93bnMoKTsgZWwuc3R5bGUuZGlzcGxheSA9IG9wZW4gPyAnbm9uZScgOiAnYmxvY2snOyB9CiAgQXBwLnRvZ2dsZUhlYWRpbmdBY3Rpb25zID0gKGV2LCBuYW1lLCBmb3JjZUNsb3NlPWZhbHNlKT0+eyBjb25zdCBpZD0naGEtJytuYW1lOyBjb25zdCBlbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7IGlmKGV2KSBldi5zdG9wUHJvcGFnYXRpb24oKTsgaWYoZm9yY2VDbG9zZSl7IGVsLnN0eWxlLmRpc3BsYXk9J25vbmUnOyByZXR1cm47IH0gY29uc3Qgc2hvdyA9IGVsLnN0eWxlLmRpc3BsYXkhPT0nYmxvY2snOyBoaWRlQWxsRHJvcGRvd25zKCk7IGVsLnN0eWxlLmRpc3BsYXkgPSBzaG93ID8gJ2Jsb2NrJyA6ICdub25lJzsgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlPT4gZS5zdG9wUHJvcGFnYXRpb24oKSwgeyBvbmNlOnRydWUgfSk7IH07CgogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgQXBwLmluaXQpOwogIAovLyA9PT0gUGF0Y2g6IGFkZCBtaXNzaW5nIHNob3J0Y3V0IGNyZWF0aW9uIGZ1bmN0aW9ucyA9PT0KaWYoIUFwcC5hZGRTaG9ydGN1dCl7CiAgQXBwLmFkZFNob3J0Y3V0ID0gZnVuY3Rpb24oKXsKICAgIHRyeXsKICAgICAgY29uc3Qgc2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlYWRpbmdTZWxlY3QnKTsKICAgICAgY29uc3QgaGVhZGluZyA9IHNlbCAmJiBzZWwudmFsdWU7CiAgICAgIGNvbnN0IG5hbWUgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0TmFtZScpLnZhbHVlIHx8ICcnKS50cmltKCk7CiAgICAgIGNvbnN0IHVybCAgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0VVJMJykudmFsdWUgfHwgJycpLnRyaW0oKTsKICAgICAgaWYoIWhlYWRpbmcpeyBBcHAuc2hvd1RvYXN0KCdQaWNrIGEgaGVhZGluZyBmaXJzdCcsICfimqDvuI8nKTsgcmV0dXJuOyB9CiAgICAgIGlmKCFuYW1lIHx8ICF1cmwpeyBBcHAuc2hvd1RvYXN0KCdOYW1lIGFuZCBVUkwgcmVxdWlyZWQnLCAn4pqg77iPJyk7IHJldHVybjsgfQogICAgICBjb25zdCBpZCA9IERhdGUubm93KCk7CiAgICAgIGNvbnN0IGl0ZW0gPSB7IGlkLCBuYW1lLCB1cmwsIGNvbG9yTmFtZTogJ0RlZmF1bHQnIH07CiAgICAgIGxldCBidWNrZXQgPSBBcHAuc3RhdGUuc2hvcnRjdXRzLmZpbmQoaD0+aC5oZWFkaW5nPT09aGVhZGluZyk7CiAgICAgIGlmKCFidWNrZXQpeyBidWNrZXQgPSB7IGhlYWRpbmcsIHNob3J0Y3V0czogW10gfTsgQXBwLnN0YXRlLnNob3J0Y3V0cy5wdXNoKGJ1Y2tldCk7IH0KICAgICAgYnVja2V0LnNob3J0Y3V0cy5wdXNoKGl0ZW0pOwogICAgICBTdG9yYWdlLnNldCgnc2hvcnRjdXRzJywgQXBwLnN0YXRlLnNob3J0Y3V0cyk7CiAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjYXJkcy0ke2hlYWRpbmd9YCk7CiAgICAgIGlmKGNvbnRhaW5lcil7IEFwcC5jcmVhdGVDYXJkKGNvbnRhaW5lciwgaGVhZGluZywgaXRlbSk7IH0KICAgICAgQXBwLmluamVjdFNob3J0Y3V0Um93KGhlYWRpbmcsIGl0ZW0pOwogICAgICBjb25zdCBuPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG9ydGN1dE5hbWUnKTsgaWYobikgbi52YWx1ZT0nJzsKICAgICAgY29uc3QgdT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvcnRjdXRVUkwnKTsgaWYodSkgdS52YWx1ZT0nJzsKICAgICAgQXBwLnNob3dUb2FzdCgnU2hvcnRjdXQgYWRkZWQnLCAn4pyFJyk7CiAgICB9Y2F0Y2goZSl7IGNvbnNvbGUuZXJyb3IoJ1thZGRTaG9ydGN1dF0nLCBlKTsgQXBwLnNob3dUb2FzdCgnQ291bGQgbm90IGFkZCBzaG9ydGN1dCAoc2VlIGNvbnNvbGUpJywgJ+KaoO+4jycpOyB9CiAgfTsKfQppZighQXBwLmFkZFNob3J0Y3V0SW5saW5lKXsKICBBcHAuYWRkU2hvcnRjdXRJbmxpbmUgPSBmdW5jdGlvbihoZWFkaW5nKXsKICAgIGNvbnN0IG5hbWUgPSBwcm9tcHQoJ1Nob3J0Y3V0IG5hbWU6Jyk7CiAgICBpZighbmFtZSkgcmV0dXJuOwogICAgY29uc3QgdXJsID0gcHJvbXB0KCdVUkwgKGh0dHBzOi8v4oCmKTonLCdodHRwczovLycpOwogICAgaWYoIXVybCkgcmV0dXJuOwogICAgY29uc3QgaWQgPSBEYXRlLm5vdygpOwogICAgY29uc3QgaXRlbSA9IHsgaWQsIG5hbWU6IG5hbWUudHJpbSgpLCB1cmw6IHVybC50cmltKCksIGNvbG9yTmFtZTogJ0RlZmF1bHQnIH07CiAgICBsZXQgYnVja2V0ID0gQXBwLnN0YXRlLnNob3J0Y3V0cy5maW5kKGg9PmguaGVhZGluZz09PWhlYWRpbmcpOwogICAgaWYoIWJ1Y2tldCl7IGJ1Y2tldCA9IHsgaGVhZGluZywgc2hvcnRjdXRzOiBbXSB9OyBBcHAuc3RhdGUuc2hvcnRjdXRzLnB1c2goYnVja2V0KTsgfQogICAgYnVja2V0LnNob3J0Y3V0cy5wdXNoKGl0ZW0pOwogICAgU3RvcmFnZS5zZXQoJ3Nob3J0Y3V0cycsIEFwcC5zdGF0ZS5zaG9ydGN1dHMpOwogICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGNhcmRzLSR7aGVhZGluZ31gKTsKICAgIGlmKGNvbnRhaW5lcil7IEFwcC5jcmVhdGVDYXJkKGNvbnRhaW5lciwgaGVhZGluZywgaXRlbSk7IH0KICAgIEFwcC5pbmplY3RTaG9ydGN1dFJvdyhoZWFkaW5nLCBpdGVtKTsKICAgIEFwcC5zaG93VG9hc3QoJ1Nob3J0Y3V0IGFkZGVkJywgJ+KchScpOwogIH07Cn0KCgpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCk9PnsKICBpZihkb2N1bWVudCAmJiAhd2luZG93Ll9fY2xpY2tDbG9zZXJBdHRhY2hlZCl7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIEFwcC5fZ2xvYmFsQ2xpY2tDbG9zZSwgdHJ1ZSk7CiAgICB3aW5kb3cuX19jbGlja0Nsb3NlckF0dGFjaGVkID0gdHJ1ZTsKICB9Cn0pOw=="},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgZnVuY3Rpb24gJChzZWwsIHJvb3Q9ZG9jdW1lbnQpeyByZXR1cm4gcm9vdC5xdWVyeVNlbGVjdG9yKHNlbCk7IH0KICBmdW5jdGlvbiAkYWxsKHNlbCwgcm9vdD1kb2N1bWVudCl7IHJldHVybiBBcnJheS5mcm9tKHJvb3QucXVlcnlTZWxlY3RvckFsbChzZWwpKTsgfQogIGZ1bmN0aW9uIHNhZmUoZm4peyB0cnl7IGZuKCk7IH1jYXRjaChlKXsgY29uc29sZS53YXJuKCdbUmFtaWZ5IG1lcmdlIHBhdGNoXScsIGUpOyB9IH0KCiAgZnVuY3Rpb24gZXhwb3J0QWxsTG9jYWxTdG9yYWdlKCl7CiAgICBjb25zdCBkdW1wID0ge307CiAgICBmb3IobGV0IGk9MDtpPGxvY2FsU3RvcmFnZS5sZW5ndGg7aSsrKXsKICAgICAgY29uc3QgayA9IGxvY2FsU3RvcmFnZS5rZXkoaSk7CiAgICAgIGR1bXBba10gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrKTsKICAgIH0KICAgIGNvbnN0IHBheWxvYWQgPSB7IHZlcnNpb246IDIsIGV4cG9ydGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgc3RvcmFnZTogZHVtcCB9OwogICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtKU09OLnN0cmluZ2lmeShwYXlsb2FkLG51bGwsMildLCB7dHlwZTonYXBwbGljYXRpb24vanNvbid9KTsKICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOyBhLmhyZWYgPSB1cmw7IGEuZG93bmxvYWQ9J3JhbWlmeV9jb25maWcuanNvbic7IGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7IGEuY2xpY2soKTsKICAgIHNldFRpbWVvdXQoKCk9PnsgYS5yZW1vdmUoKTsgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpOyB9LCAwKTsKICB9CgogIGZ1bmN0aW9uIGltcG9ydEFsbExvY2FsU3RvcmFnZShmaWxlKXsKICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICByZWFkZXIub25sb2FkID0gKGV2KT0+ewogICAgICB0cnl7CiAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoU3RyaW5nKGV2LnRhcmdldC5yZXN1bHR8fCd7fScpKTsKICAgICAgICBpZighZGF0YSB8fCB0eXBlb2YgZGF0YSE9PSdvYmplY3QnKSB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZmlsZScpOwogICAgICAgIGNvbnN0IHN0b3JlID0gZGF0YS5zdG9yYWdlIHx8IGRhdGEuc3RhdGUgfHwge307CiAgICAgICAgY29uc3QgZW50cmllcyA9IHN0b3JlLnN0b3JhZ2UgPyBzdG9yZS5zdG9yYWdlIDogc3RvcmU7CiAgICAgICAgbGV0IHdyb3RlID0gMDsKICAgICAgICBmb3IoY29uc3QgW2ssdl0gb2YgT2JqZWN0LmVudHJpZXMoZW50cmllcykpewogICAgICAgICAgdHJ5eyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrLCB0eXBlb2Ygdj09PSdzdHJpbmcnPyB2IDogSlNPTi5zdHJpbmdpZnkodikpOyB3cm90ZSsrOyB9Y2F0Y2h7fQogICAgICAgIH0KICAgICAgICBhbGVydChgSW1wb3J0ZWQgJHt3cm90ZX0ga2V5cy4gUmVsb2FkaW5n4oCmYCk7CiAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH1jYXRjaChlcnIpewogICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsgYWxlcnQoJ0ltcG9ydCBmYWlsZWQ6ICcgKyBlcnIubWVzc2FnZSk7CiAgICAgIH0KICAgIH07CiAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTsKICB9CgogIC8vIEFmdGVyIGFwcCBib290c3RyYXBzCiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpewogICAgLy8gMSkgUGxhY2UgU2V0dGluZ3MgKyBEb3dubG9hZC9VcGxvYWQgbmV4dCB0byB0aGUgYmVsbAogICAgc2FmZShmdW5jdGlvbiBtb3VudFNldHRpbmdzKCl7CiAgICAgIGNvbnN0IG1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9wTWVudScpOwogICAgICBjb25zdCBiZWxsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5SZW1pbmRlcnMnKTsKICAgICAgaWYoIW1lbnUgfHwgIWJlbGwpIHJldHVybjsKICAgICAgLy8gV3JhcCBncm91cAogICAgICBsZXQgZ3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0dGluZ3NHcm91cCcpOwogICAgICBpZighZ3JvdXApewogICAgICAgIGdyb3VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogICAgICAgIGdyb3VwLmlkID0gJ3NldHRpbmdzR3JvdXAnOwogICAgICAgIGdyb3VwLnN0eWxlLmRpc3BsYXk9J2lubGluZS1mbGV4JzsgZ3JvdXAuc3R5bGUuYWxpZ25JdGVtcz0nY2VudGVyJzsgZ3JvdXAuc3R5bGUuZ2FwPSc4cHgnOyBncm91cC5zdHlsZS5wb3NpdGlvbj0ncmVsYXRpdmUnOwogICAgICAgIGJlbGwuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmVuZCcsIGdyb3VwKTsKICAgICAgfQogICAgICAvLyBTZXR0aW5ncyBidXR0b24KICAgICAgbGV0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuU2V0dGluZ3MnKTsKICAgICAgaWYoIWJ0bil7CiAgICAgICAgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgYnRuLmNsYXNzTmFtZT0naWNvbi1idG4nOyBidG4uaWQ9J29wZW5TZXR0aW5ncyc7IGJ0bi50aXRsZT0nU2V0dGluZ3MnOyBidG4udGV4dENvbnRlbnQ9J+Kame+4jyc7CiAgICAgICAgZ3JvdXAuYXBwZW5kQ2hpbGQoYnRuKTsKICAgICAgfQogICAgICAvLyAocmVtb3ZlZCkgRG93bmxvYWQvVXBsb2FkIGNvbnRyb2xzIHBlciByZXF1ZXN0CiAgICB9KTsKCiAgICAvLyAyKSBTaG9ydGN1dHMg4oCUIGVuc3VyZSBlZGl0L2RlbGV0ZS9jb2xvciB3b3JrOyBzaWxlbmNlIOKAnFNob3J0Y3V0IGFkZGVk4oCdIHBvcHVwCiAgICBzYWZlKGZ1bmN0aW9uIHBhdGNoU2hvcnRjdXRzKCl7CiAgICAgIGlmKCF3aW5kb3cuQXBwKXsgcmV0dXJuOyB9CgogICAgICAvLyBIZWxwZXI6IGRlZmF1bHQgbm9uLWdyZXkgY29sb3IKICAgICAgY29uc3QgREVGQVVMVF9TSE9SVENVVF9DT0xPUiA9ICdUZWFsJzsKCiAgICAgIC8vIE92ZXJyaWRlIGFkZCBmdW5jdGlvbnMgc2lsZW50bHkKICAgICAgQXBwLmFkZFNob3J0Y3V0ID0gZnVuY3Rpb24oKXsKICAgICAgICBjb25zdCBzZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVhZGluZ1NlbGVjdCcpOwogICAgICAgIGNvbnN0IGhlYWRpbmcgPSBzZWwgJiYgc2VsLnZhbHVlOwogICAgICAgIGNvbnN0IG5hbWUgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0TmFtZScpPy52YWx1ZSB8fCAnJykudHJpbSgpIHx8ICdOZXcgU2hvcnRjdXQnOwogICAgICAgIGNvbnN0IHVybCAgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0VVJMJyk/LnZhbHVlICB8fCAnJykudHJpbSgpIHx8ICdodHRwczovL2V4YW1wbGUuY29tJzsKICAgICAgICBpZighaGVhZGluZyl7IHJldHVybjsgfQogICAgICAgIGNvbnN0IGlkID0gRGF0ZS5ub3coKTsKICAgICAgICBjb25zdCBpdGVtID0geyBpZCwgbmFtZSwgdXJsLCBjb2xvck5hbWU6IERFRkFVTFRfU0hPUlRDVVRfQ09MT1IgfTsKICAgICAgICBsZXQgYnVja2V0ID0gQXBwLnN0YXRlLnNob3J0Y3V0cy5maW5kKGg9PmguaGVhZGluZz09PWhlYWRpbmcpOwogICAgICAgIGlmKCFidWNrZXQpeyBidWNrZXQgPSB7IGhlYWRpbmcsIHNob3J0Y3V0czogW10gfTsgQXBwLnN0YXRlLnNob3J0Y3V0cy5wdXNoKGJ1Y2tldCk7IH0KICAgICAgICBidWNrZXQuc2hvcnRjdXRzLnB1c2goaXRlbSk7CiAgICAgICAgU3RvcmFnZS5zZXQoJ3Nob3J0Y3V0cycsIEFwcC5zdGF0ZS5zaG9ydGN1dHMpOwogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjYXJkcy0ke2hlYWRpbmd9YCk7CiAgICAgICAgaWYoY29udGFpbmVyKXsgQXBwLmNyZWF0ZUNhcmQoY29udGFpbmVyLCBoZWFkaW5nLCBpdGVtKTsgQXBwLmluamVjdFNob3J0Y3V0Um93KGhlYWRpbmcsIGl0ZW0pOyB9CiAgICAgICAgaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0TmFtZScpKSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvcnRjdXROYW1lJykudmFsdWU9Jyc7CiAgICAgICAgaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0VVJMJykpIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG9ydGN1dFVSTCcpLnZhbHVlPScnOwogICAgICAgIEFwcC5wb3B1bGF0ZUhlYWRpbmdTZWxlY3Q/LigpOwogICAgICAgIC8vIE5vIHRvYXN0CiAgICAgIH07CgogICAgICBBcHAuYWRkU2hvcnRjdXRJbmxpbmUgPSBmdW5jdGlvbihoZWFkaW5nKXsKICAgICAgICBjb25zdCBuYW1lID0gcHJvbXB0KCdTaG9ydGN1dCBuYW1lOicpOyBpZighbmFtZSkgcmV0dXJuOwogICAgICAgIGNvbnN0IHVybCAgPSBwcm9tcHQoJ1VSTCAoaHR0cHM6Ly/igKYpOicsJ2h0dHBzOi8vJyk7IGlmKCF1cmwpIHJldHVybjsKICAgICAgICBjb25zdCBpZCA9IERhdGUubm93KCk7CiAgICAgICAgY29uc3QgaXRlbSA9IHsgaWQsIG5hbWU6IG5hbWUudHJpbSgpLCB1cmw6IHVybC50cmltKCksIGNvbG9yTmFtZTogREVGQVVMVF9TSE9SVENVVF9DT0xPUiB9OwogICAgICAgIGxldCBidWNrZXQgPSBBcHAuc3RhdGUuc2hvcnRjdXRzLmZpbmQoaD0+aC5oZWFkaW5nPT09aGVhZGluZyk7CiAgICAgICAgaWYoIWJ1Y2tldCl7IGJ1Y2tldCA9IHsgaGVhZGluZywgc2hvcnRjdXRzOiBbXSB9OyBBcHAuc3RhdGUuc2hvcnRjdXRzLnB1c2goYnVja2V0KTsgfQogICAgICAgIGJ1Y2tldC5zaG9ydGN1dHMucHVzaChpdGVtKTsKICAgICAgICBTdG9yYWdlLnNldCgnc2hvcnRjdXRzJywgQXBwLnN0YXRlLnNob3J0Y3V0cyk7CiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGNhcmRzLSR7aGVhZGluZ31gKTsKICAgICAgICBpZihjb250YWluZXIpeyBBcHAuY3JlYXRlQ2FyZChjb250YWluZXIsIGhlYWRpbmcsIGl0ZW0pOyBBcHAuaW5qZWN0U2hvcnRjdXRSb3coaGVhZGluZywgaXRlbSk7IH0KICAgICAgICAvLyBObyB0b2FzdAogICAgICB9OwoKICAgICAgLy8gSW1wbGVtZW50IGVkaXQvZGVsZXRlL2NvbG9yIHVzaW5nIGV4aXN0aW5nIHN0YXRlIHNoYXBlCiAgICAgIEFwcC5lZGl0U2hvcnRjdXQgPSBmdW5jdGlvbihpZCl7CiAgICAgICAgY29uc3QgbG9jID0gQXBwLmZpbmRTaG9ydGN1dChpZCk7IGlmKCFsb2MpIHJldHVybjsKICAgICAgICBjb25zdCBzYyA9IGxvYy5idWNrZXQuc2hvcnRjdXRzW2xvYy5pZHhdOwogICAgICAgIGNvbnN0IG5uID0gcHJvbXB0KCdTaG9ydGN1dCBuYW1lOicsIHNjLm5hbWUpOyBpZihubj09PW51bGwpIHJldHVybjsKICAgICAgICBjb25zdCBudSA9IHByb21wdCgnU2hvcnRjdXQgVVJMOicsIHNjLnVybCk7IGlmKG51PT09bnVsbCkgcmV0dXJuOwogICAgICAgIHNjLm5hbWUgPSAobm58fCcnKS50cmltKCkgfHwgc2MubmFtZTsKICAgICAgICBzYy51cmwgID0gKG51fHwnJykudHJpbSgpICB8fCBzYy51cmw7CiAgICAgICAgU3RvcmFnZS5zZXQoJ3Nob3J0Y3V0cycsIEFwcC5zdGF0ZS5zaG9ydGN1dHMpOwogICAgICAgIC8vIFVwZGF0ZSBVSQogICAgICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FyZC0nK2lkKTsKICAgICAgICBpZihjYXJkKXsKICAgICAgICAgIGNvbnN0IHAgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJ3AnKTsgaWYocCkgcC50ZXh0Q29udGVudCA9IHNjLm5hbWU7CiAgICAgICAgICB0cnl7CiAgICAgICAgICAgIGNvbnN0IHUgPSBuZXcgVVJMKHNjLnVybCk7CiAgICAgICAgICAgIGNvbnN0IGZhdiA9IGBodHRwczovL3d3dy5nb29nbGUuY29tL3MyL2Zhdmljb25zP3N6PTY0JmRvbWFpbj0ke3UuaG9zdG5hbWV9YDsKICAgICAgICAgICAgbGV0IGltZyA9IGNhcmQucXVlcnlTZWxlY3RvcignaW1nJyk7IGlmKCFpbWcpeyBpbWc9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7IGNhcmQuaW5zZXJ0QmVmb3JlKGltZywgY2FyZC5maXJzdENoaWxkKTsgfQogICAgICAgICAgICBpbWcuc3JjID0gZmF2OwogICAgICAgICAgfWNhdGNoe30KICAgICAgICB9CiAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvdy0nK2lkKTsKICAgICAgICBpZihyb3cpeyBjb25zdCBzcGFuPXJvdy5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7IGlmKHNwYW4pIHNwYW4udGV4dENvbnRlbnQgPSBzYy5uYW1lOyB9CiAgICAgIH07CgogICAgICBBcHAuY2hhbmdlU2hvcnRjdXRDb2xvciA9IGZ1bmN0aW9uKGlkLCBuYW1lKXsKICAgICAgICBjb25zdCBsb2MgPSBBcHAuZmluZFNob3J0Y3V0KGlkKTsgaWYoIWxvYykgcmV0dXJuOwogICAgICAgIGNvbnN0IHNjID0gbG9jLmJ1Y2tldC5zaG9ydGN1dHNbbG9jLmlkeF07CiAgICAgICAgc2MuY29sb3JOYW1lID0gbmFtZTsKICAgICAgICBTdG9yYWdlLnNldCgnc2hvcnRjdXRzJywgQXBwLnN0YXRlLnNob3J0Y3V0cyk7CiAgICAgICAgY29uc3QgY2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXJkLScraWQpOwogICAgICAgIGlmKGNhcmQpewogICAgICAgICAgY29uc3QgQ09MT1JTID0gd2luZG93LkNPTE9SUyB8fCB7IFRlYWw6JyMxNGI4YTYnLCBMYXZlbmRlcjonI2E3OGJmYScsIEdyYXk6JyM5Y2EzYWYnLCBCbHVlOicjM2I4MmY2JywgV2hpdGU6JyNmZmZmZmYnIH07CiAgICAgICAgICBjb25zdCBoZXggPSAoQ09MT1JTW25hbWVdIHx8ICcjMGYxYzI1Jyk7CiAgICAgICAgICBjYXJkLnN0eWxlLmJhY2tncm91bmQgPSBoZXg7CiAgICAgICAgICBpZigobmFtZXx8JycpLnRvTG93ZXJDYXNlKCk9PT0nd2hpdGUnKXsgY2FyZC5jbGFzc0xpc3QuYWRkKCd3aGl0ZScpOyB9IGVsc2UgeyBjYXJkLmNsYXNzTGlzdC5yZW1vdmUoJ3doaXRlJyk7IH0KICAgICAgICB9CiAgICAgIH07CgogICAgICBBcHAuZGVsZXRlU2hvcnRjdXQgPSBmdW5jdGlvbihpZCl7CiAgICAgICAgY29uc3QgbG9jID0gQXBwLmZpbmRTaG9ydGN1dChpZCk7IGlmKCFsb2MpIHJldHVybjsKICAgICAgICBsb2MuYnVja2V0LnNob3J0Y3V0cy5zcGxpY2UobG9jLmlkeCwxKTsKICAgICAgICBTdG9yYWdlLnNldCgnc2hvcnRjdXRzJywgQXBwLnN0YXRlLnNob3J0Y3V0cyk7CiAgICAgICAgY29uc3QgY2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXJkLScraWQpOyBpZihjYXJkKSBjYXJkLnJlbW92ZSgpOwogICAgICAgIGNvbnN0IHJvdyAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm93LScraWQpOyAgaWYocm93KSAgcm93LnJlbW92ZSgpOwogICAgICB9OwogICAgfSk7CgogICAgLy8gMykgVGFza3Mg4oCUIGFkZCB1cC9kb3duIGFycm93cyB0byBlYWNoIGNhcmQKICAgIHNhZmUoZnVuY3Rpb24gcGF0Y2hUYXNrcygpewogICAgICBpZighd2luZG93LkFwcCkgcmV0dXJuOwogICAgICAvLyBQcm92aWRlIG1vdmVUYXNrCiAgICAgIEFwcC5tb3ZlVGFzayA9IGZ1bmN0aW9uKGlkLCBkaXIpewogICAgICAgIGNvbnN0IGkgPSBBcHAuc3RhdGUudGFza3MuZmluZEluZGV4KHg9PiB4LmlkPT09aWQpOyBpZihpPDApIHJldHVybjsKICAgICAgICBjb25zdCBqID0gaSArIGRpcjsgaWYoajwwIHx8IGo+PUFwcC5zdGF0ZS50YXNrcy5sZW5ndGgpIHJldHVybjsKICAgICAgICBjb25zdCB0bXAgPSBBcHAuc3RhdGUudGFza3NbaV07IEFwcC5zdGF0ZS50YXNrc1tpXSA9IEFwcC5zdGF0ZS50YXNrc1tqXTsgQXBwLnN0YXRlLnRhc2tzW2pdID0gdG1wOwogICAgICAgIFN0b3JhZ2Uuc2V0KCd0YXNrcycsIEFwcC5zdGF0ZS50YXNrcyk7CiAgICAgICAgQXBwLnJlbmRlclRhc2tzKCk7CiAgICAgIH07CgogICAgICAvLyBXcmFwIG9yaWdpbmFsIHJlbmRlclRhc2tzIHRvIGluamVjdCBhcnJvd3MKICAgICAgY29uc3Qgb3JpZyA9IEFwcC5yZW5kZXJUYXNrcy5iaW5kKEFwcCk7CiAgICAgIEFwcC5yZW5kZXJUYXNrcyA9IGZ1bmN0aW9uKCl7CiAgICAgICAgb3JpZygpOwogICAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza3NCb2R5Jyk7IGlmKCFib2R5KSByZXR1cm47CiAgICAgICAgJGFsbCgnLnRhc2stY2FyZCcsIGJvZHkpLmZvckVhY2goY2FyZD0+ewogICAgICAgICAgaWYoY2FyZC5kYXRhc2V0LmVuaGFuY2VkID09PSAnMScpIHJldHVybjsKICAgICAgICAgIGNvbnN0IGFjdGlvbnMgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWFjdGlvbnMnKTsKICAgICAgICAgIGlmKGFjdGlvbnMpewogICAgICAgICAgICBjb25zdCBpZCA9IGNhcmQuaWQgJiYgY2FyZC5pZC5yZXBsYWNlKC9edGFzay0/LywndGFzay0nKSB8fCAoYWN0aW9ucy5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpPy5pZD8ucmVwbGFjZSgvXi4rLS8sJycpIHx8ICcnKTsKICAgICAgICAgICAgLy8gSW5zZXJ0IGFycm93cyBhdCB0aGUgZnJvbnQKICAgICAgICAgICAgY29uc3QgdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsgdXAuY2xhc3NOYW1lPSdjaGlwLWJ0bic7IHVwLnRpdGxlPSdNb3ZlIHVwJzsgdXAudGV4dENvbnRlbnQ9J+Kshic7CiAgICAgICAgICAgIGNvbnN0IGRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7IGRuLmNsYXNzTmFtZT0nY2hpcC1idG4nOyBkbi50aXRsZT0nTW92ZSBkb3duJzsgZG4udGV4dENvbnRlbnQ9J+Kshyc7CiAgICAgICAgICAgIGFjdGlvbnMuaW5zZXJ0QmVmb3JlKGRuLCBhY3Rpb25zLmZpcnN0Q2hpbGQpOwogICAgICAgICAgICBhY3Rpb25zLmluc2VydEJlZm9yZSh1cCwgYWN0aW9ucy5maXJzdENoaWxkKTsKICAgICAgICAgICAgdXAub25jbGljayA9ICgpPT4gQXBwLm1vdmVUYXNrKGNhcmQuaWQsIC0xKTsKICAgICAgICAgICAgZG4ub25jbGljayA9ICgpPT4gQXBwLm1vdmVUYXNrKGNhcmQuaWQsIDEpOwogICAgICAgICAgfQogICAgICAgICAgY2FyZC5kYXRhc2V0LmVuaGFuY2VkID0gJzEnOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgLy8gQWxzbyBzZXQgbmljZXIgZGVmYXVsdCB3aGVuIGFkZGluZyB0YXNrcwogICAgICBjb25zdCBvcmlnaW5hbEFkZFRhc2sgPSBBcHAuYWRkVGFzaz8uYmluZChBcHApOwogICAgICBpZihvcmlnaW5hbEFkZFRhc2spewogICAgICAgIEFwcC5hZGRUYXNrID0gZnVuY3Rpb24oKXsKICAgICAgICAgIGNvbnN0IGJlZm9yZSA9IEFwcC5zdGF0ZS50YXNrcy5sZW5ndGg7CiAgICAgICAgICBvcmlnaW5hbEFkZFRhc2soKTsKICAgICAgICAgIC8vIEVuc3VyZSBuZXdseSBhZGRlZCB0YXNrIGdldHMgYSBtb2Rlcm4gZGVmYXVsdCBjb2xvcgogICAgICAgICAgY29uc3QgbGFzdCA9IEFwcC5zdGF0ZS50YXNrc1tBcHAuc3RhdGUudGFza3MubGVuZ3RoLTFdOwogICAgICAgICAgaWYobGFzdCAmJiAhbGFzdC5jb2xvck5hbWUpIGxhc3QuY29sb3JOYW1lID0gJ0xhdmVuZGVyJzsKICAgICAgICAgIFN0b3JhZ2Uuc2V0KCd0YXNrcycsIEFwcC5zdGF0ZS50YXNrcyk7CiAgICAgICAgICBBcHAucmVuZGVyVGFza3MoKTsKICAgICAgICB9OwogICAgICB9CiAgICAgIC8vIEluaXRpYWwgcmUtcmVuZGVyIHRvIGF0dGFjaCBhcnJvd3MKICAgICAgQXBwLnJlbmRlclRhc2tzKCk7CiAgICB9KTsKICB9KTsKfSkoKTs="},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgZnVuY3Rpb24gJGFsbChzZWwsIHJvb3Q9ZG9jdW1lbnQpeyByZXR1cm4gQXJyYXkuZnJvbShyb290LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsKSk7IH0KICBmdW5jdGlvbiBzYWZlKGZuKXsgdHJ5eyBmbigpOyB9Y2F0Y2goZSl7IGNvbnNvbGUud2FybignW1JhbWlmeSBjLXBhdGNoXScsIGUpOyB9IH0KCiAgLy8gR2xvYmFsIGNsaWNrLWF3YXk6IGNsb3NlIGFueSBkcm9wZG93bi9wb3AgbWVudSB3aGVuIGNsaWNraW5nIG91dHNpZGUgKGV4Y2VwdCB0YXNrIGxpc3QgVUlzKQogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXYpewogICAgJGFsbCgnLmRyb3Bkb3duLCAjY29uZmlnRHJvcCcpLmZvckVhY2goZWw9PnsKICAgICAgaWYoIWVsLmNvbnRhaW5zKGV2LnRhcmdldCkpeyBlbC5zdHlsZS5kaXNwbGF5PSdub25lJzsgfQogICAgfSk7CiAgfSk7CgogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKXsKICAgIC8vIFJlcGxhY2Ugc2VwYXJhdGUgRG93bmxvYWQvVXBsb2FkIHdpdGggYSBzaW5nbGUgY29uZmlnIGJ1dHRvbiArIG1pbmkgbWVudQogICAgc2FmZShmdW5jdGlvbiBjb25maWdTaW5nbGVCdXR0b24oKXsKICAgICAgY29uc3QgZ3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0dGluZ3NHcm91cCcpOwogICAgICBpZighZ3JvdXApIHJldHVybjsKCiAgICAgIC8vIFJlbW92ZSBvbGQgYnV0dG9ucyBpZiBwcmVzZW50CiAgICAgIGNvbnN0IG9sZERsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rvd25sb2FkQnRuJyk7IGlmKG9sZERsKSBvbGREbC5yZW1vdmUoKTsKICAgICAgY29uc3Qgb2xkVWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXBsb2FkQnRuJyk7IGlmKG9sZFVsKSBvbGRVbC5yZW1vdmUoKTsKCiAgICAgIC8vIEFkZCBzaW5nbGUgYnV0dG9uCiAgICAgIGxldCBjZmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29uZmlnQnRuJyk7CiAgICAgIGlmKCFjZmcpewogICAgICAgIGNmZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgIGNmZy5pZD0nY29uZmlnQnRuJzsgY2ZnLmNsYXNzTmFtZT0naWNvbi1idG4nOyBjZmcudGl0bGU9J0V4cG9ydCAvIEltcG9ydCBjb25maWd1cmF0aW9uJzsgY2ZnLnRleHRDb250ZW50PSfwn5OmJzsKICAgICAgICBncm91cC5hcHBlbmRDaGlsZChjZmcpOwogICAgICB9CiAgICAgIC8vIEhpZGRlbiBmaWxlIGlucHV0CiAgICAgIGxldCBmaSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25maWdGaWxlSW5wdXQnKTsKICAgICAgaWYoIWZpKXsKICAgICAgICBmaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgICAgZmkudHlwZT0nZmlsZSc7IGZpLmFjY2VwdD0nLmpzb24sYXBwbGljYXRpb24vanNvbic7IGZpLmlkPSdjb25maWdGaWxlSW5wdXQnOyBmaS5zdHlsZS5kaXNwbGF5PSdub25lJzsKICAgICAgICBncm91cC5hcHBlbmRDaGlsZChmaSk7CiAgICAgIH0KICAgICAgLy8gTWluaSBtZW51CiAgICAgIGxldCBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbmZpZ0Ryb3AnKTsKICAgICAgaWYoIW1lbnUpewogICAgICAgIG1lbnUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBtZW51LmlkPSdjb25maWdEcm9wJzsKICAgICAgICBtZW51LmlubmVySFRNTCA9IGAKICAgICAgICAgIDxidXR0b24gY2xhc3M9ImNoaXAiIGlkPSJjaGlwRG93bmxvYWQiPuKsh++4jyBEb3dubG9hZCBjb25maWd1cmF0aW9uPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJjaGlwIiBpZD0iY2hpcFVwbG9hZCI+4qyG77iPIFVwbG9hZCBjb25maWd1cmF0aW9uPC9idXR0b24+CiAgICAgICAgYDsKICAgICAgICBncm91cC5hcHBlbmRDaGlsZChtZW51KTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZXhwb3J0QWxsTG9jYWxTdG9yYWdlKCl7CiAgICAgICAgY29uc3QgZHVtcCA9IHt9OwogICAgICAgIGZvcihsZXQgaT0wO2k8bG9jYWxTdG9yYWdlLmxlbmd0aDtpKyspewogICAgICAgICAgY29uc3QgayA9IGxvY2FsU3RvcmFnZS5rZXkoaSk7CiAgICAgICAgICBkdW1wW2tdID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oayk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IHBheWxvYWQgPSB7IHZlcnNpb246IDIsIGV4cG9ydGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgc3RvcmFnZTogZHVtcCB9OwogICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbSlNPTi5zdHJpbmdpZnkocGF5bG9hZCxudWxsLDIpXSwge3R5cGU6J2FwcGxpY2F0aW9uL2pzb24nfSk7CiAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOyBhLmhyZWYgPSB1cmw7IGEuZG93bmxvYWQ9J3JhbWlmeV9jb25maWcuanNvbic7IGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7IGEuY2xpY2soKTsKICAgICAgICBzZXRUaW1lb3V0KCgpPT57IGEucmVtb3ZlKCk7IFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsgfSwgMCk7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gaW1wb3J0QWxsTG9jYWxTdG9yYWdlKGZpbGUpewogICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IChldik9PnsKICAgICAgICAgIHRyeXsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoU3RyaW5nKGV2LnRhcmdldC5yZXN1bHR8fCd7fScpKTsKICAgICAgICAgICAgaWYoIWRhdGEgfHwgdHlwZW9mIGRhdGEhPT0nb2JqZWN0JykgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGZpbGUnKTsKICAgICAgICAgICAgY29uc3Qgc3RvcmUgPSBkYXRhLnN0b3JhZ2UgfHwgZGF0YS5zdGF0ZSB8fCB7fTsKICAgICAgICAgICAgY29uc3QgZW50cmllcyA9IHN0b3JlLnN0b3JhZ2UgPyBzdG9yZS5zdG9yYWdlIDogc3RvcmU7CiAgICAgICAgICAgIGxldCB3cm90ZSA9IDA7CiAgICAgICAgICAgIGZvcihjb25zdCBbayx2XSBvZiBPYmplY3QuZW50cmllcyhlbnRyaWVzKSl7CiAgICAgICAgICAgICAgdHJ5eyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrLCB0eXBlb2Ygdj09PSdzdHJpbmcnPyB2IDogSlNPTi5zdHJpbmdpZnkodikpOyB3cm90ZSsrOyB9Y2F0Y2h7fQogICAgICAgICAgICB9CiAgICAgICAgICAgIGFsZXJ0KGBJbXBvcnRlZCAke3dyb3RlfSBrZXlzLiBSZWxvYWRpbmfigKZgKTsKICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7CiAgICAgICAgICB9Y2F0Y2goZXJyKXsKICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpOyBhbGVydCgnSW1wb3J0IGZhaWxlZDogJyArIGVyci5tZXNzYWdlKTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpOwogICAgICB9CgogICAgICBjZmcub25jbGljayA9IGZ1bmN0aW9uKGUpewogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gKG1lbnUuc3R5bGUuZGlzcGxheT09PSdibG9jaycpID8gJ25vbmUnIDogJ2Jsb2NrJzsKICAgICAgfTsKICAgICAgY29uc3QgY2hpcERsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoaXBEb3dubG9hZCcpOwogICAgICBjb25zdCBjaGlwVWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hpcFVwbG9hZCcpOwogICAgICBjaGlwRGwub25jbGljayA9IGZ1bmN0aW9uKGUpeyBlLnN0b3BQcm9wYWdhdGlvbigpOyBleHBvcnRBbGxMb2NhbFN0b3JhZ2UoKTsgbWVudS5zdHlsZS5kaXNwbGF5PSdub25lJzsgfTsKICAgICAgY2hpcFVsLm9uY2xpY2sgPSBmdW5jdGlvbihlKXsgZS5zdG9wUHJvcGFnYXRpb24oKTsgZmkuY2xpY2soKTsgfTsKICAgICAgZmkub25jaGFuZ2UgPSBmdW5jdGlvbihlKXsKICAgICAgICBjb25zdCBmaWxlID0gZS50YXJnZXQuZmlsZXMgJiYgZS50YXJnZXQuZmlsZXNbMF07CiAgICAgICAgaWYoZmlsZSkgaW1wb3J0QWxsTG9jYWxTdG9yYWdlKGZpbGUpOwogICAgICAgIGZpLnZhbHVlPScnOwogICAgICAgIG1lbnUuc3R5bGUuZGlzcGxheT0nbm9uZSc7CiAgICAgIH07CiAgICB9KTsKCiAgICAvLyBFbnN1cmUgc2V0dGluZ3MgZHJvcGRvd24gaXMgc2hpZnRlZCBsZWZ0IChpbiBjYXNlIGVhcmxpZXIgcGF0Y2ggc2V0IHJpZ2h0KQogICAgc2FmZShmdW5jdGlvbiBhbGlnblNldHRpbmdzTGVmdCgpewogICAgICBjb25zdCBkZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5nc0Ryb3AnKTsKICAgICAgaWYoZGQpeyBkZC5zdHlsZS5yaWdodD0nYXV0byc7IGRkLnN0eWxlLmxlZnQ9Jy0zMjBweCc7IH0KICAgIH0pOwoKICAgIC8vIE1ha2Ugc3VyZSB0YXNrIGNhcmRzIGhhdmUgdXAvZG93biBhcnJvd3MgZnJvbSB0aGUgVG8gRG8gbGlzdCByZW5kZXIKICAgIHNhZmUoZnVuY3Rpb24gcmVpbmZvcmNlVGFza0Fycm93cygpewogICAgICBpZighd2luZG93LkFwcCkgcmV0dXJuOwogICAgICAvLyBJZiBhIHByZXZpb3VzIHBhdGNoIGFkZGVkIG1vdmVUYXNrLCBrZWVwIGl0OyBlbHNlIGFkZAogICAgICBpZih0eXBlb2YgQXBwLm1vdmVUYXNrICE9PSAnZnVuY3Rpb24nKXsKICAgICAgICBBcHAubW92ZVRhc2sgPSBmdW5jdGlvbihpZCwgZGlyKXsKICAgICAgICAgIGNvbnN0IGkgPSBBcHAuc3RhdGUudGFza3MuZmluZEluZGV4KHg9PiB4LmlkPT09aWQpOyBpZihpPDApIHJldHVybjsKICAgICAgICAgIGNvbnN0IGogPSBpICsgZGlyOyBpZihqPDAgfHwgaj49QXBwLnN0YXRlLnRhc2tzLmxlbmd0aCkgcmV0dXJuOwogICAgICAgICAgY29uc3QgdG1wID0gQXBwLnN0YXRlLnRhc2tzW2ldOyBBcHAuc3RhdGUudGFza3NbaV0gPSBBcHAuc3RhdGUudGFza3Nbal07IEFwcC5zdGF0ZS50YXNrc1tqXSA9IHRtcDsKICAgICAgICAgIFN0b3JhZ2Uuc2V0KCd0YXNrcycsIEFwcC5zdGF0ZS50YXNrcyk7CiAgICAgICAgICBBcHAucmVuZGVyVGFza3MoKTsKICAgICAgICB9OwogICAgICB9CiAgICAgIGNvbnN0IG9yaWcgPSBBcHAucmVuZGVyVGFza3MuYmluZChBcHApOwogICAgICBBcHAucmVuZGVyVGFza3MgPSBmdW5jdGlvbigpewogICAgICAgIG9yaWcoKTsKICAgICAgICBjb25zdCBib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2tzQm9keScpOyBpZighYm9keSkgcmV0dXJuOwogICAgICAgIEFycmF5LmZyb20oYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay1jYXJkJykpLmZvckVhY2goY2FyZD0+ewogICAgICAgICAgaWYoY2FyZC5kYXRhc2V0LmVuaGFuY2VkID09PSAnMScpIHJldHVybjsKICAgICAgICAgIGNvbnN0IGFjdGlvbnMgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWFjdGlvbnMnKTsKICAgICAgICAgIGlmKGFjdGlvbnMpewogICAgICAgICAgICBjb25zdCB1cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOyB1cC5jbGFzc05hbWU9J2NoaXAtYnRuJzsgdXAudGl0bGU9J01vdmUgdXAnOyB1cC50ZXh0Q29udGVudD0n4qyGJzsKICAgICAgICAgICAgY29uc3QgZG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsgZG4uY2xhc3NOYW1lPSdjaGlwLWJ0bic7IGRuLnRpdGxlPSdNb3ZlIGRvd24nOyBkbi50ZXh0Q29udGVudD0n4qyHJzsKICAgICAgICAgICAgYWN0aW9ucy5pbnNlcnRCZWZvcmUoZG4sIGFjdGlvbnMuZmlyc3RDaGlsZCk7CiAgICAgICAgICAgIGFjdGlvbnMuaW5zZXJ0QmVmb3JlKHVwLCBhY3Rpb25zLmZpcnN0Q2hpbGQpOwogICAgICAgICAgICB1cC5vbmNsaWNrID0gKCk9PiBBcHAubW92ZVRhc2soY2FyZC5pZCwgLTEpOwogICAgICAgICAgICBkbi5vbmNsaWNrID0gKCk9PiBBcHAubW92ZVRhc2soY2FyZC5pZCwgMSk7CiAgICAgICAgICB9CiAgICAgICAgICBjYXJkLmRhdGFzZXQuZW5oYW5jZWQgPSAnMSc7CiAgICAgICAgfSk7CiAgICAgIH07CiAgICAgIC8vIEFwcGx5IG5vdwogICAgICB0cnl7IEFwcC5yZW5kZXJUYXNrcygpOyB9Y2F0Y2h7fQogICAgfSk7CiAgfSk7Cn0pKCk7"},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgLy8gLS0tIE1vZGVybiBwYWxldHRlICYgbWFwcGluZyAtLS0KICBjb25zdCBUSEVNRV9ERUZBVUxUID0gJ3ZhcigtLWNhcmQpJzsKICBjb25zdCBDT0xPUl9HUkFESUVOVFMgPSB7CiAgICAiRGVmYXVsdCI6IG51bGwsIC8vIHJlc29sdmUgdG8gdGhlbWUKICAgICJSZWQiOiAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2VmNDQ0NCwgI2RjMjYyNikiLAogICAgIkdyZWVuIjogImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMyMmM1NWUsICMxNmEzNGEpIiwKICAgICJCbHVlIjogImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMzYjgyZjYsICMyNTYzZWIpIiwKICAgICJZZWxsb3ciOiAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2ZhY2MxNSwgI2VhYjMwOCkiLAogICAgIlBpbmsiOiAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2VjNDg5OSwgI2RiMjc3NykiLAogICAgIkxhdmVuZGVyIjogImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNhNzhiZmEsICM4YjVjZjYpIiwKICAgICJUZWFsIjogImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMxNGI4YTYsICMwZDk0ODgpIiwKICAgICJPcmFuZ2UiOiAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2ZiOTIzYywgI2Y5NzMxNikiLAogICAgLy8gSU1QT1JUQU5UOiBHcmF5IG5vdyBlcXVhbHMgdGhlIG9yaWdpbmFsIHRoZW1lIGJhY2tncm91bmQgKGxpa2UgeW91ciBvbGQgZGVmYXVsdCkKICAgICJHcmF5IjogbnVsbCwKICAgICJXaGl0ZSI6ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZjlmYWZiLCAjZTVlN2ViKSIKICB9OwoKICB3aW5kb3cuQXBwID0gd2luZG93LkFwcCB8fCB7fTsKICBjb25zdCBTdG9yYWdlID0gd2luZG93LlN0b3JhZ2UgfHwgeyBzZXQ6KGssdik9PmxvY2FsU3RvcmFnZS5zZXRJdGVtKGssIEpTT04uc3RyaW5naWZ5KHYpKSwKICAgIGdldDooayxmKT0+eyB0cnl7IGNvbnN0IHY9bG9jYWxTdG9yYWdlLmdldEl0ZW0oayk7IHJldHVybiB2P0pTT04ucGFyc2Uodik6ZjsgfSBjYXRjaChlKXsgcmV0dXJuIGY7IH0gfQogIH07CgogIC8vIE1hcCBjYXJkcyB0byBJRHMgaWYgbm90IGFscmVhZHkgcHJlc2VudCAocHJldmVudHMgImNhbid0IGZpbmQgY2FyZCIgYnVncykKICBmdW5jdGlvbiByZWNvbmNpbGVDYXJkSWRzKCl7CiAgICB0cnkgewogICAgICBjb25zdCBhbGxDYXJkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYXJkW2lkXj0iY2FyZC0iXScpOwogICAgICBpZihhbGxDYXJkcy5sZW5ndGg+MCkgcmV0dXJuOyAvLyBhc3N1bWUgSURzIGFscmVhZHkgc2V0IGJ5IHJlbmRlcmVyCiAgICAgIC8vIEJlc3QtZWZmb3J0OiB0cnkgdG8gYXNzaWduIGJ5IHJlYWRpbmcgZGF0YS1pZCBhdHRyaWJ1dGVzIGlmIHByZXNlbnQKICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNhcmQnKS5mb3JFYWNoKGNhcmQgPT4gewogICAgICAgIGlmKCFjYXJkLmlkKXsKICAgICAgICAgIGNvbnN0IHNpZCA9IGNhcmQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7CiAgICAgICAgICBpZihzaWQpIGNhcmQuaWQgPSAnY2FyZC0nK3NpZDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBjYXRjaChlKXt9CiAgfQoKICAvLyBBcHBseSB2aXN1YWwgc3R5bGUgaW1tZWRpYXRlbHkgd2l0aCBzdHJvbmcgb3ZlcnJpZGUKICBmdW5jdGlvbiBhcHBseVNob3J0Y3V0U3R5bGUoY2FyZCwgY29sb3JOYW1lKXsKICAgIGlmKCFjYXJkKSByZXR1cm47CiAgICBjb25zdCBuYW1lID0gKGNvbG9yTmFtZSB8fCAnRGVmYXVsdCcpOwogICAgY29uc3QgZ3JhZCA9IENPTE9SX0dSQURJRU5UU1tuYW1lXTsKICAgIGlmKGdyYWQpewogICAgICBjYXJkLnN0eWxlLnNldFByb3BlcnR5KCdiYWNrZ3JvdW5kJywgZ3JhZCwgJ2ltcG9ydGFudCcpOwogICAgfSBlbHNlIHsKICAgICAgLy8gRGVmYXVsdCArIEdyYXkgcm91dGUgaGVyZQogICAgICBjYXJkLnN0eWxlLnNldFByb3BlcnR5KCdiYWNrZ3JvdW5kJywgVEhFTUVfREVGQVVMVCwgJ2ltcG9ydGFudCcpOwogICAgfQogICAgLy8gQ29udHJhc3QKICAgIGNvbnN0IGxjID0gbmFtZS50b0xvd2VyQ2FzZSgpOwogICAgY2FyZC5zdHlsZS5jb2xvciA9IChsYyA9PT0gJ3doaXRlJyB8fCBsYyA9PT0gJ3llbGxvdycpID8gJyMwYjEyMjAnIDogJ3doaXRlJzsKICAgIC8vIEdlbnRsZSB0cmFuc2l0aW9uCiAgICBjYXJkLnN0eWxlLnRyYW5zaXRpb24gPSAnYmFja2dyb3VuZCAxNjBtcyBlYXNlLCBjb2xvciAxNjBtcyBlYXNlJzsKICB9CgogIC8vIE92ZXJyaWRlIGNoYW5nZSBoYW5kbGVyIHRvIGJlIHJvYnVzdCBhbmQgaWRlbXBvdGVudAogIEFwcC5jaGFuZ2VTaG9ydGN1dENvbG9yID0gZnVuY3Rpb24oaWQsIG5hbWUpewogICAgdHJ5IHsKICAgICAgY29uc3QgbnVtZXJpYyA9IE51bWJlcihpZCk7CiAgICAgIC8vIFVwZGF0ZSBzdGF0ZQogICAgICBjb25zdCBzdCA9IChBcHAuc3RhdGUgJiYgQXBwLnN0YXRlLnNob3J0Y3V0cykgfHwgU3RvcmFnZS5nZXQoJ3Nob3J0Y3V0cycsIFtdKTsKICAgICAgZm9yKGNvbnN0IGJ1Y2tldCBvZiBzdCl7CiAgICAgICAgY29uc3QgcyA9IChidWNrZXQuc2hvcnRjdXRzfHxbXSkuZmluZCh4PT54LmlkPT09bnVtZXJpYyk7CiAgICAgICAgaWYocyl7IHMuY29sb3JOYW1lID0gbmFtZTsgYnJlYWs7IH0KICAgICAgfQogICAgICBpZihBcHAuc3RhdGUpIEFwcC5zdGF0ZS5zaG9ydGN1dHMgPSBzdDsKICAgICAgU3RvcmFnZS5zZXQoJ3Nob3J0Y3V0cycsIHN0KTsKCiAgICAgIC8vIFVwZGF0ZSBET00gaW1tZWRpYXRlbHkKICAgICAgcmVjb25jaWxlQ2FyZElkcygpOwogICAgICBjb25zdCBjYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhcmQtJytudW1lcmljKTsKICAgICAgYXBwbHlTaG9ydGN1dFN0eWxlKGNhcmQsIG5hbWUpOwogICAgfWNhdGNoKGUpeyBjb25zb2xlLmVycm9yKGUpOyB9CiAgfTsKCiAgLy8gRGVsZWdhdGUgc2VsZWN0IGNoYW5nZXMgKGNvdmVycyBpbmxpbmUgKyBkeW5hbWljIHJvd3MpCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oZSl7CiAgICBpZihlLnRhcmdldCAmJiBlLnRhcmdldC5tYXRjaGVzKCcjc2hvcnRjdXRMaXN0IHNlbGVjdC5zbWFsbC1zZWxlY3QnKSl7CiAgICAgIGNvbnN0IHJvdyA9IGUudGFyZ2V0LmNsb3Nlc3QoJ1tpZF49InJvdy0iXScpOwogICAgICBpZihyb3cpewogICAgICAgIGNvbnN0IGlkID0gcm93LmlkLnJlcGxhY2UoJ3Jvdy0nLCcnKTsKICAgICAgICBBcHAuY2hhbmdlU2hvcnRjdXRDb2xvcihpZCwgZS50YXJnZXQudmFsdWUpOwogICAgICB9CiAgICB9CiAgfSwgdHJ1ZSk7CgogIC8vIEVuc3VyZSAiRGVmYXVsdCIgb3B0aW9uIGV4aXN0cyBhbmQgR3JheSBsYWJlbCBpcyBjbGFyaWZpZWQgKG9wdGlvbmFsKQogIGZ1bmN0aW9uIGVuc3VyZU9wdGlvbnMoKXsKICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNzaG9ydGN1dExpc3Qgc2VsZWN0LnNtYWxsLXNlbGVjdCcpLmZvckVhY2goc2VsPT57CiAgICAgIC8vIEluc2VydCBEZWZhdWx0IGF0IHRvcCBpZiBtaXNzaW5nCiAgICAgIGlmKCFBcnJheS5mcm9tKHNlbC5vcHRpb25zKS5zb21lKG89Pm8udmFsdWU9PT0nRGVmYXVsdCcpKXsKICAgICAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsKICAgICAgICBvcHQudmFsdWUgPSAnRGVmYXVsdCc7CiAgICAgICAgb3B0LnRleHRDb250ZW50ID0gJ0RlZmF1bHQnOwogICAgICAgIHNlbC5pbnNlcnRCZWZvcmUob3B0LCBzZWwuZmlyc3RDaGlsZCk7CiAgICAgIH0KICAgICAgLy8gSWYgR3JheSBleGlzdHMsIGtlZXAgaXQ7IGl0IG5vdyBtYXBzIHRvIFRIRU1FX0RFRkFVTFQgdmlhIGxvZ2ljIGFib3ZlCiAgICB9KTsKICB9CgogIC8vIEFwcGx5IG9uIGxvYWQKICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCl7CiAgICBlbnN1cmVPcHRpb25zKCk7CiAgICBjb25zdCBzdCA9IChBcHAuc3RhdGUgJiYgQXBwLnN0YXRlLnNob3J0Y3V0cykgfHwgU3RvcmFnZS5nZXQoJ3Nob3J0Y3V0cycsIFtdKTsKICAgIGZvcihjb25zdCBidWNrZXQgb2Ygc3QpewogICAgICBmb3IoY29uc3QgcyBvZiAoYnVja2V0LnNob3J0Y3V0c3x8W10pKXsKICAgICAgICBjb25zdCBjYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhcmQtJytzLmlkKTsKICAgICAgICBpZihjYXJkKSBhcHBseVNob3J0Y3V0U3R5bGUoY2FyZCwgcy5jb2xvck5hbWUgfHwgJ0RlZmF1bHQnKTsKICAgICAgfQogICAgfQogIH0pOwoKICAvLyAtLS0gUG9wdXAgcG9zaXRpb25pbmcgZml4IGZvciBoZWFkaW5nIGFjdGlvbiBtZW51cyAtLS0KICAvLyBSZS1pbXBsZW1lbnQgdG9nZ2xlSGVhZGluZ0FjdGlvbnMgdG8gdXNlIEZJWEVEIHBvc2l0aW9uaW5nIG5lYXIgdGhlIGJ1dHRvbgogIGNvbnN0IHNhZmVDbGFtcCA9ICh2LCBtaW4sIG1heCk9PiBNYXRoLm1heChtaW4sIE1hdGgubWluKG1heCwgdikpOwoKICBBcHAudG9nZ2xlSGVhZGluZ0FjdGlvbnMgPSBmdW5jdGlvbihldiwgbmFtZSwgZm9yY2VDbG9zZT1mYWxzZSl7CiAgICB0cnl7CiAgICAgIGNvbnN0IGlkID0gYGhhLSR7bmFtZX1gOwogICAgICBjb25zdCBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOwogICAgICBpZighbWVudSkgcmV0dXJuOwogICAgICAvLyBIaWRlIGFsbCBvdGhlciBtZW51cwogICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWluaS1tZW51JykuZm9yRWFjaChtPT4gbS5zdHlsZS5kaXNwbGF5PSdub25lJyk7CgogICAgICBpZihmb3JjZUNsb3NlKXsgbWVudS5zdHlsZS5kaXNwbGF5PSdub25lJzsgcmV0dXJuOyB9CgogICAgICAvLyBDb21wdXRlIHBvc2l0aW9uIGFuY2hvcmVkIHRvIHRoZSB0cmlnZ2VyaW5nIGJ1dHRvbgogICAgICBjb25zdCBidG4gPSBldiAmJiBldi5jdXJyZW50VGFyZ2V0ID8gZXYuY3VycmVudFRhcmdldCA6IGV2ICYmIGV2LnRhcmdldCA/IGV2LnRhcmdldCA6IG51bGw7CiAgICAgIGxldCByZWN0ID0gYnRuID8gYnRuLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpIDoge2xlZnQ6MTIsIHJpZ2h0OjEyLCBib3R0b206NTYsIHRvcDo0MCwgd2lkdGg6MCwgaGVpZ2h0OjB9OwogICAgICAvLyBTaG93IHRlbXBvcmFyaWx5IHRvIG1lYXN1cmUgd2lkdGgvaGVpZ2h0CiAgICAgIG1lbnUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgIG1lbnUuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnOwogICAgICBtZW51LnN0eWxlLnpJbmRleCA9IDEwMDUwOwogICAgICBjb25zdCBtdyA9IG1lbnUub2Zmc2V0V2lkdGggfHwgMjQwOwogICAgICBjb25zdCBtaCA9IG1lbnUub2Zmc2V0SGVpZ2h0IHx8IDIwMDsKCiAgICAgIC8vIFBsYWNlIGJlbG93IHRoZSBidXR0b24gd2l0aCA4cHggZ2FwOyBmbGlwIGlmIG5lYXIgYm90dG9tCiAgICAgIGxldCB0b3AgPSByZWN0LmJvdHRvbSArIDg7CiAgICAgIGlmICh0b3AgKyBtaCA+IHdpbmRvdy5pbm5lckhlaWdodCAtIDgpIHsKICAgICAgICB0b3AgPSByZWN0LnRvcCAtIG1oIC0gODsKICAgICAgfQogICAgICB0b3AgPSBzYWZlQ2xhbXAodG9wLCA4LCBNYXRoLm1heCg4LCB3aW5kb3cuaW5uZXJIZWlnaHQgLSBtaCAtIDgpKTsKICAgICAgbGV0IGxlZnQgPSBzYWZlQ2xhbXAocmVjdC5sZWZ0LCA4LCBNYXRoLm1heCg4LCB3aW5kb3cuaW5uZXJXaWR0aCAtIG13IC0gOCkpOwoKICAgICAgbWVudS5zdHlsZS50b3AgPSBgJHt0b3B9cHhgOwogICAgICBtZW51LnN0eWxlLmxlZnQgPSBgJHtsZWZ0fXB4YDsKCiAgICAgIC8vIENsaWNrLWF3YXkgJiBzY3JvbGwvcmVzaXplIHRvIGNsb3NlCiAgICAgIGNvbnN0IGNsb3NlID0gKGUpPT57CiAgICAgICAgaWYoIW1lbnUuY29udGFpbnMoZS50YXJnZXQpKSB7IG1lbnUuc3R5bGUuZGlzcGxheT0nbm9uZSc7IGNsZWFudXAoKTsgfQogICAgICB9OwogICAgICBjb25zdCBvbkVzYyA9IChlKT0+eyBpZihlLmtleT09PSdFc2NhcGUnKXsgbWVudS5zdHlsZS5kaXNwbGF5PSdub25lJzsgY2xlYW51cCgpOyB9IH07CiAgICAgIGNvbnN0IG9uUmVzaXplID0gKCk9PnsgbWVudS5zdHlsZS5kaXNwbGF5PSdub25lJzsgY2xlYW51cCgpOyB9OwogICAgICBmdW5jdGlvbiBjbGVhbnVwKCl7CiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIG9uUmVzaXplLCB0cnVlKTsKICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgb25SZXNpemUsIHRydWUpOwogICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGNsb3NlLCB0cnVlKTsKICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgb25Fc2MsIHRydWUpOwogICAgICB9CiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBvblJlc2l6ZSwgdHJ1ZSk7CiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBvblJlc2l6ZSwgdHJ1ZSk7CiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGNsb3NlLCB0cnVlKTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG9uRXNjLCB0cnVlKTsKICAgICAgaWYoZXYgJiYgZXYuc3RvcFByb3BhZ2F0aW9uKSBldi5zdG9wUHJvcGFnYXRpb24oKTsKICAgIH1jYXRjaChlKXsgY29uc29sZS5lcnJvcigndG9nZ2xlSGVhZGluZ0FjdGlvbnMgZml4IGZhaWxlZCcsIGUpOyB9CiAgfTsKfSkoKTs="},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgLy8gMSkgT25seSBjbG9zZSBTaG9ydGN1dHMgdmlhIGl0cyBvd24gYnV0dG9uCiAgd2luZG93LmhpZGVBbGxEcm9wZG93bnMgPSBmdW5jdGlvbigpewogICAgLy8gQ2xvc2UgYWxsIG90aGVyIHRvcCBkcm9wZG93bnMKICAgIFsndGhlbWVEcm9wJywndGltZURyb3AnLCdjYWxlbmRhckRyb3AnLCd3ZWF0aGVyRHJvcCcsJ25hdkRyb3AnLCdpbnRlcm5ldERyb3AnXS5mb3JFYWNoKGlkPT57CiAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOwogICAgICBpZihlbCkgZWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgIH0pOwogICAgLy8gQ2xvc2UgbWluaS1tZW51cyBpbiBoZWFkaW5ncwogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1pbmktbWVudScpLmZvckVhY2gobT0+IG0uc3R5bGUuZGlzcGxheT0nbm9uZScpOwogIH07CgogIC8vIDIpIFJlc3BlY3QgdGhlIHJ1bGUgYWJvdmUgaW5zaWRlIHRoZSB0b2dnbGVyCiAgd2luZG93LnRvZ2dsZURyb3Bkb3duID0gZnVuY3Rpb24oaWQpewogICAgY29uc3QgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CiAgICBpZighZWwpIHJldHVybjsKICAgIGNvbnN0IG9wZW4gPSAoZWwuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJyk7CiAgICBpZihpZCA9PT0gJ3Nob3J0Y3V0c0Ryb3AnKXsKICAgICAgZWwuc3R5bGUuZGlzcGxheSA9IG9wZW4gPyAnbm9uZScgOiAnYmxvY2snOwogICAgfSBlbHNlIHsKICAgICAgaGlkZUFsbERyb3Bkb3ducygpOwogICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gb3BlbiA/ICdub25lJyA6ICdibG9jayc7CiAgICB9CiAgfTsKCiAgLy8gMykgRW5zdXJlIGV2ZXJ5IGNvbG9yIDxzZWxlY3Q+IGhhcyBhICdEZWZhdWx0JyBvcHRpb24gYW5kIHNlbGVjdCBpdCBieSBkZWZhdWx0IGlmIG5vbmUgY2hvc2VuCiAgZnVuY3Rpb24gZW5zdXJlRGVmYXVsdE9wdGlvbigpewogICAgY29uc3QgaG9zdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG9ydGN1dExpc3QnKTsKICAgIGlmKCFob3N0KSByZXR1cm47CiAgICBob3N0LnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlbGVjdC5zbWFsbC1zZWxlY3QnKS5mb3JFYWNoKHNlbD0+ewogICAgICBjb25zdCBoYXNEZWZhdWx0ID0gQXJyYXkuZnJvbShzZWwub3B0aW9ucykuc29tZShvPT5vLnZhbHVlPT09J0RlZmF1bHQnKTsKICAgICAgaWYoIWhhc0RlZmF1bHQpewogICAgICAgIGNvbnN0IG9wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpOwogICAgICAgIG9wdC52YWx1ZSA9ICdEZWZhdWx0JzsKICAgICAgICBvcHQudGV4dENvbnRlbnQgPSAnRGVmYXVsdCc7CiAgICAgICAgc2VsLmluc2VydEJlZm9yZShvcHQsIHNlbC5maXJzdENoaWxkKTsKICAgICAgfQogICAgICAvLyBzZWxlY3QgRGVmYXVsdCBpZiBub3RoaW5nIHNlbGVjdGVkCiAgICAgIGlmKCFBcnJheS5mcm9tKHNlbC5vcHRpb25zKS5zb21lKG89Pm8uc2VsZWN0ZWQpKXsKICAgICAgICBjb25zdCBvcHQgPSBBcnJheS5mcm9tKHNlbC5vcHRpb25zKS5maW5kKG89Pm8udmFsdWU9PT0nRGVmYXVsdCcpOwogICAgICAgIGlmKG9wdCkgb3B0LnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgfQogICAgfSk7CiAgfQogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBlbnN1cmVEZWZhdWx0T3B0aW9uKTsKICBjb25zdCBtbyA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGVuc3VyZURlZmF1bHRPcHRpb24pOwogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKT0+ewogICAgY29uc3QgaG9zdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG9ydGN1dExpc3QnKTsKICAgIGlmKGhvc3QpIG1vLm9ic2VydmUoaG9zdCwgeyBjaGlsZExpc3Q6dHJ1ZSwgc3VidHJlZTp0cnVlIH0pOwogIH0pOwoKICAvLyA0KSBXaGVuIGNoYW5naW5nIHRvICdEZWZhdWx0JywgY2xlYXIgdGhlIGV4cGxpY2l0IGNvbG9yIHNvIGNhcmQgZmFsbHMgYmFjayB0byB0aGVtZQogIGlmKHdpbmRvdy5BcHAgJiYgQXBwLmNoYW5nZVNob3J0Y3V0Q29sb3IpewogICAgY29uc3Qgb3JpZ0NoYW5nZSA9IEFwcC5jaGFuZ2VTaG9ydGN1dENvbG9yLmJpbmQoQXBwKTsKICAgIEFwcC5jaGFuZ2VTaG9ydGN1dENvbG9yID0gZnVuY3Rpb24oaWQsIG5hbWUpewogICAgICBpZihuYW1lID09PSAnRGVmYXVsdCcpeyBuYW1lID0gJyc7IH0KICAgICAgcmV0dXJuIG9yaWdDaGFuZ2UoaWQsIG5hbWUpOwogICAgfTsKICB9CgogIC8vIDUpIEVuZm9yY2UgJ0RlZmF1bHQnIGZvciBuZXcgc2hvcnRjdXRzIGlmIG5vbmUgaXMgc2V0IChhbmQgbm9ybWFsaXplIG9sZCAnR3JheScpCiAgaWYod2luZG93LkFwcCAmJiBBcHAuYWRkU2hvcnRjdXQpewogICAgY29uc3Qgb3JpZ0FkZCA9IEFwcC5hZGRTaG9ydGN1dC5iaW5kKEFwcCk7CiAgICBBcHAuYWRkU2hvcnRjdXQgPSBmdW5jdGlvbigpewogICAgICBjb25zdCByZXN1bHQgPSBvcmlnQWRkKCk7CiAgICAgIHRyeXsKICAgICAgICAvLyBmaW5kIG1vc3QgcmVjZW50bHkgYWRkZWQgaXRlbSBhbmQgbm9ybWFsaXplIGl0cyBjb2xvcgogICAgICAgIGxldCBsYXRlc3QgPSBudWxsOwogICAgICAgIChBcHAuc3RhdGUuc2hvcnRjdXRzfHxbXSkuZm9yRWFjaChidWNrZXQ9PnsKICAgICAgICAgIChidWNrZXQuc2hvcnRjdXRzfHxbXSkuZm9yRWFjaChpdD0+eyBpZighbGF0ZXN0IHx8IChpdC5pZD5sYXRlc3QuaWQpKSBsYXRlc3QgPSBpdDsgfSk7CiAgICAgICAgfSk7CiAgICAgICAgaWYobGF0ZXN0KXsKICAgICAgICAgIGlmKCFsYXRlc3QuY29sb3JOYW1lIHx8IGxhdGVzdC5jb2xvck5hbWU9PT0nR3JheScpeyBsYXRlc3QuY29sb3JOYW1lID0gJ0RlZmF1bHQnOyB9CiAgICAgICAgICAvLyBwZXJzaXN0IGFuZCByZS1yZW5kZXIgdG8gcmVmbGVjdCBkZWZhdWx0CiAgICAgICAgICBpZih3aW5kb3cuU3RvcmFnZSAmJiBTdG9yYWdlLnNldCl7CiAgICAgICAgICAgIFN0b3JhZ2Uuc2V0KCdzaG9ydGN1dHMnLCBBcHAuc3RhdGUuc2hvcnRjdXRzKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmKEFwcC5yZW5kZXJBbGwpIEFwcC5yZW5kZXJBbGwoKTsKICAgICAgICB9CiAgICAgIH1jYXRjaChlKXsgY29uc29sZS53YXJuKCdDb2xvciBub3JtYWxpemUgZXJyb3InLCBlKTsgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKICB9Cn0pKCk7"},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgZnVuY3Rpb24gaXNPcGVuKCl7CiAgICBjb25zdCBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG9ydGN1dHNEcm9wJyk7CiAgICBpZighZWwpIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IHN0ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpOwogICAgcmV0dXJuIChzdCAmJiBzdC5kaXNwbGF5ID09PSAnYmxvY2snKTsKICB9CiAgZnVuY3Rpb24gaXNIYW1idXJnZXIoZWwpewogICAgY29uc3QgaGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGFtYnVyZ2VyJyk7CiAgICByZXR1cm4gISFoYiAmJiAoZWw9PT1oYiB8fCAoZWwgJiYgaGIuY29udGFpbnMoZWwpKSk7CiAgfQogIGZ1bmN0aW9uIGd1YXJkUG9pbnRlcihlKXsKICAgIGlmKCFpc09wZW4oKSkgcmV0dXJuOwogICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvcnRjdXRzRHJvcCcpOwogICAgaWYoIXBvcHVwKSByZXR1cm47CiAgICBjb25zdCB0ID0gZS50YXJnZXQ7CiAgICAvLyBPbmx5IGFsbG93IGNsb3NpbmcgdmlhIGhhbWJ1cmdlcjsgYmxvY2sgb3V0c2lkZSBpbnRlcmFjdGlvbnMgZnJvbSByZWFjaGluZyBjbG9zZXJzCiAgICBpZighcG9wdXAuY29udGFpbnModCkgJiYgIWlzSGFtYnVyZ2VyKHQpKXsKICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgfQogIH0KICAvLyBCbG9jayBnbG9iYWwgY2xvc2VycyB3aGlsZSBTaG9ydGN1dHMgaXMgb3BlbgogIFsnbW91c2Vkb3duJywnbW91c2V1cCcsJ2NsaWNrJ10uZm9yRWFjaCh0eXBlPT57CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGd1YXJkUG9pbnRlciwgdHJ1ZSk7CiAgfSk7CiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKT0+ewogICAgaWYoIWlzT3BlbigpKSByZXR1cm47CiAgICBpZihlLmtleSA9PT0gJ0VzY2FwZScgfHwgZS5rZXkgPT09ICdFc2MnKXsKICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgfQogIH0sIHRydWUpOwp9KSgpOw=="},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgY29uc3QgU3RvcmFnZSA9IHsKICAgIGdldChrLGYpeyB0cnl7Y29uc3Qgdj1sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrKTsgcmV0dXJuIHY/SlNPTi5wYXJzZSh2KTooZj8/bnVsbCk7fWNhdGNoKF8pe3JldHVybiBmPz9udWxsfX0sCiAgICBzZXQoayx2KXsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oaywgSlNPTi5zdHJpbmdpZnkodikpOyB9LAogICAgZGVsKGspeyBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrKTsgfQogIH07CgogIGZ1bmN0aW9uIG9uUmVhZHkoZm4peyBpZihkb2N1bWVudC5yZWFkeVN0YXRlIT09J2xvYWRpbmcnKSBmbigpOyBlbHNlIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmbik7IH0KCiAgLy8gLS0tIFV0aWxpdGllcyAtLS0KICBmdW5jdGlvbiB3YWxrU2hvcnRjdXRzKGNiKXsKICAgIGNvbnN0IGJsb2NrcyA9IFN0b3JhZ2UuZ2V0KCdzaG9ydGN1dHMnLCBbXSkgfHwgW107CiAgICBibG9ja3MuZm9yRWFjaChiID0+IChiLnNob3J0Y3V0c3x8W10pLmZvckVhY2goY2IpKTsKICAgIHJldHVybiBibG9ja3M7CiAgfQoKICBmdW5jdGlvbiBwZXJzaXN0U2hvcnRjdXRzKGJsb2Nrcyl7CiAgICBTdG9yYWdlLnNldCgnc2hvcnRjdXRzJywgYmxvY2tzKTsKICAgIGlmKHdpbmRvdy5BcHAgJiYgQXBwLnJlbmRlckFsbCkgQXBwLnJlbmRlckFsbCgpOwogIH0KCiAgZnVuY3Rpb24gbm9ybWFsaXplU2hvcnRjdXRDb2xvcnMoKXsKICAgIGNvbnN0IGJsb2NrcyA9IFN0b3JhZ2UuZ2V0KCdzaG9ydGN1dHMnLCBbXSkgfHwgW107CiAgICBsZXQgY2hhbmdlZD1mYWxzZTsKICAgIGJsb2Nrcy5mb3JFYWNoKGIgPT4gKGIuc2hvcnRjdXRzfHxbXSkuZm9yRWFjaChzPT57CiAgICAgIGNvbnN0IHZhbCA9IChzLmNvbG9yTmFtZXx8JycpLnRvU3RyaW5nKCk7CiAgICAgIGlmKCF2YWwgfHwgL150ZWFsJC9pLnRlc3QodmFsKSl7CiAgICAgICAgcy5jb2xvck5hbWUgPSAnR3JheSc7CiAgICAgICAgY2hhbmdlZD10cnVlOwogICAgICB9CiAgICB9KSk7CiAgICBpZihjaGFuZ2VkKSBwZXJzaXN0U2hvcnRjdXRzKGJsb2Nrcyk7CiAgfQoKICAvLyBCYWNrZ3JvdW5kIGhlbHBlcnMKICBmdW5jdGlvbiBhcHBseVdhbGxwYXBlckRhdGEoKXsKICAgIGNvbnN0IGRhdGEgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnd2FsbHBhcGVyRGF0YScpOwogICAgY29uc3QgZml0ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3dhbGxwYXBlckZpdCcpIHx8ICdjb3Zlcic7IC8vICdjb3ZlcicgfCAnY29udGFpbicgfCAnZmlsbCcKICAgIGNvbnN0IHBvcyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd3YWxscGFwZXJQb3MnKSB8fCAnY2VudGVyJzsgLy8gJ2NlbnRlcicgfCAndG9wJyB8ICdib3R0b20nCiAgICBjb25zdCBzaGFkZSA9IE51bWJlcihsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnd2FsbHBhcGVyU2hhZGUnKSB8fCAnMzUnKTsgLy8gMC4uODAKCiAgICBpZihkYXRhKXsKICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCcke2RhdGF9JylgOwogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmRSZXBlYXQ9J25vLXJlcGVhdCc7CiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZFNpemUgPSAoZml0PT09J2ZpbGwnID8gJzEwMCUgMTAwJScgOiBmaXQpOwogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9IHBvczsKICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5iYWNrZ3JvdW5kQXR0YWNobWVudD0nZml4ZWQnOwoKICAgICAgbGV0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmdPdmVybGF5U2hhZGUnKTsKICAgICAgaWYoIW92ZXJsYXkpewogICAgICAgIG92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBvdmVybGF5LmlkID0gJ2JnT3ZlcmxheVNoYWRlJzsKICAgICAgICBvdmVybGF5LnN0eWxlLnBvc2l0aW9uPSdmaXhlZCc7CiAgICAgICAgb3ZlcmxheS5zdHlsZS5pbnNldD0nMCc7CiAgICAgICAgb3ZlcmxheS5zdHlsZS5wb2ludGVyRXZlbnRzPSdub25lJzsKICAgICAgICBvdmVybGF5LnN0eWxlLnpJbmRleD0nMCc7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvdmVybGF5KTsKICAgICAgfQogICAgICBvdmVybGF5LnN0eWxlLmJhY2tncm91bmQgPSBgbGluZWFyLWdyYWRpZW50KDE4MGRlZywgcmdiYSgwLDAsMCwke3NoYWRlLzEwMH0pLCByZ2JhKDAsMCwwLCR7c2hhZGUvMTAwfSkpYDsKICAgIH0gZWxzZSB7CiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gJ25vbmUnOwogICAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JnT3ZlcmxheVNoYWRlJyk7CiAgICAgIGlmKG92ZXJsYXkpIG92ZXJsYXkucmVtb3ZlKCk7CiAgICB9CiAgfQoKICBvblJlYWR5KGZ1bmN0aW9uKCl7CiAgICAvLyA9PT09PSAxKSBQcmVjb25maWd1cmVkIGxvb2sgc3RheXMgc2FtZSBhcyB2MSAob25seSBpZiBlbXB0eSkgPT09PT0KICAgIHRyeXsKICAgICAgaWYod2luZG93LkFwcCl7CiAgICAgICAgY29uc3QgaWV4ID0gU3RvcmFnZS5nZXQoJ2lleCcsIHt2aXNpYmxlOnRydWUsIGVuZ2luZTonYnJhdmUnLCBzdHlsZToncGlua2JsdWUnfSk7CiAgICAgICAgaWYoaWV4LnZpc2libGUgIT09IHRydWUpeyBpZXgudmlzaWJsZSA9IHRydWU7IFN0b3JhZ2Uuc2V0KCdpZXgnLCBpZXgpOyB9CiAgICAgICAgQXBwLnN0YXRlID0gQXBwLnN0YXRlIHx8IHt9OwogICAgICAgIEFwcC5zdGF0ZS5pZXggPSBpZXg7CiAgICAgIH0KICAgICAgY29uc3QgaGFzSGVhZGluZ3MgPSAoU3RvcmFnZS5nZXQoJ2hlYWRpbmdzJyxbXSl8fFtdKS5sZW5ndGg+MDsKICAgICAgaWYoIWhhc0hlYWRpbmdzKXsKICAgICAgICBjb25zdCBzZWVkSGVhZGluZyA9IFsnTWFpbiddOwogICAgICAgIGNvbnN0IHNlZWRTaG9ydGN1dHMgPSBbeyBoZWFkaW5nOidNYWluJywgc2hvcnRjdXRzOlt7CiAgICAgICAgICBpZDogRGF0ZS5ub3coKSwKICAgICAgICAgIG5hbWU6ICdHZXR0aW5nIFN0YXJ0ZWQnLAogICAgICAgICAgdXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS8nLAogICAgICAgICAgY29sb3JOYW1lOiAnR3JheScKICAgICAgICB9XX1dOwogICAgICAgIFN0b3JhZ2Uuc2V0KCdoZWFkaW5ncycsIHNlZWRIZWFkaW5nKTsKICAgICAgICBTdG9yYWdlLnNldCgnc2hvcnRjdXRzJywgc2VlZFNob3J0Y3V0cyk7CiAgICAgICAgaWYod2luZG93LkFwcCl7CiAgICAgICAgICBBcHAuc3RhdGUuaGVhZGluZ3MgPSBzZWVkSGVhZGluZzsKICAgICAgICAgIEFwcC5zdGF0ZS5zaG9ydGN1dHMgPSBzZWVkU2hvcnRjdXRzOwogICAgICAgIH0KICAgICAgfQogICAgfWNhdGNoKGUpeyBjb25zb2xlLndhcm4oJ1t2MiBwcmVjb25maWddJywgZSk7IH0KCiAgICAvLyA9PT09PSAyKSBQZXJzaXN0IGRlZmF1bHQgR1JFWSBmb3IgbmV3ICsgZXhpc3Rpbmcgc2hvcnRjdXRzIChzdXJ2aXZlcyByZWZyZXNoKSA9PT09PQogICAgdHJ5ewogICAgICBub3JtYWxpemVTaG9ydGN1dENvbG9ycygpOwogICAgICBpZih3aW5kb3cuQXBwICYmIEFwcC5hZGRTaG9ydGN1dCl7CiAgICAgICAgY29uc3Qgb3JpZyA9IEFwcC5hZGRTaG9ydGN1dC5iaW5kKEFwcCk7CiAgICAgICAgQXBwLmFkZFNob3J0Y3V0ID0gZnVuY3Rpb24oKXsKICAgICAgICAgIGNvbnN0IHJlcyA9IG9yaWcoKTsKICAgICAgICAgIHRyeXsKICAgICAgICAgICAgLy8gRW5zdXJlIG5ld2VzdCArIGFueSBtaXNzaW5nIGFyZSBncmV5CiAgICAgICAgICAgIG5vcm1hbGl6ZVNob3J0Y3V0Q29sb3JzKCk7CiAgICAgICAgICB9Y2F0Y2goZXJyKXsgY29uc29sZS53YXJuKCdbdjIgZGVmYXVsdCBncmV5XScsIGVycik7IH0KICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfTsKICAgICAgfQogICAgfWNhdGNoKGUpeyBjb25zb2xlLndhcm4oJ1t2MiBjb2xvciBwZXJzaXN0XScsIGUpOyB9CgogICAgLy8gPT09PT0gMykgQ2FsZW5kYXIgdG9nZ2xlIChzYW1lIGFzIHYxLCBwcmVzZXJ2ZWQpID09PT09CiAgICB0cnl7CiAgICAgIGNvbnN0IG1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FsZW5kYXJEcm9wJyk7CiAgICAgIGlmKG1lbnUgJiYgIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxUb2dnbGVCdG4nKSl7CiAgICAgICAgbGV0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIHJvdy5jbGFzc05hbWUgPSAncm93JzsKICAgICAgICByb3cuc3R5bGUubWFyZ2luVG9wID0gJzhweCc7CiAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgYnRuLmNsYXNzTmFtZSA9ICdjaGlwLWJ0bic7CiAgICAgICAgYnRuLmlkID0gJ2NhbFRvZ2dsZUJ0bic7CiAgICAgICAgYnRuLnN0eWxlLndpZHRoID0gJzEwMCUnOwogICAgICAgIGJ0bi50ZXh0Q29udGVudCA9IChTdG9yYWdlLmdldCgnY2FsZW5kYXJTZXR0aW5ncycse30pPy52aXNpYmxlID8gJ1R1cm4gQ2FsZW5kYXIgT2ZmJyA6ICdUdXJuIENhbGVuZGFyIE9uJyk7CiAgICAgICAgYnRuLm9uY2xpY2sgPSBmdW5jdGlvbigpewogICAgICAgICAgaWYoIXdpbmRvdy5BcHApIHJldHVybjsKICAgICAgICAgIGNvbnN0IGNzID0gU3RvcmFnZS5nZXQoJ2NhbGVuZGFyU2V0dGluZ3MnLCBBcHAuc3RhdGU/LmNhbCB8fCB7fSk7CiAgICAgICAgICBpZighY3MudXJsKXsKICAgICAgICAgICAgY29uc3Qgd2FybiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxXYXJuJyk7CiAgICAgICAgICAgIGlmKHdhcm4peyB3YXJuLnRleHRDb250ZW50PSdBZGQgYSBDYWxlbmRhciBlbWJlZCBVUkwgZmlyc3QsIHRoZW4gdXNlIE9uL09mZi4nOyB3YXJuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOyB9CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGlmKGNzLnZpc2libGUpeyBBcHAuY2xvc2VDYWxlbmRhcigpOyB9CiAgICAgICAgICBlbHNlIHsgQXBwLm9wZW5DYWxlbmRhcigpOyB9CiAgICAgICAgICBjb25zdCBuZXh0ID0gU3RvcmFnZS5nZXQoJ2NhbGVuZGFyU2V0dGluZ3MnLCBBcHAuc3RhdGU/LmNhbCB8fCB7fSk7CiAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSBuZXh0LnZpc2libGUgPyAnVHVybiBDYWxlbmRhciBPZmYnIDogJ1R1cm4gQ2FsZW5kYXIgT24nOwogICAgICAgIH07CiAgICAgICAgcm93LmFwcGVuZENoaWxkKGJ0bik7CiAgICAgICAgbWVudS5hcHBlbmRDaGlsZChyb3cpOwogICAgICB9CiAgICB9Y2F0Y2goZSl7IGNvbnNvbGUud2FybignW3YyIGNhbGVuZGFyIHRvZ2dsZV0nLCBlKTsgfQoKICAgIC8vID09PT09IDQpIFJlbWluZGVycyBYIGNsaWNrYWJsZSAoc2FtZSBhcyB2MSkgPT09PT0KICAgIHRyeXsKICAgICAgaWYod2luZG93LkFwcCl7CiAgICAgICAgY29uc3Qgb3JpZ1Nob3cgPSBBcHAuc2hvd1RvYXN0Py5iaW5kKEFwcCk7CiAgICAgICAgY29uc3Qgb3JpZ0hpZGUgPSBBcHAuaGlkZVRvYXN0Py5iaW5kKEFwcCk7CiAgICAgICAgY29uc3QgdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW1Ub2FzdCcpOwogICAgICAgIGlmKHQpewogICAgICAgICAgdC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnOwogICAgICAgICAgQXBwLnNob3dUb2FzdCA9IGZ1bmN0aW9uKHRleHQsIGVtb2ppKXsKICAgICAgICAgICAgaWYob3JpZ1Nob3cpIG9yaWdTaG93KHRleHQsIGVtb2ppKTsKICAgICAgICAgICAgdC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2F1dG8nOwogICAgICAgICAgfTsKICAgICAgICAgIEFwcC5oaWRlVG9hc3QgPSBmdW5jdGlvbigpewogICAgICAgICAgICBpZihvcmlnSGlkZSkgb3JpZ0hpZGUoKTsKICAgICAgICAgICAgc2V0VGltZW91dCgoKT0+eyB0LnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7IH0sIDIwMCk7CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfQogICAgfWNhdGNoKGUpeyBjb25zb2xlLndhcm4oJ1t2MiByZW1pbmRlcnMgeF0nLCBlKTsgfQoKICAgIC8vID09PT09IDUpIFRhc2sgYXJyb3dzOiBlbmZvcmNlIGV4YWN0bHkgb25lIHVwICsgb25lIGRvd24sIHJlbW92ZSBkdXBsaWNhdGUgYWN0aW9uIGJhcnMgPT09PT0KICAgIHRyeXsKICAgICAgZnVuY3Rpb24gZml4VGFza0Fycm93cyhzY29wZT1kb2N1bWVudCl7CiAgICAgICAgc2NvcGUucXVlcnlTZWxlY3RvckFsbCgnLnRhc2stY2FyZCcpLmZvckVhY2goY2FyZD0+ewogICAgICAgICAgY29uc3QgYmFycyA9IEFycmF5LmZyb20oY2FyZC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay1hY3Rpb25zJykpOwogICAgICAgICAgLy8gS2VlcCBvbmx5IHRoZSBmaXJzdCBhY3Rpb25zIGJhciBpZiBtdWx0aXBsZXMgZXhpc3QKICAgICAgICAgIGJhcnMuc2xpY2UoMSkuZm9yRWFjaChlbD0+ZWwucmVtb3ZlKCkpOwoKICAgICAgICAgIGNvbnN0IGFjdGlvbnMgPSBiYXJzWzBdIHx8IGNhcmQucXVlcnlTZWxlY3RvcignLnRhc2stYWN0aW9ucycpOwogICAgICAgICAgaWYoIWFjdGlvbnMpIHJldHVybjsKCiAgICAgICAgICAvLyBDb2xsZWN0IGNhbmRpZGF0ZSBidXR0b25zIGJ5IHRleHQgKHN1cHBvcnQg4qyGL+KshyBhbmQg4payL+KWvCkKICAgICAgICAgIGNvbnN0IGJ0bnMgPSBBcnJheS5mcm9tKGFjdGlvbnMucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uLmNoaXAtYnRuLGJ1dHRvbicpKTsKICAgICAgICAgIGNvbnN0IGlzVXAgPSBiID0+IC9eKOKshnzilrJ8CHVwCCkvaS50ZXN0KChiLnRleHRDb250ZW50fHwnJykudHJpbSgpKTsKICAgICAgICAgIGNvbnN0IGlzRG93biA9IGIgPT4gL14o4qyHfOKWvHwIZG93bggpL2kudGVzdCgoYi50ZXh0Q29udGVudHx8JycpLnRyaW0oKSk7CgogICAgICAgICAgbGV0IHVwQnRuPW51bGwsIGRvd25CdG49bnVsbDsKICAgICAgICAgIGJ0bnMuZm9yRWFjaChiPT57CiAgICAgICAgICAgIGlmKGlzVXAoYikpeyBpZighdXBCdG4pIHVwQnRuPWI7IGVsc2UgYi5yZW1vdmUoKTsgfQogICAgICAgICAgICBlbHNlIGlmKGlzRG93bihiKSl7IGlmKCFkb3duQnRuKSBkb3duQnRuPWI7IGVsc2UgYi5yZW1vdmUoKTsgfQogICAgICAgICAgfSk7CgogICAgICAgICAgLy8gSWYgbWlzc2luZywgYWRkIHRoZW0KICAgICAgICAgIGlmKCF1cEJ0bil7CiAgICAgICAgICAgIHVwQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgIHVwQnRuLmNsYXNzTmFtZT0nY2hpcC1idG4nOwogICAgICAgICAgICB1cEJ0bi50ZXh0Q29udGVudD0n4qyGJzsKICAgICAgICAgICAgYWN0aW9ucy5hcHBlbmRDaGlsZCh1cEJ0bik7CiAgICAgICAgICB9CiAgICAgICAgICBpZighZG93bkJ0bil7CiAgICAgICAgICAgIGRvd25CdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgZG93bkJ0bi5jbGFzc05hbWU9J2NoaXAtYnRuJzsKICAgICAgICAgICAgZG93bkJ0bi50ZXh0Q29udGVudD0n4qyHJzsKICAgICAgICAgICAgYWN0aW9ucy5hcHBlbmRDaGlsZChkb3duQnRuKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYod2luZG93LkFwcCl7CiAgICAgICAgY29uc3Qgb3JpZ1JlbmRlclRhc2tzID0gQXBwLnJlbmRlclRhc2tzPy5iaW5kKEFwcCk7CiAgICAgICAgQXBwLnJlbmRlclRhc2tzID0gZnVuY3Rpb24oKXsKICAgICAgICAgIGNvbnN0IHIgPSBvcmlnUmVuZGVyVGFza3MgPyBvcmlnUmVuZGVyVGFza3MoKSA6IHVuZGVmaW5lZDsKICAgICAgICAgIGZpeFRhc2tBcnJvd3MoKTsKICAgICAgICAgIHJldHVybiByOwogICAgICAgIH07CiAgICAgIH0KICAgICAgLy8gcnVuIG9uY2UgYWZ0ZXIgbG9hZAogICAgICBzZXRUaW1lb3V0KCgpPT5maXhUYXNrQXJyb3dzKCksIDApOwogICAgfWNhdGNoKGUpeyBjb25zb2xlLndhcm4oJ1t2MiB0YXNrIGFycm93c10nLCBlKTsgfQoKICAgIC8vID09PT09IDYpIEJhY2tncm91bmQgdXBsb2FkOiBhZGQgRml0L1Bvc2l0aW9uL1NoYWRlIGNvbnRyb2xzIGFuZCBwZXJzaXN0ID09PT09CiAgICB0cnl7CiAgICAgIGNvbnN0IHRoZW1lRHJvcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZURyb3AnKTsKICAgICAgaWYodGhlbWVEcm9wICYmICFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmdGaXRTZWxlY3QnKSl7CiAgICAgICAgY29uc3QgaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7IGgudGV4dENvbnRlbnQgPSAnVXBsb2FkIEJhY2tncm91bmQnOwogICAgICAgIGguc3R5bGUubWFyZ2luVG9wID0gJzEycHgnOwogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyByb3cuY2xhc3NOYW1lID0gJ3Jvdyc7CiAgICAgICAgY29uc3QgaW5wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsgaW5wLnR5cGU9J2ZpbGUnOyBpbnAuYWNjZXB0PSdpbWFnZS8qJzsgaW5wLmlkPSdiZ1VwbG9hZCc7CiAgICAgICAgY29uc3Qgc2V0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7IHNldEJ0bi5jbGFzc05hbWU9J2NoaXAtYnRuJzsgc2V0QnRuLnRleHRDb250ZW50PSdVc2UnOwogICAgICAgIGNvbnN0IGNsckJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOyBjbHJCdG4uY2xhc3NOYW1lPSdjaGlwLWJ0bic7IGNsckJ0bi50ZXh0Q29udGVudD0nQ2xlYXInOwoKICAgICAgICBjb25zdCBmaXRSb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgZml0Um93LmNsYXNzTmFtZT0ncm93JzsgZml0Um93LnN0eWxlLm1hcmdpblRvcD0nOHB4JzsKICAgICAgICBjb25zdCBmaXRTZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKTsgZml0U2VsLmlkPSdiZ0ZpdFNlbGVjdCc7CiAgICAgICAgWydjb3ZlcicsJ2NvbnRhaW4nLCdmaWxsJ10uZm9yRWFjaCh2PT57IGNvbnN0IG89ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7IG8udmFsdWU9djsgby50ZXh0Q29udGVudD0nRml0OiAnK3Y7IGZpdFNlbC5hcHBlbmRDaGlsZChvKTsgfSk7CiAgICAgICAgZml0U2VsLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3dhbGxwYXBlckZpdCcpIHx8ICdjb3Zlcic7CgogICAgICAgIGNvbnN0IHBvc1NlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpOyBwb3NTZWwuaWQ9J2JnUG9zU2VsZWN0JzsgcG9zU2VsLnN0eWxlLm1hcmdpbkxlZnQ9JzhweCc7CiAgICAgICAgW1snY2VudGVyJywnUG9zaXRpb246IGNlbnRlciddLFsndG9wJywnUG9zaXRpb246IHRvcCddLFsnYm90dG9tJywnUG9zaXRpb246IGJvdHRvbSddXS5mb3JFYWNoKChbdix0XSk9PnsgY29uc3Qgbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsgby52YWx1ZT12OyBvLnRleHRDb250ZW50PXQ7IHBvc1NlbC5hcHBlbmRDaGlsZChvKTsgfSk7CiAgICAgICAgcG9zU2VsLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3dhbGxwYXBlclBvcycpIHx8ICdjZW50ZXInOwoKICAgICAgICBjb25zdCBzaGFkZVNlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7IHNoYWRlU2VsLnR5cGU9J3JhbmdlJzsgc2hhZGVTZWwubWluPScwJzsgc2hhZGVTZWwubWF4PSc4MCc7IHNoYWRlU2VsLnN0ZXA9JzUnOwogICAgICAgIHNoYWRlU2VsLmlkPSdiZ1NoYWRlUmFuZ2UnOyBzaGFkZVNlbC5zdHlsZS5tYXJnaW5MZWZ0PSc4cHgnOyBzaGFkZVNlbC50aXRsZT0nRGFya2VuIG92ZXJsYXknOwogICAgICAgIHNoYWRlU2VsLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3dhbGxwYXBlclNoYWRlJykgfHwgJzM1JzsKCiAgICAgICAgcm93LmFwcGVuZENoaWxkKGlucCk7IHJvdy5hcHBlbmRDaGlsZChzZXRCdG4pOyByb3cuYXBwZW5kQ2hpbGQoY2xyQnRuKTsKICAgICAgICBmaXRSb3cuYXBwZW5kQ2hpbGQoZml0U2VsKTsgZml0Um93LmFwcGVuZENoaWxkKHBvc1NlbCk7IGZpdFJvdy5hcHBlbmRDaGlsZChzaGFkZVNlbCk7CiAgICAgICAgdGhlbWVEcm9wLmFwcGVuZENoaWxkKGgpOyB0aGVtZURyb3AuYXBwZW5kQ2hpbGQocm93KTsgdGhlbWVEcm9wLmFwcGVuZENoaWxkKGZpdFJvdyk7CgogICAgICAgIGlmKHdpbmRvdy5BcHApewogICAgICAgICAgY29uc3Qgb3JpZ0FwcGx5VGhlbWUgPSBBcHAuYXBwbHlUaGVtZT8uYmluZChBcHApOwogICAgICAgICAgQXBwLmFwcGx5VGhlbWUgPSBmdW5jdGlvbigpewogICAgICAgICAgICBjb25zdCByID0gb3JpZ0FwcGx5VGhlbWUgPyBvcmlnQXBwbHlUaGVtZSgpIDogdW5kZWZpbmVkOwogICAgICAgICAgICBhcHBseVdhbGxwYXBlckRhdGEoKTsKICAgICAgICAgICAgcmV0dXJuIHI7CiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgc2V0QnRuLm9uY2xpY2sgPSBhc3luYyBmdW5jdGlvbigpewogICAgICAgICAgY29uc3QgZiA9IGlucC5maWxlcyAmJiBpbnAuZmlsZXNbMF07CiAgICAgICAgICBpZighZikgcmV0dXJuOwogICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihlKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd3YWxscGFwZXJEYXRhJywgZS50YXJnZXQucmVzdWx0KTsKICAgICAgICAgICAgICBhcHBseVdhbGxwYXBlckRhdGEoKTsKICAgICAgICAgICAgfWNhdGNoKGVycil7IGNvbnNvbGUud2FybignW3YyIGJnIHNhdmVdJywgZXJyKTsgfQogICAgICAgICAgfTsKICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGYpOwogICAgICAgIH07CiAgICAgICAgY2xyQnRuLm9uY2xpY2sgPSBmdW5jdGlvbigpewogICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3dhbGxwYXBlckRhdGEnKTsKICAgICAgICAgIGFwcGx5V2FsbHBhcGVyRGF0YSgpOwogICAgICAgIH07CiAgICAgICAgZml0U2VsLm9uY2hhbmdlID0gZnVuY3Rpb24oKXsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3dhbGxwYXBlckZpdCcsIGZpdFNlbC52YWx1ZSk7IGFwcGx5V2FsbHBhcGVyRGF0YSgpOyB9OwogICAgICAgIHBvc1NlbC5vbmNoYW5nZSA9IGZ1bmN0aW9uKCl7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd3YWxscGFwZXJQb3MnLCBwb3NTZWwudmFsdWUpOyBhcHBseVdhbGxwYXBlckRhdGEoKTsgfTsKICAgICAgICBzaGFkZVNlbC5vbmlucHV0ID0gZnVuY3Rpb24oKXsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3dhbGxwYXBlclNoYWRlJywgU3RyaW5nKHNoYWRlU2VsLnZhbHVlKSk7IGFwcGx5V2FsbHBhcGVyRGF0YSgpOyB9OwoKICAgICAgICAvLyBBcHBseSBpZiBleGlzdHMKICAgICAgICBhcHBseVdhbGxwYXBlckRhdGEoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBzdGlsbCBhcHBseSBpZiBkYXRhIGV4aXN0cywgZXZlbiBpZiBVSSBub3QgcHJlc2VudAogICAgICAgIGFwcGx5V2FsbHBhcGVyRGF0YSgpOwogICAgICB9CiAgICB9Y2F0Y2goZSl7IGNvbnNvbGUud2FybignW3YyIGJnIGNvbnRyb2xzXScsIGUpOyB9CgogICAgLy8gPT09PT0gNykgTWFrZSBzdXJlIHNlYXJjaCBiYXIgaXMgdmlzaWJsZSBpbW1lZGlhdGVseSBvbiBib290ID09PT09CiAgICB0cnl7CiAgICAgIGlmKHdpbmRvdy5BcHApewogICAgICAgIGlmKEFwcC5zdGF0ZT8uaWV4Py52aXNpYmxlKXsgQXBwLnNob3dJRVg/LigpOyB9CiAgICAgIH0KICAgIH1jYXRjaChlKXsgY29uc29sZS53YXJuKCdbdjIgc2hvdyBpZXhdJywgZSk7IH0KICB9KTsKfSkoKTs="},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgY29uc3QgJCA9IChzLCByPWRvY3VtZW50KT0+ci5xdWVyeVNlbGVjdG9yKHMpOwogIGNvbnN0ICQkID0gKHMsIHI9ZG9jdW1lbnQpPT5BcnJheS5mcm9tKHIucXVlcnlTZWxlY3RvckFsbChzKSk7CgogIGZ1bmN0aW9uIHJlbW92ZU9sZFBhdGNoZXMoKXsKICAgIGNvbnN0IG9sZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYW1pZnktMDgyMC10b3BiYXItYW5kLWRyb3Bkb3duJyk7CiAgICBpZihvbGQpIG9sZC5yZW1vdmUoKTsKICAgIGNvbnN0IG9sZFNjcmlwdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYW1pZnktMDgyMC1zY3JpcHQnKTsKICAgIGlmKG9sZFNjcmlwdCkgb2xkU2NyaXB0LnJlbW92ZSgpOwogIH0KCiAgLy8gU21hbGxlciwgY29uc2lzdGVudCB0b3AgYmFyIOKAkyBvbmx5IG92ZXJyaWRlIGlmIG91ciBwcmV2aW91cyBidW1wIGV4aXN0ZWQKICBmdW5jdGlvbiBub3JtYWxpemVUb3BiYXIoKXsKICAgIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgIHN0eWxlLmlkID0gJ3JhbWlmeS0wODIwLWZpeDItY3NzJzsKICAgIHN0eWxlLnRleHRDb250ZW50ID0gYAogICAgICAvKiBLZWVwIHRoZSBvcmlnaW5hbCBzaXppbmc7IGp1c3QgZW5zdXJlIG5vdGhpbmcgaXMgYXJ0aWZpY2lhbGx5IGVubGFyZ2VkICovCiAgICAgIC5tZW51IHsgcGFkZGluZzogOHB4OyBnYXA6IDhweDsgfQogICAgICAuaWNvbi1idG4sIC5jaGlwLWJ0biB7IGhlaWdodDogMzhweDsgbWluLXdpZHRoOiAzOHB4OyBmb250LXNpemU6IDE0cHg7IH0KICAgICAgLyogRW5zdXJlIGRyb3Bkb3ducyBhcmVuJ3QgcHVzaGVkIHRvbyBsb3cgKi8KICAgICAgI3Nob3J0Y3V0c0Ryb3AsICN0aGVtZURyb3AsICN0aW1lRHJvcCwgI2NhbGVuZGFyRHJvcCwgI3dlYXRoZXJEcm9wLCAjbmF2RHJvcCwgI2ludGVybmV0RHJvcCwgI3NldHRpbmdzRHJvcCwgI2NvbmZpZ0Ryb3AgewogICAgICAgIHRvcDogNjRweCAhaW1wb3J0YW50OwogICAgICB9CiAgICBgOwogICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7CiAgfQoKICAvLyBNb3ZlIFNldHRpbmdzL0NvbmZpZyB0byBGQVIgUklHSFQKICBmdW5jdGlvbiBtb3ZlU2V0dGluZ3NUb1JpZ2h0KCl7CiAgICAvLyBTb21lIGJ1aWxkcyBjcmVhdGUgc2V0dGluZ3MgY29udHJvbHMgdmlhIG1vdW50U2V0dGluZ3MoKQogICAgaWYgKHR5cGVvZiB3aW5kb3cubW91bnRTZXR0aW5ncyA9PT0gJ2Z1bmN0aW9uJyl7CiAgICAgIHRyeSB7IHdpbmRvdy5tb3VudFNldHRpbmdzKCk7IH0gY2F0Y2gge30KICAgIH0KICAgIGNvbnN0IG1lbnUgPSAkKCcjdG9wTWVudScpOwogICAgaWYoIW1lbnUpIHJldHVybjsKICAgIGxldCBncm91cCA9ICQoJyNzZXR0aW5nc0dyb3VwJyk7CiAgICBpZighZ3JvdXApewogICAgICAvLyBJZiBub3QgcHJlc2VudCwgYnVpbGQgYSBtaW5pbWFsIGdyb3VwIGNvbXBhdGlibGUgd2l0aCB0aGUgZXhpc3RpbmcgY29kZQogICAgICBncm91cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgZ3JvdXAuaWQgPSAnc2V0dGluZ3NHcm91cCc7CiAgICAgIGdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWZsZXgnOwogICAgICBncm91cC5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7CiAgICAgIGdyb3VwLnN0eWxlLmdhcCA9ICc4cHgnOwogICAgICAvLyBzZXR0aW5ncyBidXR0b24KICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgIGJ0bi5jbGFzc05hbWUgPSAnaWNvbi1idG4nOyBidG4uaWQ9J29wZW5TZXR0aW5ncyc7IGJ0bi50aXRsZT0nU2V0dGluZ3MnOyBidG4udGV4dENvbnRlbnQ9J+Kame+4jyc7CiAgICAgIGdyb3VwLmFwcGVuZENoaWxkKGJ0bik7CiAgICAgIC8vIGRvd25sb2FkL3VwbG9hZCBidXR0b25zCiAgICAgIGNvbnN0IGRsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgIGRsLmNsYXNzTmFtZT0naWNvbi1idG4nOyBkbC5pZD0nZG93bmxvYWRCdG4nOyBkbC50aXRsZT0nRG93bmxvYWQgY29uZmlndXJhdGlvbic7IGRsLnRleHRDb250ZW50PSfirIfvuI8nOwogICAgICBjb25zdCB1bCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICB1bC5jbGFzc05hbWU9J2ljb24tYnRuJzsgdWwuaWQ9J3VwbG9hZEJ0bic7IHVsLnRpdGxlPSdVcGxvYWQgY29uZmlndXJhdGlvbic7IHVsLnRleHRDb250ZW50PSfirIbvuI8nOwogICAgICBjb25zdCBmaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgIGZpLnR5cGU9J2ZpbGUnOyBmaS5hY2NlcHQ9J2FwcGxpY2F0aW9uL2pzb24nOyBmaS5pZD0nY29uZmlnRmlsZUlucHV0JzsgZmkuc3R5bGUuZGlzcGxheT0nbm9uZSc7CiAgICAgIGdyb3VwLmFwcGVuZChkbCwgdWwsIGZpKTsKICAgICAgLy8gc2V0dGluZ3MgZHJvcGRvd24gc2hlbGwKICAgICAgY29uc3QgZGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgZGQuaWQ9J3NldHRpbmdzRHJvcCc7IGRkLmNsYXNzTmFtZT0nZHJvcGRvd24gc2V0dGluZ3MnOwogICAgICBkZC5pbm5lckhUTUwgPSAnPGgzPlNldHRpbmdzPC9oMz48ZGl2IGNsYXNzPSJyb3cgbXV0ZWQiPkNob29zZSBhIHNlY3Rpb24gYWJvdmUuPC9kaXY+JzsKICAgICAgZ3JvdXAuYXBwZW5kQ2hpbGQoZGQpOwogICAgfQogICAgLy8gQXBwZW5kIHRvIHRoZSBWRVJZIEVORCBzbyBpdCBzaXRzIG9uIHRoZSBmYXIgcmlnaHQKICAgIG1lbnUuYXBwZW5kQ2hpbGQoZ3JvdXApOwoKICAgIC8vIEFsaWduIGRyb3Bkb3ducyB3aGVuIGRvY2tlZCBvbiB0aGUgcmlnaHQgZWRnZQogICAgY29uc3QgY3NzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgIGNzcy50ZXh0Q29udGVudCA9IGAKICAgICAgI3NldHRpbmdzRHJvcC5kcm9wZG93bi5zZXR0aW5nc3sgbGVmdDogYXV0byAhaW1wb3J0YW50OyByaWdodDogMCAhaW1wb3J0YW50OyBtYXgtd2lkdGg6IDQyMHB4OyB9CiAgICAgICNjb25maWdEcm9weyBsZWZ0OiBhdXRvICFpbXBvcnRhbnQ7IHJpZ2h0OiAwICFpbXBvcnRhbnQ7IH0KICAgIGA7CiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGNzcyk7CiAgfQoKICAvLyBDbG9jayBVSTogYWRkIHN0eWxlICsgaWNvbiBjb250cm9scyBCRUZPUkUgT24vT2ZmOyB1c2UgOjpiZWZvcmUgc28gd2UgbmV2ZXIgZmlnaHQgdGhlIGFwcCdzIHRleHQgdXBkYXRlcwogIGZ1bmN0aW9uIGluc3RhbGxDbG9ja1N0eWxlVUkoKXsKICAgIGNvbnN0IGRyb3AgPSAkKCcjdGltZURyb3AnKTsKICAgIGlmKCFkcm9wIHx8ICQoJyNjbG9ja1N0eWxlUm93JykpIHJldHVybjsKICAgIGNvbnN0IGNvbHVtbiA9IGRyb3AucXVlcnlTZWxlY3RvcignLnJvdycpOwogICAgaWYoIWNvbHVtbikgcmV0dXJuOwoKICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgcm93LmlkID0gJ2Nsb2NrU3R5bGVSb3cnOwogICAgcm93LnN0eWxlLmRpc3BsYXk9J2dyaWQnOyByb3cuc3R5bGUuZ2FwPSc2cHgnOyByb3cuc3R5bGUubWFyZ2luQm90dG9tPSc4cHgnOwogICAgcm93LmlubmVySFRNTCA9IGAKICAgICAgPHNlbGVjdCBpZD0iY2xvY2tTdHlsZSIgY2xhc3M9InNtYWxsLXNlbGVjdCIgdGl0bGU9IkNsb2NrIHN0eWxlIj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSJwbGFpbiI+UGxhaW48L29wdGlvbj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSJwaWxsIj5QaWxsPC9vcHRpb24+CiAgICAgICAgPG9wdGlvbiB2YWx1ZT0iZ2xvdyI+R2xvdzwvb3B0aW9uPgogICAgICA8L3NlbGVjdD4KICAgICAgPHNlbGVjdCBpZD0iY2xvY2tJY29uIiBjbGFzcz0ic21hbGwtc2VsZWN0IiB0aXRsZT0iU3ltYm9sIG5leHQgdG8gY2xvY2siPgogICAgICAgIDxvcHRpb24gdmFsdWU9IiI+Tm8gc3ltYm9sPC9vcHRpb24+CiAgICAgICAgPG9wdGlvbiB2YWx1ZT0i4pyd77iPIj7inJ3vuI88L29wdGlvbj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSLwn4+EIj7wn4+EPC9vcHRpb24+CiAgICAgICAgPG9wdGlvbiB2YWx1ZT0i8J+RvSI+8J+RvTwvb3B0aW9uPgogICAgICAgIDxvcHRpb24gdmFsdWU9IuKtkCI+4q2QPC9vcHRpb24+CiAgICAgICAgPG9wdGlvbiB2YWx1ZT0i8J+UpSI+8J+UpTwvb3B0aW9uPgogICAgICA8L3NlbGVjdD4KICAgIGA7CiAgICAvLyBpbnNlcnQgQkVGT1JFIHRoZSBPbi9PZmYgYnV0dG9uICh3aGljaCBpcyBsYXN0IGluIHRoaXMgY29sdW1uKQogICAgY29sdW1uLmluc2VydEJlZm9yZShyb3csIGNvbHVtbi5sYXN0RWxlbWVudENoaWxkKTsKCiAgICBjb25zdCBpY29uU2VsID0gJCgnI2Nsb2NrSWNvbicpOwogICAgY29uc3Qgc3R5bGVTZWwgPSAkKCcjY2xvY2tTdHlsZScpOwogICAgaWNvblNlbC52YWx1ZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjbG9ja0ljb24nKSB8fCAnJzsKICAgIHN0eWxlU2VsLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Nsb2NrU3R5bGUnKSB8fCAncGxhaW4nOwoKICAgIGljb25TZWwub25jaGFuZ2UgPSAoZSk9PnsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Nsb2NrSWNvbicsIGUudGFyZ2V0LnZhbHVlKTsgYXBwbHlDbG9ja1NraW4oKTsgfTsKICAgIHN0eWxlU2VsLm9uY2hhbmdlID0gKGUpPT57IGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjbG9ja1N0eWxlJywgZS50YXJnZXQudmFsdWUpOyBhcHBseUNsb2NrU2tpbigpOyB9OwoKICAgIC8vIENTUyB0aGF0IHJlbmRlcnMgdGhlIGljb24gd2l0aG91dCB0b3VjaGluZyBpbm5lciB0ZXh0CiAgICBjb25zdCBjc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpOwogICAgY3NzLmlkID0gJ2Nsb2NrLXNraW4tY3NzJzsKICAgIGNzcy50ZXh0Q29udGVudCA9IGAKICAgICAgI3RpbWVEaXNwbGF5OjpiZWZvcmUgeyBjb250ZW50OiBhdHRyKGRhdGEtaWNvbikgIiAiOyB9CiAgICAgICN0aW1lRGlzcGxheS5jbG9jay1waWxseyBwYWRkaW5nOjZweCAxMnB4OyBib3JkZXItcmFkaXVzOjk5OXB4OyBiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsLjA4KTsgYm9yZGVyOjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LC4xNCk7IH0KICAgICAgI3RpbWVEaXNwbGF5LmNsb2NrLWdsb3d7IHRleHQtc2hhZG93OiAwIDAgMTRweCByZ2JhKDEyNSwyMTEsMjUyLC42NSk7IH0KICAgIGA7CiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGNzcyk7CgogICAgYXBwbHlDbG9ja1NraW4oKTsKICB9CgogIGZ1bmN0aW9uIGFwcGx5Q2xvY2tTa2luKCl7CiAgICBjb25zdCBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aW1lRGlzcGxheScpOwogICAgaWYoIWVsKSByZXR1cm47CiAgICBjb25zdCBpY29uID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Nsb2NrSWNvbicpIHx8ICcnOwogICAgY29uc3Qgc3R5bGUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2xvY2tTdHlsZScpIHx8ICdwbGFpbic7CiAgICBlbC5kYXRhc2V0Lmljb24gPSBpY29uOwogICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnY2xvY2stcGlsbCcsJ2Nsb2NrLWdsb3cnKTsKICAgIGlmKHN0eWxlID09PSAncGlsbCcpIGVsLmNsYXNzTGlzdC5hZGQoJ2Nsb2NrLXBpbGwnKTsKICAgIGlmKHN0eWxlID09PSAnZ2xvdycpIGVsLmNsYXNzTGlzdC5hZGQoJ2Nsb2NrLWdsb3cnKTsKICB9CgogIC8vIERlZHVwZSB1cC9kb3duIGFycm93cyBhY3Jvc3MgVGFza3MgJiBTaG9ydGN1dHM7IGhhbmRsZSBmdXR1cmUgRE9NIGNoYW5nZXMgdmlhIE11dGF0aW9uT2JzZXJ2ZXIKICBmdW5jdGlvbiBkZWR1cGVBcnJvd3Mocm9vdCl7CiAgICBjb25zdCBzY29wZXMgPSBbXTsKICAgIGNvbnN0IHRhc2tzQm9keSA9ICQoJyN0YXNrc0JvZHknKTsKICAgIGlmKHRhc2tzQm9keSkgc2NvcGVzLnB1c2godGFza3NCb2R5KTsKICAgIGNvbnN0IHNjRHJvcCA9ICQoJyNzaG9ydGN1dHNEcm9wJyk7CiAgICBpZihzY0Ryb3ApIHNjb3Blcy5wdXNoKHNjRHJvcCk7CgogICAgY29uc3QgVVBfUlggPSAvXGJNb3ZlIHVwXGJ84qyGL2k7CiAgICBjb25zdCBET1dOX1JYID0gL1xiTW92ZSBkb3duXGJ84qyHL2k7CgogICAgc2NvcGVzLmZvckVhY2goc2NvcGU9PnsKICAgICAgLy8gYWN0aW9uIGNvbnRhaW5lcnMKICAgICAgY29uc3QgY29udGFpbmVycyA9ICQkKFsnLnRhc2stYWN0aW9ucycsJy5hY3Rpb25zJywnLnJvdyddLmpvaW4oJywnKSwgc2NvcGUpOwogICAgICBjb250YWluZXJzLmZvckVhY2goYz0+ewogICAgICAgIC8vIG9ubHkgY29uc2lkZXIgaWYgY29udGFpbnMgYXQgbGVhc3Qgb25lIHVwL2Rvd24KICAgICAgICBjb25zdCBidG5zID0gJCQoJ2J1dHRvbicsIGMpOwogICAgICAgIGlmKCFidG5zLmxlbmd0aCkgcmV0dXJuOwogICAgICAgIGNvbnN0IHVwcz1bXTsgY29uc3QgZG93bnM9W107CiAgICAgICAgYnRucy5mb3JFYWNoKGI9PnsKICAgICAgICAgIGNvbnN0IHQgPSAoKGIudGl0bGV8fCcnKSArICcgJyArIChiLnRleHRDb250ZW50fHwnJykpLnRyaW0oKTsKICAgICAgICAgIGlmKFVQX1JYLnRlc3QodCkpIHVwcy5wdXNoKGIpOwogICAgICAgICAgaWYoRE9XTl9SWC50ZXN0KHQpKSBkb3ducy5wdXNoKGIpOwogICAgICAgIH0pOwogICAgICAgIGlmKHVwcy5sZW5ndGg+MSl7IHVwcy5zbGljZSgxKS5mb3JFYWNoKGI9PmIucmVtb3ZlKCkpOyB9CiAgICAgICAgaWYoZG93bnMubGVuZ3RoPjEpeyBkb3ducy5zbGljZSgxKS5mb3JFYWNoKGI9PmIucmVtb3ZlKCkpOyB9CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICBsZXQgZGVkdXBlVGltZXI9bnVsbDsKICBmdW5jdGlvbiBzY2hlZHVsZURlZHVwZSgpewogICAgY2xlYXJUaW1lb3V0KGRlZHVwZVRpbWVyKTsKICAgIGRlZHVwZVRpbWVyID0gc2V0VGltZW91dCgoKT0+ZGVkdXBlQXJyb3dzKGRvY3VtZW50LmJvZHkpLCA2MCk7CiAgfQoKICBmdW5jdGlvbiBtb3VudE9ic2VydmVycygpewogICAgY29uc3Qgb2JzID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoc2NoZWR1bGVEZWR1cGUpOwogICAgb2JzLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge2NoaWxkTGlzdDp0cnVlLCBzdWJ0cmVlOnRydWV9KTsKICB9CgogIGZ1bmN0aW9uIGJvb3QoKXsKICAgIHJlbW92ZU9sZFBhdGNoZXMoKTsKICAgIG5vcm1hbGl6ZVRvcGJhcigpOwogICAgbW92ZVNldHRpbmdzVG9SaWdodCgpOwogICAgaW5zdGFsbENsb2NrU3R5bGVVSSgpOwogICAgc2NoZWR1bGVEZWR1cGUoKTsKICAgIG1vdW50T2JzZXJ2ZXJzKCk7CiAgICAvLyBhbHNvIGFwcGx5IHNraW4gb25jZSBwZXIgc2Vjb25kIGp1c3QgaW4gY2FzZSBhcHAgZnVsbHkgcmUtcmVuZGVycyB0aGUgY2xvY2sgZWxlbWVudAogICAgc2V0VGltZW91dCgoKT0+YXBwbHlDbG9ja1NraW4oKSwgNTApOwogIH0KCiAgaWYoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKXsgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGJvb3QpOyB9CiAgZWxzZSB7IGJvb3QoKTsgfQp9KSgpOw=="},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgZnVuY3Rpb24gc2FmZShmbil7IHRyeXsgcmV0dXJuIGZuKCk7IH1jYXRjaChlKXsgY29uc29sZS53YXJuKCdbcmFtaWZ5IHY2XScsIGUpOyB9IH0KCiAgLy8gPT09PSAxKSBSZWFsdGltZSBzaG9ydGN1dCBjb2xvciAocm9idXN0KSA9PT09CiAgZnVuY3Rpb24gc2V0dXBSZWFsdGltZVNob3J0Y3V0Q29sb3IoKXsKICAgIHdpbmRvdy5BcHAgPSB3aW5kb3cuQXBwIHx8IHt9OwogICAgY29uc3QgQ09MT1JfR1JBRElFTlRTID0gewogICAgICAiRGVmYXVsdCI6IG51bGwsCiAgICAgICJSZWQiOiAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2VmNDQ0NCwgI2RjMjYyNikiLAogICAgICAiR3JlZW4iOiAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzIyYzU1ZSwgIzE2YTM0YSkiLAogICAgICAiQmx1ZSI6ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjM2I4MmY2LCAjMjU2M2ViKSIsCiAgICAgICJZZWxsb3ciOiAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2ZhY2MxNSwgI2VhYjMwOCkiLAogICAgICAiUGluayI6ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZWM0ODk5LCAjZGIyNzc3KSIsCiAgICAgICJMYXZlbmRlciI6ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjYTc4YmZhLCAjOGI1Y2Y2KSIsCiAgICAgICJUZWFsIjogImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMxNGI4YTYsICMwZDk0ODgpIiwKICAgICAgIk9yYW5nZSI6ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZmI5MjNjLCAjZjk3MzE2KSIsCiAgICAgICJHcmF5IjogbnVsbCwKICAgICAgIldoaXRlIjogImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmOWZhZmIsICNlNWU3ZWIpIgogICAgfTsKICAgIGZ1bmN0aW9uIGFwcGx5U3R5bGUoY2FyZCwgY29sb3JOYW1lKXsKICAgICAgaWYoIWNhcmQpIHJldHVybjsKICAgICAgY29uc3QgbmFtZSA9IChjb2xvck5hbWUgfHwgJ0RlZmF1bHQnKTsKICAgICAgY29uc3QgZ3JhZCA9IENPTE9SX0dSQURJRU5UU1tuYW1lXTsKICAgICAgaWYoZ3JhZCl7IGNhcmQuc3R5bGUuc2V0UHJvcGVydHkoJ2JhY2tncm91bmQnLCBncmFkLCAnaW1wb3J0YW50Jyk7IH0KICAgICAgZWxzZXsgY2FyZC5zdHlsZS5zZXRQcm9wZXJ0eSgnYmFja2dyb3VuZCcsICd2YXIoLS1jYXJkKScsICdpbXBvcnRhbnQnKTsgfQogICAgICBjb25zdCBsYyA9IChuYW1lfHwnJykudG9Mb3dlckNhc2UoKTsKICAgICAgY2FyZC5zdHlsZS5jb2xvciA9IChsYz09PSd3aGl0ZScgfHwgbGM9PT0neWVsbG93JykgPyAnIzBiMTIyMCcgOiAnI2ZmZmZmZic7CiAgICAgIGNhcmQuc3R5bGUudHJhbnNpdGlvbiA9ICdiYWNrZ3JvdW5kIDE4MG1zIGVhc2UsIGNvbG9yIDE4MG1zIGVhc2UnOwogICAgfQogICAgZnVuY3Rpb24gbWFwQ2FyZElkcygpewogICAgICAvLyBnaXZlIGlkPSJjYXJkLTxpZD4iIHRvIGFueSBzaG9ydGN1dCBjYXJkIHRoYXQgaGFzIGRhdGEtaWQgYXR0cmlidXRlCiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWlkXScpLmZvckVhY2goZWw9PnsKICAgICAgICBjb25zdCBpZCA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpOwogICAgICAgIGlmKGlkICYmICFlbC5pZCkgZWwuaWQgPSAnY2FyZC0nK2lkOwogICAgICB9KTsKICAgIH0KICAgIG1hcENhcmRJZHMoKTsKCiAgICBjb25zdCBwcmV2ID0gQXBwLmNoYW5nZVNob3J0Y3V0Q29sb3IgPyBBcHAuY2hhbmdlU2hvcnRjdXRDb2xvci5iaW5kKEFwcCkgOiBudWxsOwogICAgQXBwLmNoYW5nZVNob3J0Y3V0Q29sb3IgPSBmdW5jdGlvbihpZCwgbmFtZSl7CiAgICAgIHRyeXsKICAgICAgICBpZihwcmV2KSBwcmV2KGlkLCBuYW1lKTsKICAgICAgICAvLyBwZXJzaXN0CiAgICAgICAgaWYoQXBwLnN0YXRlICYmIEFwcC5maW5kU2hvcnRjdXQpewogICAgICAgICAgY29uc3QgbG9jID0gQXBwLmZpbmRTaG9ydGN1dChpZCk7CiAgICAgICAgICBpZihsb2MpeyBsb2MuYnVja2V0LnNob3J0Y3V0c1tsb2MuaWR4XS5jb2xvck5hbWUgPSBuYW1lIHx8ICcnOyB9CiAgICAgICAgfQogICAgICAgIHRyeXsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Nob3J0Y3V0cycsIEpTT04uc3RyaW5naWZ5KEFwcC5zdGF0ZS5zaG9ydGN1dHMpKTsgfWNhdGNoKGUpe30KICAgICAgICAvLyByZWFsdGltZSBzdHlsZQogICAgICAgIG1hcENhcmRJZHMoKTsKICAgICAgICBjb25zdCBjYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhcmQtJytpZCkgfHwgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtaWQ9IiR7aWR9Il1gKTsKICAgICAgICBhcHBseVN0eWxlKGNhcmQsIG5hbWUpOwogICAgICB9Y2F0Y2goZSl7IGNvbnNvbGUud2FybigncmVhbHRpbWUgY29sb3IgZmFpbGVkJywgZSk7IH0KICAgIH07CgogICAgLy8gU3dlZXAgb25jZSBvbiBsb2FkIGFuZCBvbiBET00gY2hhbmdlcwogICAgZnVuY3Rpb24gc3dlZXAoKXsKICAgICAgbWFwQ2FyZElkcygpOwogICAgICBpZighKEFwcC5zdGF0ZSAmJiBBcHAuZmluZFNob3J0Y3V0KSkgcmV0dXJuOwogICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbaWRePSJjYXJkLSJdLCBbZGF0YS1pZF0nKS5mb3JFYWNoKGNhcmQ9PnsKICAgICAgICBjb25zdCBzaWQgPSBOdW1iZXIoY2FyZC5pZD8ucmVwbGFjZSgnY2FyZC0nLCcnKSkgfHwgTnVtYmVyKGNhcmQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJykpOwogICAgICAgIGlmKCFzaWQpIHJldHVybjsKICAgICAgICBjb25zdCBsb2MgPSBBcHAuZmluZFNob3J0Y3V0KHNpZCk7IGlmKCFsb2MpIHJldHVybjsKICAgICAgICBhcHBseVN0eWxlKGNhcmQsIChsb2MuYnVja2V0LnNob3J0Y3V0c1tsb2MuaWR4XXx8e30pLmNvbG9yTmFtZSB8fCAnRGVmYXVsdCcpOwogICAgICB9KTsKICAgIH0KICAgIHN3ZWVwKCk7CiAgICBuZXcgTXV0YXRpb25PYnNlcnZlcigoKT0+c3dlZXAoKSkub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7Y2hpbGRMaXN0OnRydWUsIHN1YnRyZWU6dHJ1ZX0pOwogIH0KCiAgLy8gPT09PSAyKSBTbW9vdGggdGFzayBtb3ZlIChGTElQIGFuaW1hdGlvbikgPT09PQogIGZ1bmN0aW9uIHNldHVwU21vb3RoTW92ZXMoKXsKICAgIGlmKCF3aW5kb3cuQXBwKSByZXR1cm47CiAgICBjb25zdCBsaXN0U2VsID0gJy50YXNrLWxpc3QsICN0YXNrc0xpc3QsIC50YXNrcyc7CiAgICBmdW5jdGlvbiBmbGlwQW5pbWF0ZShjb250YWluZXIpewogICAgICBpZighY29udGFpbmVyKSByZXR1cm47CiAgICAgIGNvbnN0IGNoaWxkcmVuID0gQXJyYXkuZnJvbShjb250YWluZXIuY2hpbGRyZW4pOwogICAgICBjb25zdCBmaXJzdCA9IG5ldyBNYXAoY2hpbGRyZW4ubWFwKGVsPT5bZWwsIGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXSkpOwogICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCk9PnsKICAgICAgICBjb25zdCBsYXN0ID0gbmV3IE1hcChjaGlsZHJlbi5tYXAoZWw9PltlbCwgZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCldKSk7CiAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChlbD0+ewogICAgICAgICAgY29uc3QgYSA9IGZpcnN0LmdldChlbCksIGIgPSBsYXN0LmdldChlbCk7CiAgICAgICAgICBpZighYSB8fCAhYikgcmV0dXJuOwogICAgICAgICAgY29uc3QgZHggPSBhLmxlZnQgLSBiLmxlZnQ7CiAgICAgICAgICBjb25zdCBkeSA9IGEudG9wIC0gYi50b3A7CiAgICAgICAgICBpZihkeCB8fCBkeSl7CiAgICAgICAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHtkeH1weCwgJHtkeX1weClgOwogICAgICAgICAgICBlbC5zdHlsZS50cmFuc2l0aW9uID0gJ3RyYW5zZm9ybSAwcyc7CiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKT0+ewogICAgICAgICAgICAgIGVsLnN0eWxlLnRyYW5zaXRpb24gPSAndHJhbnNmb3JtIDIyMG1zIGVhc2UnOwogICAgICAgICAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9ICcnOwogICAgICAgICAgICAgIHNldFRpbWVvdXQoKCk9PnsgZWwuc3R5bGUudHJhbnNpdGlvbj0nJzsgfSwgMjYwKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgZnVuY3Rpb24gd3JhcChmbil7CiAgICAgIHJldHVybiBmdW5jdGlvbiguLi5hcmdzKXsKICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGxpc3RTZWwpOwogICAgICAgIGlmKGNvbnRhaW5lcikgZmxpcEFuaW1hdGUoY29udGFpbmVyKTsKICAgICAgICBjb25zdCByID0gZm4uYXBwbHkodGhpcywgYXJncyk7CiAgICAgICAgcmV0dXJuIHI7CiAgICAgIH07CiAgICB9CiAgICBpZihBcHAubW92ZVRhc2tVcCkgQXBwLm1vdmVUYXNrVXAgPSB3cmFwKEFwcC5tb3ZlVGFza1VwKTsKICAgIGlmKEFwcC5tb3ZlVGFza0Rvd24pIEFwcC5tb3ZlVGFza0Rvd24gPSB3cmFwKEFwcC5tb3ZlVGFza0Rvd24pOwogICAgLy8gYWxzbyB3cmFwIHJlbmRlclRhc2tzIChkcmFnL2Ryb3AgbWF5IHJlb3JkZXIpCiAgICBpZihBcHAucmVuZGVyVGFza3MpeyAKICAgICAgY29uc3Qgb3JpZyA9IEFwcC5yZW5kZXJUYXNrcy5iaW5kKEFwcCk7CiAgICAgIEFwcC5yZW5kZXJUYXNrcyA9IGZ1bmN0aW9uKCl7IGNvbnN0IHIgPSBvcmlnKCk7IGNvbnN0IGNvbnRhaW5lcj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGxpc3RTZWwpOyBpZihjb250YWluZXIpIGZsaXBBbmltYXRlKGNvbnRhaW5lcik7IHJldHVybiByOyB9OwogICAgfQogIH0KCiAgLy8gPT09PSAzKSBSZXBsYWNlICJPcGVuIGFsbCIgd2l0aCBzYWZlciBhY3Rpb24gPT09PQogIGZ1bmN0aW9uIHBhdGNoT3BlbkFsbCgpewogICAgaWYoIXdpbmRvdy5BcHApIHJldHVybjsKICAgIEFwcC5vcGVuQWxsU2hvcnRjdXRzID0gZnVuY3Rpb24oaGVhZGluZyl7CiAgICAgIGNvbnN0IGJ1Y2tldCA9IEFwcC5zdGF0ZS5zaG9ydGN1dHMuZmluZChoPT5oLmhlYWRpbmc9PT1oZWFkaW5nKTsKICAgICAgaWYoIWJ1Y2tldCB8fCAhYnVja2V0LnNob3J0Y3V0cz8ubGVuZ3RoKSByZXR1cm47CiAgICAgIGNvbnN0IHVybHMgPSBidWNrZXQuc2hvcnRjdXRzLm1hcChzYz0+c2MudXJsKS5maWx0ZXIoQm9vbGVhbik7CiAgICAgIC8vIFRyeSB0byBvcGVuIHRoZSBmaXJzdCBvbmUgKGFsbG93ZWQgYnkgY2xpY2sgZ2VzdHVyZSkKICAgICAgY29uc3QgZmlyc3QgPSB1cmxzWzBdOwogICAgICBpZihmaXJzdCl7CiAgICAgICAgY29uc3QgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7IGEuaHJlZj1maXJzdDsgYS50YXJnZXQ9J19ibGFuayc7IGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7IGEuY2xpY2soKTsgYS5yZW1vdmUoKTsKICAgICAgfQogICAgICAvLyBDb3B5IHRoZSByZXN0IHRvIGNsaXBib2FyZCBhcyBhIGJ1bGxldHByb29mIGZhbGxiYWNrCiAgICAgIGNvbnN0IHJlc3QgPSB1cmxzLnNsaWNlKDEpLmpvaW4oJ1xcbicpOwogICAgICBpZihyZXN0KXsKICAgICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkPy53cml0ZVRleHQocmVzdCkudGhlbigoKT0+ewogICAgICAgICAgQXBwLnNob3dUb2FzdD8uKCdPcGVuZWQgZmlyc3QsIGNvcGllZCB0aGUgcmVzdCB0byBjbGlwYm9hcmQuJyk7CiAgICAgICAgfSkuY2F0Y2goKCk9PnsKICAgICAgICAgIGFsZXJ0KCdPcGVuZWQgdGhlIGZpcnN0IGxpbmsuIFRoZSByZW1haW5pbmcgbGlua3MgYXJlIGNvcGllZCBiZWxvdy5cXG5cXG4nK3Jlc3QpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9OwogIH0KCiAgLy8gPT09PSA0KSBTZXR0aW5ncyBwYW5lbCAobGVnYWwgcGF0aCwgY29udGFjdCwgYWJvdXQpID09PT0KICBmdW5jdGlvbiBzZXR1cFNldHRpbmdzKCl7CiAgICAvLyBlbnN1cmUgYnV0dG9uIGV4aXN0cwogICAgbGV0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuU2V0dGluZ3MnKTsKICAgIGlmKCFidG4pewogICAgICAvLyBhZGQgaW50byB0b3AgbWVudSBvbiB0aGUgcmlnaHQKICAgICAgY29uc3QgdG9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvcE1lbnUnKSB8fCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVudScpOwogICAgICBpZih0b3ApewogICAgICAgIGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgIGJ0bi5pZCA9ICdvcGVuU2V0dGluZ3MnOwogICAgICAgIGJ0bi5jbGFzc05hbWUgPSAnY2hpcC1idG4nOwogICAgICAgIGJ0bi50ZXh0Q29udGVudCA9ICdTZXR0aW5ncyDimpnvuI8nOwogICAgICAgIHRvcC5hcHBlbmRDaGlsZChidG4pOwogICAgICB9CiAgICB9CiAgICAvLyBwYW5lbAogICAgaWYoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5nc1BhbmUnKSl7CiAgICAgIGNvbnN0IHBhbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgcGFuZS5pZCA9ICdzZXR0aW5nc1BhbmUnOwogICAgICBwYW5lLmNsYXNzTmFtZSA9ICdkcm9wZG93bic7CiAgICAgIHBhbmUuc3R5bGUucmlnaHQgPSAnMTJweCc7CiAgICAgIHBhbmUuaW5uZXJIVE1MID0gYAogICAgICAgIDxoMz5TZXR0aW5nczwvaDM+CiAgICAgICAgPGRpdiBjbGFzcz0icm93Ij4KICAgICAgICAgIDxhIGNsYXNzPSJjaGlwLWJ0biIgaWQ9ImRvd25sb2FkTGVnYWwiIGhyZWY9ImZpbGU6Ly8vQzovVXNlcnMvZGVhbnIvRGVza3RvcC9SYW1pZnkvUmFtaWZ5X1Byb3ByaWV0YXJ5X0xlZ2FsX0ZpbGVzIiB0YXJnZXQ9Il9ibGFuayI+8J+TgiBPcGVuIExlZ2FsIEZvbGRlcjwvYT4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPgogICAgICAgICAgPGEgY2xhc3M9ImNoaXAtYnRuIiBpZD0iY29udGFjdENyZWF0b3IiIGhyZWY9Im1haWx0bzpjcmVhdG9yQGV4YW1wbGUuY29tP3N1YmplY3Q9UmFtaWZ5JTIwU3VwcG9ydCI+4pyJ77iPIENvbnRhY3QgQ3JlYXRvcjwvYT4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPgogICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY2hpcC1idG4iIGlkPSJhYm91dEFwcCI+4oS577iPIEFib3V0PC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPHNtYWxsIHN0eWxlPSJkaXNwbGF5OmJsb2NrO2NvbG9yOnZhcigtLW11dGVkKTttYXJnaW4tdG9wOjhweCI+Tm90ZTogT3BlbmluZyBsb2NhbCBmaWxlIHBhdGhzIHdvcmtzIHdoZW4gcnVubmluZyBSYW1pZnkgbG9jYWxseSAoZmlsZTovLykuIEJyb3dzZXJzIG1heSBibG9jayBmcm9tIGh0dHBzOi8vLjwvc21hbGw+CiAgICAgIGA7CiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocGFuZSk7CiAgICB9CiAgICAvLyBvcGVuL2Nsb3NlCiAgICBjb25zdCB0b2dnbGVEcm9wZG93biA9IHdpbmRvdy50b2dnbGVEcm9wZG93biB8fCBmdW5jdGlvbihpZCl7CiAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOyBpZighZWwpIHJldHVybjsKICAgICAgY29uc3QgdmlzID0gZWwuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJzsKICAgICAgZWwuc3R5bGUuZGlzcGxheSA9IHZpcyA/ICdub25lJyA6ICdibG9jayc7CiAgICB9OwogICAgYnRuICYmIChidG4ub25jbGljayA9IChlKT0+eyBlLnN0b3BQcm9wYWdhdGlvbigpOyB0b2dnbGVEcm9wZG93bignc2V0dGluZ3NQYW5lJyk7IH0pOwoKICAgIGNvbnN0IGFib3V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Fib3V0QXBwJyk7CiAgICBpZihhYm91dCl7CiAgICAgIGFib3V0Lm9uY2xpY2sgPSAoKT0+ewogICAgICAgIGFsZXJ0KCdSYW1pZnkg4oCUIFBlcnNvbmFsIGxhdW5jaGVyLlxuQ29weXJpZ2h0IMKpIDIwMjUuIEFsbCByaWdodHMgcmVzZXJ2ZWQuJyk7CiAgICAgIH07CiAgICB9CiAgfQoKICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKXsKICAgIHNhZmUoc2V0dXBSZWFsdGltZVNob3J0Y3V0Q29sb3IpOwogICAgc2FmZShzZXR1cFNtb290aE1vdmVzKTsKICAgIHNhZmUocGF0Y2hPcGVuQWxsKTsKICAgIHNhZmUoc2V0dXBTZXR0aW5ncyk7CiAgfSk7Cn0pKCk7"},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgY29uc3Qgc2FmZSA9IChmbik9PnsgdHJ5eyBmbigpOyB9IGNhdGNoKGUpeyBjb25zb2xlLndhcm4oJ1tSYW1pZnkgRml4IFBhY2tdJywgZSk7IH0gfTsKCiAgZnVuY3Rpb24gZW5zdXJlU2V0dGluZ3MoKXsKICAgIC8vIEVuc3VyZSBhIHNldHRpbmdzIGJ1dHRvbiBleGlzdHMKICAgIGxldCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlblNldHRpbmdzJyk7CiAgICBjb25zdCB0b3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9wTWVudScpIHx8IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZW51Jyk7CiAgICBpZighYnRuICYmIHRvcCl7CiAgICAgIGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICBidG4uaWQgPSAnb3BlblNldHRpbmdzJzsKICAgICAgYnRuLmNsYXNzTmFtZSA9ICdpY29uLWJ0bic7CiAgICAgIGJ0bi50aXRsZSA9ICdTZXR0aW5ncyc7CiAgICAgIGJ0bi50ZXh0Q29udGVudCA9ICfimpnvuI8nOwogICAgICB0b3AuYXBwZW5kQ2hpbGQoYnRuKTsKICAgIH0KCiAgICAvLyBFbnN1cmUgZHJvcGRvd24gd2l0aCB0YWJzIGV4aXN0cwogICAgbGV0IGRkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzRHJvcCcpOwogICAgaWYoIWRkKXsKICAgICAgZGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgZGQuaWQ9J3NldHRpbmdzRHJvcCc7CiAgICAgIGRkLmNsYXNzTmFtZT0nZHJvcGRvd24gc2V0dGluZ3MnOwogICAgICBkZC5zdHlsZS5yaWdodCA9ICcxMnB4JzsKICAgICAgZGQuaW5uZXJIVE1MID0gYAogICAgICAgIDxoMz5TZXR0aW5nczwvaDM+CiAgICAgICAgPGRpdiBjbGFzcz0icm93IiBpZD0ic2V0dGluZ3NUYWJzIj4KICAgICAgICAgIDxidXR0b24gY2xhc3M9ImNoaXAtYnRuIiBpZD0iYWJvdXRCdG4iPuKEue+4jyBBYm91dDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY2hpcC1idG4iIGlkPSJjb250YWN0QnRuIj7inInvuI8gQ29udGFjdCBPd25lcjwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY2hpcC1idG4iIGlkPSJsZWdhbEJ0biI+8J+boe+4jyBDb3B5cmlnaHQgLyBMZWdhbDwvYnV0dG9uPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgc3R5bGU9ImhlaWdodDo2cHgiPjwvZGl2PgogICAgICAgIDxkaXYgaWQ9InNldHRpbmdzUGFuZSIgY2xhc3M9InNlY3Rpb24iPjxiPkNob29zZSBhIHNlY3Rpb24gYWJvdmUuPC9iPjwvZGl2PmA7CiAgICAgICh0b3AgfHwgZG9jdW1lbnQuYm9keSkuYXBwZW5kQ2hpbGQoZGQpOwogICAgfSBlbHNlIHsKICAgICAgLy8gTWFrZSBzdXJlIHRoZSB0YWJzIGV4aXN0OyBpZiBub3QsIGluamVjdCB0aGVtCiAgICAgIGlmKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0dGluZ3NUYWJzJykpewogICAgICAgIGNvbnN0IHRhYnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICB0YWJzLmNsYXNzTmFtZSA9ICdyb3cnOwogICAgICAgIHRhYnMuaWQgPSAnc2V0dGluZ3NUYWJzJzsKICAgICAgICB0YWJzLmlubmVySFRNTCA9IGAKICAgICAgICAgIDxidXR0b24gY2xhc3M9ImNoaXAtYnRuIiBpZD0iYWJvdXRCdG4iPuKEue+4jyBBYm91dDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY2hpcC1idG4iIGlkPSJjb250YWN0QnRuIj7inInvuI8gQ29udGFjdCBPd25lcjwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY2hpcC1idG4iIGlkPSJsZWdhbEJ0biI+8J+boe+4jyBDb3B5cmlnaHQgLyBMZWdhbDwvYnV0dG9uPmA7CiAgICAgICAgZGQuaW5zZXJ0QmVmb3JlKHRhYnMsIGRkLnF1ZXJ5U2VsZWN0b3IoJyNzZXR0aW5nc1BhbmUnKSB8fCBkZC5sYXN0Q2hpbGQpOwogICAgICB9CiAgICAgIC8vIE1ha2Ugc3VyZSBwYW5lIGV4aXN0cwogICAgICBpZighZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzUGFuZScpKXsKICAgICAgICBjb25zdCBwYW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgcGFuZS5pZD0nc2V0dGluZ3NQYW5lJzsKICAgICAgICBwYW5lLmNsYXNzTmFtZT0nc2VjdGlvbic7CiAgICAgICAgcGFuZS5pbm5lckhUTUwgPSAnPGI+Q2hvb3NlIGEgc2VjdGlvbiBhYm92ZS48L2I+JzsKICAgICAgICBkZC5hcHBlbmRDaGlsZChwYW5lKTsKICAgICAgfQogICAgfQoKICAgIC8vIFRvZ2dsZSBiZWhhdmlvcgogICAgaWYoYnRuKXsKICAgICAgY29uc3QgdG9nZ2xlID0gd2luZG93LnRvZ2dsZURyb3Bkb3duIHx8IGZ1bmN0aW9uKGlkKXsKICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsgaWYoIWVsKSByZXR1cm47CiAgICAgICAgY29uc3QgdmlzID0gZWwuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJzsKICAgICAgICAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRyb3Bkb3duJyl8fFtdKS5mb3JFYWNoKGU9PnsgaWYoZSE9PWVsKSBlLnN0eWxlLmRpc3BsYXk9J25vbmUnOyB9KTsKICAgICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gdmlzID8gJ25vbmUnIDogJ2Jsb2NrJzsKICAgICAgfTsKICAgICAgYnRuLm9uY2xpY2sgPSAoZSk9PnsgZS5zdG9wUHJvcGFnYXRpb24oKTsgdG9nZ2xlKCdzZXR0aW5nc0Ryb3AnKTsgfTsKICAgIH0KICAgIGRkPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKT0+IGUuc3RvcFByb3BhZ2F0aW9uKCkpOwogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+eyBpZihkZCkgZGQuc3R5bGUuZGlzcGxheT0nbm9uZSc7IH0pOwoKICAgIC8vIFRhYiBoYW5kbGVycwogICAgY29uc3QgcGFuZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5nc1BhbmUnKTsKICAgIGNvbnN0IGFib3V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Fib3V0QnRuJyk7CiAgICBjb25zdCBjb250YWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhY3RCdG4nKTsKICAgIGNvbnN0IGxlZ2FsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xlZ2FsQnRuJykgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lwQnRuJyk7CgogICAgaWYoYWJvdXQpewogICAgICBhYm91dC5vbmNsaWNrID0gZnVuY3Rpb24oKXsKICAgICAgICBwYW5lLmlubmVySFRNTCA9IGAKICAgICAgICAgIDxkaXYgY2xhc3M9InNlY3Rpb24iPgogICAgICAgICAgICA8aDQ+QWJvdXQgUmFtaWZ5PC9oND4KICAgICAgICAgICAgPHA+PGI+UmFtaWZ5PC9iPiBvcmdhbml6ZXMgaGVhZGluZ3MsIHNob3J0Y3V0cywgYW5kIG5vdGVzIHdpdGggbG9jYWwgcGVyc2lzdGVuY2UuCiAgICAgICAgICAgIERhdGEgaXMgc3RvcmVkIGluIHlvdXIgYnJvd3NlcidzIDxlbT5sb2NhbFN0b3JhZ2U8L2VtPjsgbm90aGluZyBpcyB1cGxvYWRlZC48L3A+CiAgICAgICAgICA8L2Rpdj5gOwogICAgICB9OwogICAgfQogICAgaWYoY29udGFjdCl7CiAgICAgIGNvbnRhY3Qub25jbGljayA9IGZ1bmN0aW9uKCl7CiAgICAgICAgY29uc3QgZW1haWwgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnb3duZXJFbWFpbCcpIHx8ICdvd25lckBleGFtcGxlLmNvbSc7CiAgICAgICAgcGFuZS5pbm5lckhUTUwgPSBgCiAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWN0aW9uIj4KICAgICAgICAgICAgPGg0PkNvbnRhY3QgT3duZXI8L2g0PgogICAgICAgICAgICA8cD5FbWFpbDogPGEgaHJlZj0ibWFpbHRvOiR7ZW1haWx9Ij4ke2VtYWlsfTwvYT48L3A+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6OHB4Ij4KICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJvd25lckVtYWlsSW5wdXQiIHN0eWxlPSJkaXNwbGF5OmJsb2NrO21hcmdpbi1ib3R0b206NHB4Ij5TZXQgY29udGFjdCBlbWFpbDo8L2xhYmVsPgogICAgICAgICAgICAgIDxpbnB1dCBpZD0ib3duZXJFbWFpbElucHV0IiBwbGFjZWhvbGRlcj0ib3duZXJAZXhhbXBsZS5jb20iCiAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDoxMDAlO3BhZGRpbmc6OHB4O2JvcmRlci1yYWRpdXM6MTBweDtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjE1KTtiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsLjA1KTtjb2xvcjp2YXIoLS10ZXh0KSI+CiAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic2F2ZU93bmVyRW1haWwiIGNsYXNzPSJjaGlwLWJ0biIgc3R5bGU9Im1hcmdpbi10b3A6OHB4Ij5TYXZlPC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8c21hbGw+U2F2aW5nIHNldHMgPGNvZGU+b3duZXJFbWFpbDwvY29kZT4gaW4gbG9jYWxTdG9yYWdlIGZvciBmdXR1cmUgdXNlLjwvc21hbGw+CiAgICAgICAgICA8L2Rpdj5gOwogICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ293bmVyRW1haWxJbnB1dCcpOwogICAgICAgIGNvbnN0IHNhdmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZU93bmVyRW1haWwnKTsKICAgICAgICBpZihpbnB1dCl7IGlucHV0LnZhbHVlID0gZW1haWw7IH0KICAgICAgICBpZihzYXZlKXsKICAgICAgICAgIHNhdmUub25jbGljayA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGNvbnN0IHYgPSAoaW5wdXQ/LnZhbHVlIHx8ICcnKS50cmltKCk7CiAgICAgICAgICAgIGlmKHYpeyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnb3duZXJFbWFpbCcsIHYpOyBhbGVydCgnU2F2ZWQgb3duZXJFbWFpbDogJyt2KTsgfQogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgICBpZihsZWdhbCl7CiAgICAgIGxlZ2FsLm9uY2xpY2sgPSBmdW5jdGlvbigpewogICAgICAgIGNvbnN0IHdpbmRvd3NQYXRoID0gIkM6XFxcXFVzZXJzXFxcXGRlYW5yXFxcXERlc2t0b3BcXFxcUmFtaWZ5XFxcXFJhbWlmeV9Qcm9wcmlldGFyeV9MZWdhbF9GaWxlcyI7CiAgICAgICAgY29uc3QgZmlsZVVyaSA9ICJmaWxlOi8vL0M6L1VzZXJzL2RlYW5yL0Rlc2t0b3AvUmFtaWZ5L1JhbWlmeV9Qcm9wcmlldGFyeV9MZWdhbF9GaWxlcyI7CiAgICAgICAgcGFuZS5pbm5lckhUTUwgPSBgCiAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWN0aW9uIj4KICAgICAgICAgICAgPGg0PkNvcHlyaWdodCAvIExlZ2FsPC9oND4KICAgICAgICAgICAgPHA+wqkgJHtuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCl9IFJhbWlmeS4gQWxsIHJpZ2h0cyByZXNlcnZlZC48L3A+CiAgICAgICAgICAgIDxwPlRoaXMgc29mdHdhcmUgaXMgcHJvdmlkZWQgZm9yIHBlcnNvbmFsIHVzZS4gUmVkaXN0cmlidXRpb24sIHJldmVyc2UgZW5naW5lZXJpbmcsIG9yIGNvbW1lcmNpYWwgdXNlIHdpdGhvdXQgd3JpdHRlbiBwZXJtaXNzaW9uIGlzIHByb2hpYml0ZWQuPC9wPgogICAgICAgICAgICA8ZGl2IHN0eWxlPSJtYXJnaW46MTBweCAwIj4KICAgICAgICAgICAgICA8YSBjbGFzcz0iY2hpcC1idG4iIGhyZWY9IiR7ZmlsZVVyaX0iIHRhcmdldD0iX2JsYW5rIiByZWw9Im5vb3BlbmVyIj7wn5OCIE9wZW4gTGVnYWwgRm9sZGVyPC9hPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPHNtYWxsPk5vdGU6IG9wZW5zIDxjb2RlPiR7d2luZG93c1BhdGh9PC9jb2RlPiB3aGVuIHJ1bm5pbmcgbG9jYWxseSB2aWEgPGNvZGU+ZmlsZTovLzwvY29kZT4uIEJyb3dzZXJzIGJsb2NrIGxvY2FsIGZvbGRlcnMgZnJvbSBodHRwKHMpLjwvc21hbGw+CiAgICAgICAgICA8L2Rpdj5gOwogICAgICB9OwogICAgfQogIH0KCiAgZnVuY3Rpb24gaW5zdGFsbFRhc2tGTElQKCl7CiAgICBpZighd2luZG93LkFwcCkgcmV0dXJuOwogICAgaWYoQXBwLl9fZmxpcEluc3RhbGxlZCkgcmV0dXJuOwogICAgQXBwLl9fZmxpcEluc3RhbGxlZCA9IHRydWU7CgogICAgY29uc3Qgb3JpZyA9IEFwcC5yZW5kZXJUYXNrcz8uYmluZChBcHApOwogICAgaWYodHlwZW9mIG9yaWcgIT09ICdmdW5jdGlvbicpIHJldHVybjsKCiAgICBBcHAucmVuZGVyVGFza3MgPSBmdW5jdGlvbigpewogICAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2tzQm9keScpOwogICAgICAvLyBtYXAgZmlyc3QgcG9zaXRpb25zIGJ5IGVsZW1lbnQgaWQKICAgICAgY29uc3QgZmlyc3QgPSBuZXcgTWFwKCk7CiAgICAgIGlmKGxpc3QpewogICAgICAgIEFycmF5LmZyb20obGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay1jYXJkJykpLmZvckVhY2goZWw9PnsKICAgICAgICAgIGZpcnN0LnNldChlbC5pZCB8fCBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKSB8fCAnJywgZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBvcmlnKCk7CgogICAgICBjb25zdCBsaXN0MiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrc0JvZHknKTsKICAgICAgaWYoIWxpc3QyKSByZXR1cm47CiAgICAgIEFycmF5LmZyb20obGlzdDIucXVlcnlTZWxlY3RvckFsbCgnLnRhc2stY2FyZCcpKS5mb3JFYWNoKGVsPT57CiAgICAgICAgY29uc3Qga2V5ID0gZWwuaWQgfHwgZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJykgfHwgJyc7CiAgICAgICAgY29uc3QgZiA9IGZpcnN0LmdldChrZXkpOwogICAgICAgIGlmKCFmKSByZXR1cm47CiAgICAgICAgY29uc3QgbCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIGNvbnN0IGR4ID0gZi5sZWZ0IC0gbC5sZWZ0OwogICAgICAgIGNvbnN0IGR5ID0gZi50b3AgIC0gbC50b3A7CiAgICAgICAgaWYoZHggfHwgZHkpewogICAgICAgICAgZWwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke2R4fXB4LCAke2R5fXB4KWA7CiAgICAgICAgICBlbC5zdHlsZS50cmFuc2l0aW9uID0gJ3RyYW5zZm9ybSAwcyc7CiAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCk9PnsKICAgICAgICAgICAgZWwuc3R5bGUudHJhbnNpdGlvbiA9ICd0cmFuc2Zvcm0gMjIwbXMgZWFzZSc7CiAgICAgICAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUoMCwwKSc7CiAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCAoKT0+ewogICAgICAgICAgICAgIGVsLnN0eWxlLnRyYW5zaXRpb249Jyc7IGVsLnN0eWxlLnRyYW5zZm9ybT0nJzsKICAgICAgICAgICAgfSwge29uY2U6dHJ1ZX0pOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CiAgfQoKICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKXsKICAgIHNhZmUoZW5zdXJlU2V0dGluZ3MpOwogICAgc2FmZShpbnN0YWxsVGFza0ZMSVApOwogIH0pOwp9KSgpOw=="},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgLy8gUGFuZSBoZWxwZXJzIChnbG9iYWwgc28gaW5saW5lIG9uY2xpY2sgd29ya3MpCiAgd2luZG93Ll9yYW1pZnlHZXRQYW5lID0gZnVuY3Rpb24oKXsgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5nc1BhbmUnKTsgfTsKCiAgd2luZG93Ll9yYW1pZnlTaG93QWJvdXQgPSBmdW5jdGlvbigpewogICAgdmFyIHA9X3JhbWlmeUdldFBhbmUoKTsgaWYoIXApIHJldHVybjsKICAgIHAuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9InNlY3Rpb24iPjxoND5BYm91dCBSYW1pZnl5PC9oND48cD48Yj5SYW1pZnl5PC9iPiBpcyBhIGxvY2FsLWZpcnN0IHN0YXJ0IHBhZ2UgdGhhdCBvcmdhbml6ZXMgc2hvcnRjdXRzIHVuZGVyIGNvbGxhcHNpYmxlIGhlYWRpbmdzLiBObyBzaWduLWluLCBubyBiYWNrZW5kOyBldmVyeXRoaW5nIHN0YXlzIGluIHlvdXIgYnJvd3NlcuKAmXMgPGVtPmxvY2FsU3RvcmFnZTwvZW0+LjwvcD48dWwgc3R5bGU9Im1hcmdpbjo2cHggMCAwIDE4cHg7bGluZS1oZWlnaHQ6MS41Ij48bGk+Q29sbGFwc2libGUgaGVhZGluZ3Mgd2l0aCBzdGF0ZSBwZXJzaXN0ZW5jZTwvbGk+PGxpPkNvbG9yIHRhZ3MgYW5kIHF1aWNrIGVkaXQvZGVsZXRlIGZvciBzaG9ydGN1dHM8L2xpPjxsaT5Ob3RlcyAmIHJlbWluZGVycywgY29uZmlnIGltcG9ydC9leHBvcnQgZm9yIGJhY2t1cDwvbGk+PC91bD48L2Rpdj4nOwogIH07CgogIHdpbmRvdy5fcmFtaWZ5U2hvd0NvbnRhY3QgPSBmdW5jdGlvbigpewogICAgdmFyIHA9X3JhbWlmeUdldFBhbmUoKTsgaWYoIXApIHJldHVybjsKICAgIHZhciBlbWFpbCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdvd25lckVtYWlsJykgfHwgJyc7CiAgICBwLmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPSJzZWN0aW9uIj48aDQ+Q29udGFjdCBPd25lcjwvaDQ+JyArIAogICAgICAoZW1haWwgPyAnPHA+PGI+RW1haWw6PC9iPiA8YSBocmVmPVwibWFpbHRvOicrZW1haWwrJ1wiPicrZW1haWwrJzwvYT48L3A+JyA6ICc8cD48Yj5ObyBlbWFpbCBzZXQuPC9iPiBFbnRlciBvbmUgYmVsb3cuPC9wPicpICsKICAgICAgJzxkaXYgc3R5bGU9XCJtYXJnaW4tdG9wOjhweFwiPjxsYWJlbCBmb3I9XCJvd25lckVtYWlsSW5wdXRcIiBzdHlsZT1cImRpc3BsYXk6YmxvY2s7bWFyZ2luLWJvdHRvbTo0cHhcIj5Pd25lciBlbWFpbDo8L2xhYmVsPicrCiAgICAgICc8aW5wdXQgaWQ9XCJvd25lckVtYWlsSW5wdXRcIiBwbGFjZWhvbGRlcj1cIm5hbWVAZXhhbXBsZS5jb21cIiBzdHlsZT1cIndpZHRoOjEwMCU7cGFkZGluZzo4cHg7Ym9yZGVyLXJhZGl1czoxMHB4O2JvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTUpO2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwuMDUpO2NvbG9yOnZhcigtLXRleHQpXCI+JysKICAgICAgJzxidXR0b24gaWQ9XCJzYXZlT3duZXJFbWFpbFwiIGNsYXNzPVwiY2hpcC1idG5cIiBzdHlsZT1cIm1hcmdpbi10b3A6OHB4XCI+U2F2ZTwvYnV0dG9uPjwvZGl2PicrCiAgICAgICc8c21hbGw+U3RvcmVkIGFzIDxjb2RlPm93bmVyRW1haWw8L2NvZGU+IGluIGxvY2FsU3RvcmFnZS48L3NtYWxsPjwvZGl2Pic7CiAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3duZXJFbWFpbElucHV0Jyk7CiAgICB2YXIgc2F2ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlT3duZXJFbWFpbCcpOwogICAgaWYoaW5wdXQpIGlucHV0LnZhbHVlID0gZW1haWw7CiAgICBpZihzYXZlKXsKICAgICAgc2F2ZS5vbmNsaWNrID0gZnVuY3Rpb24oKXsKICAgICAgICB2YXIgdj0oaW5wdXQgJiYgaW5wdXQudmFsdWUgfHwgJycpLnRyaW0oKTsKICAgICAgICBpZih2KXsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ293bmVyRW1haWwnLCB2KTsgX3JhbWlmeVNob3dDb250YWN0KCk7IH0gZWxzZSB7IGFsZXJ0KCdQbGVhc2UgZW50ZXIgYW4gZW1haWwgYWRkcmVzcy4nKTsgfQogICAgICB9OwogICAgfQogIH07CgogIHdpbmRvdy5fcmFtaWZ5RG93bmxvYWRMZWdhbCA9IGZ1bmN0aW9uKCl7CiAgICB2YXIgcmVsYXRpdmVaaXAgPSAnLi9SYW1pZnlfUHJvcHJpZXRhcnlfTGVnYWxfRmlsZXMuemlwJzsKICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgYS5ocmVmID0gcmVsYXRpdmVaaXA7CiAgICBhLmRvd25sb2FkID0gJ1JhbWlmeV9Qcm9wcmlldGFyeV9MZWdhbF9GaWxlcy56aXAnOwogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsgYS5jbGljaygpOyBhLnJlbW92ZSgpOwogIH07CgogIHdpbmRvdy5fcmFtaWZ5U2hvd0xlZ2FsID0gZnVuY3Rpb24oKXsKICAgIHZhciBwPV9yYW1pZnlHZXRQYW5lKCk7IGlmKCFwKSByZXR1cm47CiAgICBwLmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPVwic2VjdGlvblwiPjxoND5Db3B5cmlnaHQgLyBMZWdhbDwvaDQ+PHA+Q2xpY2sgdG8gZG93bmxvYWQgdGhlIGxlZ2FsIGRvY3VtZW50cyBidW5kbGUuPC9wPjxkaXYgc3R5bGU9XCJtYXJnaW46MTBweCAwXCI+PGJ1dHRvbiBjbGFzcz1cImNoaXAtYnRuXCIgb25jbGljaz1cIl9yYW1pZnlEb3dubG9hZExlZ2FsKClcIj7irIfvuI8gRG93bmxvYWQgTGVnYWwgRG9jdW1lbnRzIChaSVApPC9idXR0b24+PC9kaXY+PHNtYWxsPlBsYWNlIDxjb2RlPlJhbWlmeV9Qcm9wcmlldGFyeV9MZWdhbF9GaWxlcy56aXA8L2NvZGU+IG5leHQgdG8gdGhpcyBIVE1MIGZvciB0aGUgbW9zdCByZWxpYWJsZSBkb3dubG9hZC48L3NtYWxsPjwvZGl2Pic7CiAgfTsKCiAgdmFyIGJhY2tkcm9wID0gbnVsbCwgbW9kYWwgPSBudWxsLCBmYWxsYmFja0J0biA9IG51bGw7CiAgZnVuY3Rpb24gZW5zdXJlUmVmcygpewogICAgYmFja2Ryb3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmFtaWZ5U2V0dGluZ3NCYWNrZHJvcCcpOwogICAgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmFtaWZ5U2V0dGluZ3NNb2RhbCcpOwogICAgZmFsbGJhY2tCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmFtaWZ5U2V0dGluZ3NGYWxsYmFjaycpOwogIH0KICB3aW5kb3cuX3JhbWlmeU9wZW5TZXR0aW5ncyA9IGZ1bmN0aW9uKCl7CiAgICBlbnN1cmVSZWZzKCk7CiAgICBpZihiYWNrZHJvcCkgYmFja2Ryb3Auc3R5bGUuZGlzcGxheT0nYmxvY2snOwogICAgaWYobW9kYWwpIG1vZGFsLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsKICB9OwogIHdpbmRvdy5fcmFtaWZ5Q2xvc2VTZXR0aW5ncyA9IGZ1bmN0aW9uKCl7CiAgICBlbnN1cmVSZWZzKCk7CiAgICBpZihiYWNrZHJvcCkgYmFja2Ryb3Auc3R5bGUuZGlzcGxheT0nbm9uZSc7CiAgICBpZihtb2RhbCkgbW9kYWwuc3R5bGUuZGlzcGxheT0nbm9uZSc7CiAgfTsKCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCl7CiAgICBlbnN1cmVSZWZzKCk7CiAgICB2YXIgeCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYW1pZnlTZXR0aW5nc0Nsb3NlJyk7CiAgICBpZih4KSB4Lm9uY2xpY2sgPSBfcmFtaWZ5Q2xvc2VTZXR0aW5nczsKICAgIGlmKGJhY2tkcm9wKSBiYWNrZHJvcC5vbmNsaWNrID0gX3JhbWlmeUNsb3NlU2V0dGluZ3M7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24oZSl7IGlmKGUua2V5PT09J0VzY2FwZScpIF9yYW1pZnlDbG9zZVNldHRpbmdzKCk7IH0pOwoKICAgIC8vIFRyeSB0byBmaW5kIGFuIGV4aXN0aW5nIHNldHRpbmdzIHRyaWdnZXIgYW5kIHdpcmUgaXQgdG8gb3BlbiB0aGUgbW9kYWwKICAgIHZhciB0cmlnZ2VycyA9IFtdOwogICAgdmFyIGJ5SWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlblNldHRpbmdzJyk7IGlmKGJ5SWQpIHRyaWdnZXJzLnB1c2goYnlJZCk7CiAgICB2YXIgYnlUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1t0aXRsZT1cIlNldHRpbmdzXCJdJyk7IGlmKGJ5VGl0bGUpIHRyaWdnZXJzLnB1c2goYnlUaXRsZSk7CiAgICB2YXIgYnlUZXh0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24sIC5pY29uLWJ0biwgLmNoaXAtYnRuJykpLmZpbmQoYj0+L3NldHRpbmdzL2kudGVzdChiLnRleHRDb250ZW50fHwnJykpOwogICAgaWYoYnlUZXh0KSB0cmlnZ2Vycy5wdXNoKGJ5VGV4dCk7CgogICAgaWYodHJpZ2dlcnMubGVuZ3RoPT09MCl7CiAgICAgIC8vIFNob3cgZmFsbGJhY2sgYnV0dG9uIGlmIG5vIHRyaWdnZXIgZm91bmQKICAgICAgaWYoZmFsbGJhY2tCdG4pIGZhbGxiYWNrQnRuLnN0eWxlLmRpc3BsYXk9J2lubGluZS1mbGV4JzsKICAgIH1lbHNlewogICAgICB0cmlnZ2Vycy5mb3JFYWNoKGZ1bmN0aW9uKHQpewogICAgICAgIGlmKCF0Ll9yYW1pZnlXaXJlZCl7CiAgICAgICAgICB0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXYpeyBldi5wcmV2ZW50RGVmYXVsdCgpOyBldi5zdG9wUHJvcGFnYXRpb24oKTsgX3JhbWlmeU9wZW5TZXR0aW5ncygpOyB9KTsKICAgICAgICAgIHQuX3JhbWlmeVdpcmVkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0pOwp9KSgpOw=="},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgY29uc3QgU1RPUkVfS0VZID0gInJhbWlmeV9oZWFkaW5nX2Jhcl9iZyI7CiAgLy8gMSkgQXBwbHkgc2F2ZWQgYmFyIGNvbG9yIG9uIHN0YXJ0dXAKICBjb25zdCBzYXZlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFNUT1JFX0tFWSk7CiAgaWYoc2F2ZWQhPT1udWxsKXsKICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgiLS1oZWFkaW5nLWJhci1iZyIsIHNhdmVkIHx8ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMzOTQwNGEsIzFiMjQzMCkiKTsKICB9CgogIC8vIDIpIFdpcmUgU2V0dGluZ3MgaW50ZWdyYXRpb24gaWYgYXZhaWxhYmxlLCBlbHNlIHNob3cgZmxvYXRpbmcgYnV0dG9uIGFzIGZhbGxiYWNrCiAgZnVuY3Rpb24gb3BlblBhbGV0dGUoKXsgCiAgICBjb25zdCBwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJhclBhbGV0dGUiKTsKICAgIHAuc3R5bGUuZGlzcGxheSA9IChwLnN0eWxlLmRpc3BsYXk9PT0iYmxvY2siID8gIm5vbmUiIDogImJsb2NrIik7CiAgfQogIGZ1bmN0aW9uIGNsb3NlUGFsZXR0ZSgpeyBjb25zdCBwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJhclBhbGV0dGUiKTsgcC5zdHlsZS5kaXNwbGF5PSJub25lIjsgfQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJiYXJBcHBseSIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24oKXsKICAgIGNvbnN0IHZhbCA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYmFyQ3VzdG9tIikudmFsdWV8fCIiKS50cmltKCk7CiAgICBpZih2YWwubGVuZ3RoKXsKICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCItLWhlYWRpbmctYmFyLWJnIiwgdmFsKTsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oU1RPUkVfS0VZLCB2YWwpOwogICAgICBjbG9zZVBhbGV0dGUoKTsKICAgIH0KICB9KTsKICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCIjYmFyUGFsZXR0ZSAuc3dhdGNoIikuZm9yRWFjaChmdW5jdGlvbihlbCl7CiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKCl7CiAgICAgIGNvbnN0IHZhbCA9IGVsLmdldEF0dHJpYnV0ZSgiZGF0YS12YWwiKTsKICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCItLWhlYWRpbmctYmFyLWJnIiwgdmFsIHx8ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMzOTQwNGEsIzFiMjQzMCkiKTsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oU1RPUkVfS0VZLCB2YWx8fCIiKTsKICAgICAgY2xvc2VQYWxldHRlKCk7CiAgICB9KTsKICB9KTsKCiAgLy8gVHJ5IHRvIG1vdW50IGEgYnV0dG9uIGluc2lkZSBhbiBleGlzdGluZyBTZXR0aW5ncyBVSQogIGZ1bmN0aW9uIG1vdW50SW50b1NldHRpbmdzKCl7CiAgICBjb25zdCBzZXR0aW5nc0JvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjc2V0dGluZ3NDb250ZW50LCAjc2V0dGluZ3NCb2R5LCAuc2V0dGluZ3MtYm9keSwgI3NldHRpbmdzIC5jb250ZW50LCAjc2V0dGluZ3MiKTsKICAgIGlmKHNldHRpbmdzQm9keSAmJiAhZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJhckNvbG9yU2V0dGluZ3NSb3ciKSl7CiAgICAgIGNvbnN0IGJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGJsb2NrLmlkID0gImJhckNvbG9yU2V0dGluZ3NSb3ciOwogICAgICBibG9jay5zdHlsZS5tYXJnaW5Ub3AgPSAiMTRweCI7CiAgICAgIGJsb2NrLmlubmVySFRNTCA9ICc8aDMgc3R5bGU9Im1hcmdpbjowIDAgNnB4Ij5TaG9ydGN1dCBCYXIgY29sb3I8L2gzPjxkaXY+PGJ1dHRvbiBpZD0ib3BlbkJhclBhbGV0dGUiIGNsYXNzPSJjaGlwLWJ0biIgc3R5bGU9InBhZGRpbmc6OHB4IDEwcHg7Ym9yZGVyLXJhZGl1czoxMHB4O2JvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTIpO2JhY2tncm91bmQ6IzFhMjIzMDtjb2xvcjojZWFmMmZmO2N1cnNvcjpwb2ludGVyIj5DaG9vc2UgY29sb3I8L2J1dHRvbj48L2Rpdj4nOwogICAgICBzZXR0aW5nc0JvZHkuYXBwZW5kQ2hpbGQoYmxvY2spOwogICAgICBjb25zdCBidG4gPSBibG9jay5xdWVyeVNlbGVjdG9yKCIjb3BlbkJhclBhbGV0dGUiKTsKICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgb3BlblBhbGV0dGUpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIHJldHVybiBmYWxzZTsKICB9CgogIGxldCBtb3VudGVkID0gbW91bnRJbnRvU2V0dGluZ3MoKTsKICBpZighbW91bnRlZCl7CiAgICAvLyBzaG93IGZhbGxiYWNrIGZsb2F0aW5nIGJ1dHRvbgogICAgY29uc3QgZmFiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJhckNvbG9yRmFiIik7CiAgICBmYWIuc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUtZmxleCI7CiAgICBmYWIuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBvcGVuUGFsZXR0ZSk7CiAgfQoKICAvLyBEaXNtaXNzIHBhbGV0dGUgb24gb3V0c2lkZSBjbGljawogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24oZXYpewogICAgY29uc3QgcGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJhclBhbGV0dGUiKTsKICAgIGNvbnN0IGZhYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJiYXJDb2xvckZhYiIpOwogICAgaWYocGFsLnN0eWxlLmRpc3BsYXk9PT0iYmxvY2siICYmICFwYWwuY29udGFpbnMoZXYudGFyZ2V0KSAmJiBldi50YXJnZXQhPT1mYWIgJiYgIWZhYi5jb250YWlucyhldi50YXJnZXQpKXsKICAgICAgY2xvc2VQYWxldHRlKCk7CiAgICB9CiAgfSk7CgogIC8vIDMpIEZpeDogZW5zdXJlIG5ldyBjYXJkcyBkbyBOT1QgZmxhc2ggdGVhbCDigJQgZm9yY2UgZGVmYXVsdCBsb29rIGltbWVkaWF0ZWx5CiAgY29uc3QgYXBwbHlEZWZhdWx0Q2FyZExvb2sgPSAoY2FyZCk9PnsKICAgIGlmKCFjYXJkKSByZXR1cm47CiAgICAvLyBPbmx5IGFkanVzdCBiYWNrZ3JvdW5kIG9uY2UgKGF2b2lkIGZpZ2h0aW5nIHVzZXItcGlja2VkIGNvbG9ycykKICAgIGlmKCFjYXJkLmRhdGFzZXQuZGVmYXVsdGVkKXsKICAgICAgY2FyZC5zdHlsZS5iYWNrZ3JvdW5kID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLmdldFByb3BlcnR5VmFsdWUoIi0tY2FyZCIpLnRyaW0oKSB8fCAiIzEzMWEyMiI7CiAgICAgIGNhcmQuc3R5bGUuY29sb3IgPSBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuZ2V0UHJvcGVydHlWYWx1ZSgiLS10ZXh0IikudHJpbSgpIHx8ICIjZWFmMmZmIjsKICAgICAgY2FyZC5kYXRhc2V0LmRlZmF1bHRlZCA9ICIxIjsKICAgIH0KICB9OwoKICAvLyBQYXRjaCBBcHAuY3JlYXRlQ2FyZCBpZiBwcmVzZW50CiAgZnVuY3Rpb24gcGF0Y2hDcmVhdGUoKXsKICAgIHRyeXsKICAgICAgaWYod2luZG93LkFwcCAmJiB0eXBlb2YgQXBwLmNyZWF0ZUNhcmQgPT09ICJmdW5jdGlvbiIgJiYgIUFwcC5fX3BhdGNoZWRDcmVhdGUpewogICAgICAgIGNvbnN0IG9yaWcgPSBBcHAuY3JlYXRlQ2FyZC5iaW5kKEFwcCk7CiAgICAgICAgQXBwLmNyZWF0ZUNhcmQgPSBmdW5jdGlvbihjb250YWluZXIsIGhlYWRpbmdOYW1lLCBpdGVtKXsKICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG9yaWcoY29udGFpbmVyLCBoZWFkaW5nTmFtZSwgaXRlbSk7CiAgICAgICAgICAvLyBUcnkgdG8gbG9jYXRlIGJ5IGlkIGlmIGF2YWlsYWJsZSwgZWxzZSBsYXN0IC5jYXJkIGluIGNvbnRhaW5lcgogICAgICAgICAgbGV0IGVsID0gbnVsbDsKICAgICAgICAgIGlmKGl0ZW0gJiYgaXRlbS5pZCAhPSBudWxsKXsKICAgICAgICAgICAgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2FyZC0iK2l0ZW0uaWQpOwogICAgICAgICAgfQogICAgICAgICAgaWYoIWVsICYmIGNvbnRhaW5lcil7CiAgICAgICAgICAgIGNvbnN0IGNhcmRzID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoIi5jYXJkIik7CiAgICAgICAgICAgIGVsID0gY2FyZHNbY2FyZHMubGVuZ3RoLTFdOwogICAgICAgICAgfQogICAgICAgICAgYXBwbHlEZWZhdWx0Q2FyZExvb2soZWwpOwogICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICB9OwogICAgICAgIEFwcC5fX3BhdGNoZWRDcmVhdGUgPSB0cnVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9Y2F0Y2goZSl7fQogICAgcmV0dXJuIGZhbHNlOwogIH0KICBpZighcGF0Y2hDcmVhdGUoKSl7CiAgICAvLyBGYWxsYmFjazogd2F0Y2ggRE9NIGZvciBuZXcgLmNhcmQgbm9kZXMKICAgIGNvbnN0IG9icyA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRzKT0+ewogICAgICBtdXRzLmZvckVhY2gobT0+ewogICAgICAgIG0uYWRkZWROb2RlcyAmJiBtLmFkZGVkTm9kZXMuZm9yRWFjaChuPT57CiAgICAgICAgICBpZihuICYmIG4ubm9kZVR5cGU9PT0xKXsKICAgICAgICAgICAgaWYobi5jbGFzc0xpc3QuY29udGFpbnMoImNhcmQiKSkgYXBwbHlEZWZhdWx0Q2FyZExvb2sobik7CiAgICAgICAgICAgIG4ucXVlcnlTZWxlY3RvckFsbCAmJiBuLnF1ZXJ5U2VsZWN0b3JBbGwoIi5jYXJkIikuZm9yRWFjaChhcHBseURlZmF1bHRDYXJkTG9vayk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CiAgICBvYnMub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7IGNoaWxkTGlzdDp0cnVlLCBzdWJ0cmVlOnRydWUgfSk7CiAgfQp9KSgpOw=="},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgY29uc3QgTUFQX0tFWSA9ICJyYW1pZnlfaGVhZGluZ19iYXJfbWFwIjsKICBmdW5jdGlvbiBsb2FkTWFwKCl7IHRyeXsgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oTUFQX0tFWSl8fCJ7fSIpOyB9Y2F0Y2h7IHJldHVybiB7fTsgfSB9CiAgZnVuY3Rpb24gc2F2ZU1hcChtKXsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTUFQX0tFWSwgSlNPTi5zdHJpbmdpZnkobSkpOyB9CgogIGxldCB0YXJnZXRIZWFkaW5nID0gbnVsbDsgLy8gbmFtZSBzdHJpbmcKICBjb25zdCBwYWxldHRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhlYWRpbmdDb2xvclBhbGV0dGUiKTsKICBjb25zdCBhcHBseUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJoZWFkaW5nQmFyQXBwbHkiKTsKCiAgZnVuY3Rpb24gb3BlblBhbGV0dGVGb3IobmFtZSwgYW5jaG9yQnRuKXsKICAgIHRhcmdldEhlYWRpbmcgPSBuYW1lOwogICAgLy8gcG9zaXRpb24gbmVhciBhbmNob3IKICAgIGNvbnN0IHIgPSBhbmNob3JCdG4uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICBwYWxldHRlLnN0eWxlLmxlZnQgPSAoci5sZWZ0ICsgd2luZG93LnNjcm9sbFggLSAxMCkgKyAicHgiOwogICAgcGFsZXR0ZS5zdHlsZS50b3AgID0gKHIuYm90dG9tICsgd2luZG93LnNjcm9sbFkgKyA4KSArICJweCI7CiAgICBwYWxldHRlLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhlYWRpbmdCYXJDdXN0b20iKS52YWx1ZSA9ICIiOwogIH0KICBmdW5jdGlvbiBjbG9zZVBhbGV0dGUoKXsgcGFsZXR0ZS5zdHlsZS5kaXNwbGF5PSJub25lIjsgfQoKICBhcHBseUJ0bi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKCl7CiAgICBjb25zdCB2YWwgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhlYWRpbmdCYXJDdXN0b20iKS52YWx1ZXx8IiIpLnRyaW0oKTsKICAgIGlmKCF0YXJnZXRIZWFkaW5nKSByZXR1cm47CiAgICBjb25zdCBtYXAgPSBsb2FkTWFwKCk7CiAgICBtYXBbdGFyZ2V0SGVhZGluZ10gPSB2YWw7CiAgICBzYXZlTWFwKG1hcCk7CiAgICBhcHBseUhlYWRpbmdCYXIodGFyZ2V0SGVhZGluZywgdmFsKTsKICAgIGNsb3NlUGFsZXR0ZSgpOwogIH0pOwogIHBhbGV0dGUucXVlcnlTZWxlY3RvckFsbCgiLnN3YXRjaCIpLmZvckVhY2goZnVuY3Rpb24oZWwpewogICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbigpewogICAgICBpZighdGFyZ2V0SGVhZGluZykgcmV0dXJuOwogICAgICBjb25zdCB2YWwgPSBlbC5nZXRBdHRyaWJ1dGUoImRhdGEtdmFsIikgfHwgIiI7CiAgICAgIGNvbnN0IG1hcCA9IGxvYWRNYXAoKTsgbWFwW3RhcmdldEhlYWRpbmddID0gdmFsOyBzYXZlTWFwKG1hcCk7CiAgICAgIGFwcGx5SGVhZGluZ0Jhcih0YXJnZXRIZWFkaW5nLCB2YWwpOwogICAgICBjbG9zZVBhbGV0dGUoKTsKICAgIH0pOwogIH0pOwoKICBmdW5jdGlvbiBhcHBseUhlYWRpbmdCYXIobmFtZSwgdmFsdWUpewogICAgY29uc3QgYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI21haW4taGVhZGluZy0ke0NTUy5lc2NhcGUobmFtZSl9IC5oZWFkaW5nLWJhcmApOwogICAgaWYoIWJhcikgcmV0dXJuOwogICAgYmFyLnN0eWxlLmJhY2tncm91bmQgPSAodmFsdWUgJiYgdmFsdWUubGVuZ3RoID8gdmFsdWUgOiAibGluZWFyLWdyYWRpZW50KDEzNWRlZywjMzk0MDRhLCMxYjI0MzApIik7CiAgICBiYXIuc3R5bGUuYm9yZGVyID0gIjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMDgpIjsKICB9CgogIC8vIEFkZCBhICLwn46oIEJhciBjb2xvciIgaXRlbSBpbnRvIGVhY2ggMy1kb3QgbWVudSBhZnRlciByZW5kZXIKICBmdW5jdGlvbiBlbmhhbmNlTWVudXMoKXsKICAgIGlmKCF3aW5kb3cuQXBwIHx8ICFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGVhZGluZ3NSb290IikpIHJldHVybjsKICAgIChBcHAuc3RhdGUuaGVhZGluZ3MgfHwgW10pLmZvckVhY2goZnVuY3Rpb24obmFtZSl7CiAgICAgIGNvbnN0IG1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgaGEtJHtuYW1lfWApOwogICAgICBpZighbWVudSkgcmV0dXJuOwogICAgICBpZihtZW51LnF1ZXJ5U2VsZWN0b3IoIi5yb3cgLmJhci1jb2xvci1idG4iKSkgcmV0dXJuOyAvLyBhbHJlYWR5IGFkZGVkCiAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICByb3cuY2xhc3NOYW1lID0gInJvdyI7CiAgICAgIHJvdy5zdHlsZS5tYXJnaW5Ub3AgPSAiNnB4IjsKICAgICAgcm93LmlubmVySFRNTCA9IGA8YnV0dG9uIGNsYXNzPSJjaGlwLWJ0biBiYXItY29sb3ItYnRuIj7wn46oIEJhciBjb2xvcjwvYnV0dG9uPmA7CiAgICAgIG1lbnUuaW5zZXJ0QmVmb3JlKHJvdywgbWVudS5maXJzdENoaWxkLm5leHRTaWJsaW5nKTsgLy8gYWZ0ZXIgZmlyc3Qgcm93IChBZGQgc2hvcnRjdXQpCiAgICAgIGNvbnN0IGJ0biA9IHJvdy5xdWVyeVNlbGVjdG9yKCIuYmFyLWNvbG9yLWJ0biIpOwogICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbihldil7CiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgb3BlblBhbGV0dGVGb3IobmFtZSwgYnRuKTsKICAgICAgfSk7CiAgICB9KTsKICB9CgogIC8vIEFwcGx5IHNhdmVkIGNvbG9ycyB0byBiYXJzCiAgZnVuY3Rpb24gYXBwbHlBbGxTYXZlZCgpewogICAgY29uc3QgbWFwID0gbG9hZE1hcCgpOwogICAgKEFwcC5zdGF0ZS5oZWFkaW5ncyB8fCBbXSkuZm9yRWFjaChmdW5jdGlvbihuYW1lKXsKICAgICAgaWYobWFwLmhhc093blByb3BlcnR5KG5hbWUpKXsKICAgICAgICBhcHBseUhlYWRpbmdCYXIobmFtZSwgbWFwW25hbWVdIHx8ICIiKTsKICAgICAgfQogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBwYXRjaFJlbmRlcigpewogICAgaWYoIXdpbmRvdy5BcHAgfHwgQXBwLl9fcmVuZGVySGVhZGluZ3NQYXRjaGVkKSByZXR1cm47CiAgICBjb25zdCBvcmlnID0gQXBwLnJlbmRlckhlYWRpbmdzVUkgPyBBcHAucmVuZGVySGVhZGluZ3NVSS5iaW5kKEFwcCkgOiBudWxsOwogICAgaWYoIW9yaWcpIHJldHVybjsKICAgIEFwcC5yZW5kZXJIZWFkaW5nc1VJID0gZnVuY3Rpb24oKXsKICAgICAgY29uc3QgciA9IG9yaWcoKTsKICAgICAgLy8gQWZ0ZXIgb3JpZ2luYWwgcmVuZGVyLCBlbmhhbmNlIG1lbnVzIGFuZCBhcHBseSBzYXZlZCBzdHlsZXMKICAgICAgdHJ5eyBlbmhhbmNlTWVudXMoKTsgYXBwbHlBbGxTYXZlZCgpOyB9Y2F0Y2goZSl7IGNvbnNvbGUud2FybihlKTsgfQogICAgICByZXR1cm4gcjsKICAgIH07CiAgICBBcHAuX19yZW5kZXJIZWFkaW5nc1BhdGNoZWQgPSB0cnVlOwogIH0KCiAgLy8gU3Ryb25nZXIgZGVmYXVsdCBjYXJkIGNvbG9yIGVuZm9yY2VtZW50IChwcmV2ZW50cyB0ZWFsIGZsYXNoKQogIGZ1bmN0aW9uIHJlaW5mb3JjZUNhcmREZWZhdWx0cygpewogICAgY29uc3QgYXBwbHkgPSAoY2FyZCk9PnsKICAgICAgaWYoIWNhcmQpIHJldHVybjsKICAgICAgLy8gZm9yY2Ugd2l0aCAhaW1wb3J0YW50IHNvIGFueSBpbmxpbmUgdGVhbCBpcyBvdmVycmlkZGVuCiAgICAgIGNhcmQuc3R5bGUuc2V0UHJvcGVydHkoImJhY2tncm91bmQiLCBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuZ2V0UHJvcGVydHlWYWx1ZSgiLS1jYXJkIikudHJpbSgpIHx8ICIjMTMxYTIyIiwgImltcG9ydGFudCIpOwogICAgICBjYXJkLnN0eWxlLnNldFByb3BlcnR5KCJjb2xvciIsIGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5nZXRQcm9wZXJ0eVZhbHVlKCItLXRleHQiKS50cmltKCkgfHwgIiNlYWYyZmYiLCAiaW1wb3J0YW50Iik7CiAgICB9OwogICAgY29uc3Qgb2JzID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dHMpPT57CiAgICAgIG11dHMuZm9yRWFjaChtPT57CiAgICAgICAgbS5hZGRlZE5vZGVzICYmIG0uYWRkZWROb2Rlcy5mb3JFYWNoKG49PnsKICAgICAgICAgIGlmKG4ubm9kZVR5cGU9PT0xKXsKICAgICAgICAgICAgaWYobi5jbGFzc0xpc3QgJiYgbi5jbGFzc0xpc3QuY29udGFpbnMoImNhcmQiKSkgYXBwbHkobik7CiAgICAgICAgICAgIG4ucXVlcnlTZWxlY3RvckFsbCAmJiBuLnF1ZXJ5U2VsZWN0b3JBbGwoIi5jYXJkIikuZm9yRWFjaChhcHBseSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CiAgICBvYnMub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7IGNoaWxkTGlzdDp0cnVlLCBzdWJ0cmVlOnRydWUgfSk7CiAgICAvLyBTd2VlcCBleGlzdGluZyBvbmNlCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCIuY2FyZCIpLmZvckVhY2goYXBwbHkpOwogIH0KCiAgLy8gRGlzbWlzcyBwYWxldHRlIG9uIG91dHNpZGUgY2xpY2sKICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKGV2KXsKICAgIGlmKHBhbGV0dGUuc3R5bGUuZGlzcGxheT09PSJibG9jayIgJiYgIXBhbGV0dGUuY29udGFpbnMoZXYudGFyZ2V0KSl7CiAgICAgIGNsb3NlUGFsZXR0ZSgpOwogICAgfQogIH0pOwoKICBmdW5jdGlvbiBpbml0KCl7CiAgICBwYXRjaFJlbmRlcigpOwogICAgLy8gSWYgaGVhZGluZ3MgYWxyZWFkeSByZW5kZXJlZCwgcnVuIG5vdwogICAgdHJ5eyBlbmhhbmNlTWVudXMoKTsgYXBwbHlBbGxTYXZlZCgpOyB9Y2F0Y2h7fQogICAgcmVpbmZvcmNlQ2FyZERlZmF1bHRzKCk7CiAgfQogIGlmKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICJsb2FkaW5nIil7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgaW5pdCwgeyBvbmNlOnRydWUgfSk7CiAgfSBlbHNlIHsgaW5pdCgpOyB9Cn0pKCk7"},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgLy8gUmVtb3ZlIGxlZ2FjeSBmbG9hdGluZyBidXR0b24gbm9kZSBpZiBwcmVzZW50CiAgY29uc3QgbGVnYWN5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJhckNvbG9yRmFiIik7CiAgaWYobGVnYWN5ICYmIGxlZ2FjeS5wYXJlbnROb2RlKXsgbGVnYWN5LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobGVnYWN5KTsgfQoKICAvLyBFeHBhbmQgcGVyLWhlYWRpbmcgcGFsZXR0ZSB3aXRoIG1vcmUgb3B0aW9ucwogIGNvbnN0IHBhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJoZWFkaW5nQ29sb3JQYWxldHRlIik7CiAgaWYocGFsICYmICFwYWwuZGF0YXNldC5lbmhhbmNlZCl7CiAgICBwYWwuZGF0YXNldC5lbmhhbmNlZCA9ICIxIjsKICAgIGNvbnN0IGdyaWQgPSBwYWwucXVlcnlTZWxlY3RvcigiLnN3YXRjaGVzIik7CiAgICBpZihncmlkKXsKICAgICAgY29uc3QgZXh0cmEgPSBbCiAgICAgICAgImxpbmVhci1ncmFkaWVudCgxMzVkZWcsIzBlYTVlOSwjOTMzM2VhKSIsICAgLy8gY3liZXJ3YXZlCiAgICAgICAgImxpbmVhci1ncmFkaWVudCgxMzVkZWcsI2Y0M2Y1ZSwjMjJkM2VlKSIsICAgLy8gbmVvbiBjYW5keQogICAgICAgICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCNmNTllMGIsIzg0Y2MxNikiLCAgIC8vIHN1bnNldCBsaW1lCiAgICAgICAgImxpbmVhci1ncmFkaWVudCgxMzVkZWcsIzFlMjkzYiwjMGVhNWU5KSIsICAgLy8gbWlkbmlnaHQgb2NlYW4KICAgICAgICAibGluZWFyLWdyYWRpZW50KDEzNWRlZywjZWY0NDQ0LCMzYjgyZjYpIiwgICAvLyBoZWF0IHZzIGNvb2wKICAgICAgICAibGluZWFyLWdyYWRpZW50KDEzNWRlZywjMTRiOGE2LCNmYWNjMTUpIiAgICAvLyB0cm9waWMKICAgICAgXTsKICAgICAgZXh0cmEuZm9yRWFjaCh2PT57CiAgICAgICAgY29uc3QgZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgIGQuY2xhc3NOYW1lID0gInN3YXRjaCI7IGQuc2V0QXR0cmlidXRlKCJkYXRhLXZhbCIsIHYpOwogICAgICAgIGQuc2V0QXR0cmlidXRlKCJzdHlsZSIsICJoZWlnaHQ6MzZweDtib3JkZXItcmFkaXVzOjEwcHg7Y3Vyc29yOnBvaW50ZXI7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LC4xMik7YmFja2dyb3VuZDoiK3YpOwogICAgICAgIGdyaWQuYXBwZW5kQ2hpbGQoZCk7CiAgICAgIH0pOwogICAgICAvLyByZWJpbmQgY2xpY2sgZm9yIG5ld2x5IGFkZGVkIHN3YXRjaGVzCiAgICAgIGNvbnN0IGFwcGx5ID0gZnVuY3Rpb24obmFtZSwgdmFsKXsKICAgICAgICBjb25zdCBtYXAgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJyYW1pZnlfaGVhZGluZ19iYXJfbWFwIil8fCJ7fSIpOwogICAgICAgIG1hcFtuYW1lXSA9IHZhbDsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInJhbWlmeV9oZWFkaW5nX2Jhcl9tYXAiLCBKU09OLnN0cmluZ2lmeShtYXApKTsKICAgICAgICBjb25zdCBiYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjbWFpbi1oZWFkaW5nLSR7Q1NTLmVzY2FwZShuYW1lKX0gLmhlYWRpbmctYmFyYCk7CiAgICAgICAgaWYoYmFyKXsgYmFyLnN0eWxlLmJhY2tncm91bmQgPSAodmFsfHwibGluZWFyLWdyYWRpZW50KDEzNWRlZywjMzk0MDRhLCMxYjI0MzApIik7IGJhci5zdHlsZS5ib3JkZXI9IjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMDgpIjsgfQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJoZWFkaW5nQ29sb3JQYWxldHRlIikuc3R5bGUuZGlzcGxheT0ibm9uZSI7CiAgICAgIH07CiAgICAgIHBhbC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKGV2KXsKICAgICAgICBjb25zdCBzdyA9IGV2LnRhcmdldC5jbG9zZXN0KCIuc3dhdGNoIik7IGlmKCFzdykgcmV0dXJuOwogICAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5iYXItY29sb3ItYnRuLl9fYWN0aXZlX2ZvciIpOwogICAgICAgIGlmKCFidG4pIHJldHVybjsKICAgICAgICBjb25zdCBuYW1lID0gYnRuLmRhdGFzZXQuaGVhZGluZzsKICAgICAgICBhcHBseShuYW1lLCBzdy5nZXRBdHRyaWJ1dGUoImRhdGEtdmFsIil8fCIiKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICAvLyBNYXJrIHRoZSBhY3RpdmUgaGVhZGluZyBidXR0b24gd2hlbiBvcGVuaW5nIHBhbGV0dGUgc28gd2UgY2FuIGtub3cgd2hpY2ggaGVhZGluZyB0byB1cGRhdGUKICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKGV2KXsKICAgIGNvbnN0IGJ0biA9IGV2LnRhcmdldC5jbG9zZXN0KCIuYmFyLWNvbG9yLWJ0biIpOwogICAgaWYoYnRuKXsgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiLmJhci1jb2xvci1idG4uX19hY3RpdmVfZm9yIikuZm9yRWFjaChiPT5iLmNsYXNzTGlzdC5yZW1vdmUoIl9fYWN0aXZlX2ZvciIpKTsKICAgICAgYnRuLmNsYXNzTGlzdC5hZGQoIl9fYWN0aXZlX2ZvciIpOyBidG4uZGF0YXNldC5oZWFkaW5nID0gYnRuLmNsb3Nlc3QoJ1tpZF49XCJtYWluLWhlYWRpbmctXCJdJykuaWQucmVwbGFjZSgnbWFpbi1oZWFkaW5nLScsJycpOwogICAgfQogIH0pOwoKICAvLyBVbHRyYS1zdHJvbmcgZGVmYXVsdCBjb2xvciBlbmZvcmNlbWVudCBmb3IgTkVXIGNhcmRzIChwcmV2ZW50cyB0ZWFsIHN0aWNraW5nKQogIGNvbnN0IGZvcmNlRGVmYXVsdCA9IChlbCk9PnsKICAgIGlmKCFlbCkgcmV0dXJuOwogICAgZWwuc3R5bGUuc2V0UHJvcGVydHkoImJhY2tncm91bmQiLCBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuZ2V0UHJvcGVydHlWYWx1ZSgiLS1jYXJkIikudHJpbSgpIHx8ICIjMTMxYTIyIiwgImltcG9ydGFudCIpOwogICAgZWwuc3R5bGUuc2V0UHJvcGVydHkoImNvbG9yIiwgZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLmdldFByb3BlcnR5VmFsdWUoIi0tdGV4dCIpLnRyaW0oKSB8fCAiI2VhZjJmZiIsICJpbXBvcnRhbnQiKTsKICB9OwogIGNvbnN0IG9icyA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRzKT0+ewogICAgbXV0cy5mb3JFYWNoKG09PnsKICAgICAgbS5hZGRlZE5vZGVzICYmIG0uYWRkZWROb2Rlcy5mb3JFYWNoKG49PnsKICAgICAgICBpZihuLm5vZGVUeXBlPT09MSl7CiAgICAgICAgICBpZihuLmNsYXNzTGlzdCAmJiBuLmNsYXNzTGlzdC5jb250YWlucygiY2FyZCIpKSBmb3JjZURlZmF1bHQobik7CiAgICAgICAgICBuLnF1ZXJ5U2VsZWN0b3JBbGwgJiYgbi5xdWVyeVNlbGVjdG9yQWxsKCIuY2FyZCIpLmZvckVhY2goZm9yY2VEZWZhdWx0KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgfSk7CiAgb2JzLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge2NoaWxkTGlzdDp0cnVlLCBzdWJ0cmVlOnRydWV9KTsKICAvLyBpbml0aWFsIHN3ZWVwCiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiLmNhcmQiKS5mb3JFYWNoKGZvcmNlRGVmYXVsdCk7Cn0pKCk7"},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgLy8gV2hlbiB1c2VyIGNsaWNrcyAi8J+OqCBCYXIgY29sb3IiLCBrZWVwIHRoZSBkcm9wZG93biBvcGVuIGFuZCBzaG93IHBhbGV0dGUgYWJvdmUgaXQKICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKGV2KXsKICAgIGNvbnN0IGJ0biA9IGV2LnRhcmdldC5jbG9zZXN0KCIuYmFyLWNvbG9yLWJ0biIpOwogICAgaWYoIWJ0bikgcmV0dXJuOwogICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICBjb25zdCBtZW51ID0gYnRuLmNsb3Nlc3QoIi5taW5pLW1lbnUiKTsKICAgIGlmKG1lbnUpeyBtZW51LnN0eWxlLnpJbmRleCA9IDk5MDAwMDsgfSAvLyBrZWVwIG1lbnUgYmVsb3cgcGFsZXR0ZSBidXQgYWJvdmUgcGFnZQogICAgLy8gcG9zaXRpb24gcGFsZXR0ZSBqdXN0IHRvIHRoZSByaWdodCBvZiB0aGUgbWVudSB0byBhdm9pZCBvdmVybGFwCiAgICBjb25zdCBwYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGVhZGluZ0NvbG9yUGFsZXR0ZSIpOwogICAgY29uc3QgciA9IGJ0bi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIHBhbC5zdHlsZS5sZWZ0ID0gKHIucmlnaHQgKyA4ICsgd2luZG93LnNjcm9sbFgpICsgInB4IjsKICAgIHBhbC5zdHlsZS50b3AgID0gKHIudG9wICsgd2luZG93LnNjcm9sbFkpICsgInB4IjsKICAgIHBhbC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICB9LCB0cnVlKTsKfSkoKTs="},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgLyogLS0tLS0tLS0tLSAxKSBGSU5BTCBURUFMIEtJTEw6IHdyYXAgQXBwLmNyZWF0ZUNhcmQgLS0tLS0tLS0tLSAqLwogIGZ1bmN0aW9uIGZvcmNlRGVmYXVsdE9uKGVsKXsKICAgIGlmKCFlbCkgcmV0dXJuOwogICAgZWwuc3R5bGUuc2V0UHJvcGVydHkoJ2JhY2tncm91bmQnLCBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuZ2V0UHJvcGVydHlWYWx1ZSgnLS1jYXJkJykudHJpbSgpIHx8ICcjMTMxYTIyJywgJ2ltcG9ydGFudCcpOwogICAgZWwuc3R5bGUuc2V0UHJvcGVydHkoJ2NvbG9yJywgZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLmdldFByb3BlcnR5VmFsdWUoJy0tdGV4dCcpLnRyaW0oKSB8fCAnI2VhZjJmZicsICdpbXBvcnRhbnQnKTsKICB9CiAgZnVuY3Rpb24gcGF0Y2hDcmVhdGVDYXJkKCl7CiAgICBpZighd2luZG93LkFwcCB8fCBBcHAuX19ub1RlYWwpIHJldHVybjsKICAgIGlmKHR5cGVvZiBBcHAuY3JlYXRlQ2FyZCAhPT0gJ2Z1bmN0aW9uJykgcmV0dXJuOwogICAgY29uc3Qgb3JpZyA9IEFwcC5jcmVhdGVDYXJkLmJpbmQoQXBwKTsKICAgIEFwcC5jcmVhdGVDYXJkID0gZnVuY3Rpb24oY29udGFpbmVyLCBoZWFkaW5nTmFtZSwgaXRlbSl7CiAgICAgIC8vIEd1YXJhbnRlZSBpdGVtIGhhcyBubyB0ZWFsLWlzaCBkZWZhdWx0CiAgICAgIHRyeXsKICAgICAgICBpZihpdGVtKXsKICAgICAgICAgIGlmKCFpdGVtLmNvbG9yTmFtZSB8fCAvXmRlZmF1bHQkL2kudGVzdChpdGVtLmNvbG9yTmFtZSkgfHwgL150ZWFsJC9pLnRlc3QoaXRlbS5jb2xvck5hbWUpKXsKICAgICAgICAgICAgaXRlbS5jb2xvck5hbWUgPSAnJzsgLy8gbmV1dHJhbDsgcmVuZGVyZXIgd2lsbCBmYWxsIGJhY2sgdG8gdmFyKC0tY2FyZCkKICAgICAgICAgICAgaWYoJ2NvbG9yJyBpbiBpdGVtKSBpdGVtLmNvbG9yID0gJyc7IC8vIGNsZWFyIGFueSBvdmVycmlkZQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfWNhdGNoe30KICAgICAgY29uc3QgcmVzID0gb3JpZyhjb250YWluZXIsIGhlYWRpbmdOYW1lLCBpdGVtKTsKICAgICAgdHJ5ewogICAgICAgIC8vIEZpbmQgdGhlIGNhcmQgd2UganVzdCBhcHBlbmRlZCAobGFzdCBjaGlsZCkKICAgICAgICBsZXQgY2FyZCA9IG51bGw7CiAgICAgICAgaWYoY29udGFpbmVyKXsKICAgICAgICAgIGNvbnN0IGNhcmRzID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYXJkJyk7CiAgICAgICAgICBjYXJkID0gY2FyZHNbY2FyZHMubGVuZ3RoLTFdIHx8IG51bGw7CiAgICAgICAgfQogICAgICAgIGZvcmNlRGVmYXVsdE9uKGNhcmQpOwogICAgICB9Y2F0Y2h7fQogICAgICByZXR1cm4gcmVzOwogICAgfTsKICAgIEFwcC5fX25vVGVhbCA9IHRydWU7CiAgfQoKICAvKiAtLS0tLS0tLS0tIDIpIFBFUi1CQVIgQ09MT1IgU0FWRS9BUFBMWSAocm9idXN0KSAtLS0tLS0tLS0tICovCiAgY29uc3QgTUFQX0tFWSA9ICdyYW1pZnlfaGVhZGluZ19iYXJfbWFwJzsKICBsZXQgX2xhc3RIZWFkaW5nRm9yUGFsZXR0ZSA9IG51bGw7CgogIGZ1bmN0aW9uIGxvYWRNYXAoKXsgdHJ5eyByZXR1cm4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShNQVBfS0VZKXx8J3t9Jyk7IH1jYXRjaHsgcmV0dXJuIHt9OyB9IH0KICBmdW5jdGlvbiBzYXZlTWFwKG0peyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShNQVBfS0VZLCBKU09OLnN0cmluZ2lmeShtKSk7IH0KICBmdW5jdGlvbiBhcHBseUhlYWRpbmdCYXIobmFtZSwgdmFsdWUpewogICAgY29uc3QgYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI21haW4taGVhZGluZy0ke0NTUy5lc2NhcGUobmFtZSl9IC5oZWFkaW5nLWJhcmApOwogICAgaWYoIWJhcikgcmV0dXJuOwogICAgYmFyLnN0eWxlLmJhY2tncm91bmQgPSAodmFsdWUgJiYgdmFsdWUubGVuZ3RoID8gdmFsdWUgOiAnbGluZWFyLWdyYWRpZW50KDEzNWRlZywjMzk0MDRhLCMxYjI0MzApJyk7CiAgICBiYXIuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMDgpJzsKICB9CiAgZnVuY3Rpb24gYXBwbHlBbGxTYXZlZCgpewogICAgY29uc3QgbWFwID0gbG9hZE1hcCgpOwogICAgKHdpbmRvdy5BcHAgJiYgQXBwLnN0YXRlICYmIEFwcC5zdGF0ZS5oZWFkaW5ncyB8fCBbXSkuZm9yRWFjaChmdW5jdGlvbihuYW1lKXsKICAgICAgaWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1hcCwgbmFtZSkpIGFwcGx5SGVhZGluZ0JhcihuYW1lLCBtYXBbbmFtZV18fCcnKTsKICAgIH0pOwogIH0KICBmdW5jdGlvbiBlbmhhbmNlTWVudXMoKXsKICAgICh3aW5kb3cuQXBwICYmIEFwcC5zdGF0ZSAmJiBBcHAuc3RhdGUuaGVhZGluZ3MgfHwgW10pLmZvckVhY2goZnVuY3Rpb24obmFtZSl7CiAgICAgIGNvbnN0IG1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgaGEtJHtuYW1lfWApOwogICAgICBpZighbWVudSB8fCBtZW51LnF1ZXJ5U2VsZWN0b3IoJy5iYXItY29sb3ItYnRuJykpIHJldHVybjsKICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgIHJvdy5jbGFzc05hbWUgPSAncm93Jzsgcm93LnN0eWxlLm1hcmdpblRvcCA9ICc2cHgnOwogICAgICByb3cuaW5uZXJIVE1MID0gYDxidXR0b24gY2xhc3M9ImNoaXAtYnRuIGJhci1jb2xvci1idG4iPvCfjqggQmFyIGNvbG9yPC9idXR0b24+YDsKICAgICAgLy8gQWRkIGFzIGZpcnN0IGFjdGlvbmFibGUgaXRlbQogICAgICBtZW51Lmluc2VydEJlZm9yZShyb3csIG1lbnUuZmlyc3RDaGlsZCk7CiAgICAgIGNvbnN0IGJ0biA9IHJvdy5xdWVyeVNlbGVjdG9yKCcuYmFyLWNvbG9yLWJ0bicpOwogICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldil7CiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgX2xhc3RIZWFkaW5nRm9yUGFsZXR0ZSA9IG5hbWU7CiAgICAgICAgY29uc3QgcGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlYWRpbmdDb2xvclBhbGV0dGUnKTsKICAgICAgICBpZighcGFsKXsKICAgICAgICAgIC8vIENyZWF0ZSBwYWxldHRlIGlmIG1pc3NpbmcKICAgICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgZGl2LmlkID0gJ2hlYWRpbmdDb2xvclBhbGV0dGUnOwogICAgICAgICAgZGl2LnNldEF0dHJpYnV0ZSgncm9sZScsICdkaWFsb2cnKTsKICAgICAgICAgIGRpdi5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6YmxvY2s7cG9zaXRpb246Zml4ZWQ7ei1pbmRleDoyMTQ3NDgzMDAwO2JhY2tncm91bmQ6IzBmMTQxYztib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjEyKTtib3JkZXItcmFkaXVzOjE0cHg7cGFkZGluZzoxMnB4O2JveC1zaGFkb3c6MCAxMHB4IDI4cHggcmdiYSgwLDAsMCwuNDUpO21pbi13aWR0aDoyNjBweDsnOwogICAgICAgICAgZGl2LmlubmVySFRNTCA9ICc8aDQgc3R5bGU9XCJtYXJnaW46MCAwIDhweDtmb250LXNpemU6MTRweFwiPkhlYWRpbmcgQmFyIGNvbG9yPC9oND48ZGl2IGNsYXNzPVwic3dhdGNoZXNcIiBzdHlsZT1cImRpc3BsYXk6Z3JpZDtncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KDMsMWZyKTtnYXA6OHB4XCI+PC9kaXY+JzsKICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZGl2KTsKICAgICAgICAgIGNvbnN0IHByZXNldHMgPSBbJycsICdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMyMmQzZWUsI2E3OGJmYSknLCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMxMGI5ODEsIzYwYTVmYSknLCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMwZWE1ZTksIzE0YjhhNiknLCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCNlZjQ0NDQsI2Y1OWUwYiknLCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCM4YjVjZjYsIzA2YjZkNCknLCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMwZWE1ZTksIzkzMzNlYSknLCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCNmNTllMGIsIzg0Y2MxNiknLCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMxZTI5M2IsIzBlYTVlOSknLCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMxNGI4YTYsI2ZhY2MxNSknXTsKICAgICAgICAgIGNvbnN0IGdyaWQgPSBkaXYucXVlcnlTZWxlY3RvcignLnN3YXRjaGVzJyk7CiAgICAgICAgICBwcmVzZXRzLmZvckVhY2godj0+eyBjb25zdCBkPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBkLmNsYXNzTmFtZT0nc3dhdGNoJzsgZC5kYXRhc2V0LnZhbD12OyBkLnN0eWxlLmNzc1RleHQ9J2hlaWdodDozNnB4O2JvcmRlci1yYWRpdXM6MTBweDtjdXJzb3I6cG9pbnRlcjtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjEyKTtiYWNrZ3JvdW5kOicrKHZ8fCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMzOTQwNGEsIzFiMjQzMCknKTsgZ3JpZC5hcHBlbmRDaGlsZChkKTsgfSk7CiAgICAgICAgICBkaXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXsKICAgICAgICAgICAgY29uc3Qgc3cgPSBlLnRhcmdldC5jbG9zZXN0KCcuc3dhdGNoJyk7IGlmKCFzdyB8fCAhX2xhc3RIZWFkaW5nRm9yUGFsZXR0ZSkgcmV0dXJuOwogICAgICAgICAgICBjb25zdCBtYXAgPSBsb2FkTWFwKCk7IG1hcFtfbGFzdEhlYWRpbmdGb3JQYWxldHRlXSA9IHN3LmRhdGFzZXQudmFsIHx8ICcnOyBzYXZlTWFwKG1hcCk7CiAgICAgICAgICAgIGFwcGx5SGVhZGluZ0JhcihfbGFzdEhlYWRpbmdGb3JQYWxldHRlLCBzdy5kYXRhc2V0LnZhbHx8JycpOyBkaXYuc3R5bGUuZGlzcGxheT0nbm9uZSc7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgY29uc3QgcGFsMiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZWFkaW5nQ29sb3JQYWxldHRlJyk7CiAgICAgICAgY29uc3QgciA9IGJ0bi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBwYWwyLnN0eWxlLmxlZnQgPSAoci5yaWdodCArIDggKyB3aW5kb3cuc2Nyb2xsWCkgKyAncHgnOwogICAgICAgIHBhbDIuc3R5bGUudG9wICA9IChyLnRvcCArIHdpbmRvdy5zY3JvbGxZKSArICdweCc7CiAgICAgICAgcGFsMi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAvLyBsaWZ0IG1lbnUgYnV0IGtlZXAgYmVsb3cgcGFsZXR0ZQogICAgICAgIG1lbnUuc3R5bGUuekluZGV4ID0gMjE0NzQ4MjAwMDsKICAgICAgfSk7CiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIHBhdGNoUmVuZGVySGVhZGluZ3MoKXsKICAgIGlmKCF3aW5kb3cuQXBwIHx8IEFwcC5fX21lbnVzRW5oYW5jZWQpIHJldHVybjsKICAgIGNvbnN0IG9yaWcgPSBBcHAucmVuZGVySGVhZGluZ3NVSSAmJiBBcHAucmVuZGVySGVhZGluZ3NVSS5iaW5kKEFwcCk7CiAgICBpZighb3JpZykgcmV0dXJuOwogICAgQXBwLnJlbmRlckhlYWRpbmdzVUkgPSBmdW5jdGlvbigpewogICAgICBjb25zdCByID0gb3JpZygpOwogICAgICB0cnl7IGVuaGFuY2VNZW51cygpOyBhcHBseUFsbFNhdmVkKCk7IH1jYXRjaChlKXsgY29uc29sZS53YXJuKGUpOyB9CiAgICAgIHJldHVybiByOwogICAgfTsKICAgIEFwcC5fX21lbnVzRW5oYW5jZWQgPSB0cnVlOwogIH0KCiAgZnVuY3Rpb24gaW5pdCgpewogICAgcGF0Y2hDcmVhdGVDYXJkKCk7CiAgICBwYXRjaFJlbmRlckhlYWRpbmdzKCk7CiAgICAvLyBpbml0aWFsIGFwcGx5IGlmIGFscmVhZHkgcmVuZGVyZWQKICAgIHRyeXsgZW5oYW5jZU1lbnVzKCk7IGFwcGx5QWxsU2F2ZWQoKTsgfWNhdGNoe30KICAgIC8vIEdsb2JhbCBjbGljayB0byBjbG9zZSBwYWxldHRlIHdoZW4gY2xpY2tpbmcgZWxzZXdoZXJlCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2KXsKICAgICAgY29uc3QgcGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlYWRpbmdDb2xvclBhbGV0dGUnKTsgaWYoIXBhbCkgcmV0dXJuOwogICAgICBpZihwYWwuc3R5bGUuZGlzcGxheT09PSdibG9jaycgJiYgIXBhbC5jb250YWlucyhldi50YXJnZXQpICYmICFldi50YXJnZXQuY2xvc2VzdCgnLmJhci1jb2xvci1idG4nKSkgcGFsLnN0eWxlLmRpc3BsYXk9J25vbmUnOwogICAgfSk7CiAgfQogIGlmKGRvY3VtZW50LnJlYWR5U3RhdGU9PT0nbG9hZGluZycpeyBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdCwge29uY2U6dHJ1ZX0pOyB9IGVsc2UgeyBpbml0KCk7IH0KfSkoKTs="},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgLy8gMCkgQ2xlYW4gdXAgbGVnYWN5IHN0eWxlcyBhbmQgZWxlbWVudHMgdGhhdCBibG9jayBwZXItYmFyIG92ZXJyaWRlcwogIChmdW5jdGlvbiBjbGVhbnVwKCl7CiAgICBjb25zdCBraWxsSWRzID0gWyJiYXJDb2xvckZhYiIsImJhclBhbGV0dGUiLCJiYXJDdXN0b20iLCJiYXJBcHBseSIsInJhbWlmeS1iYXItc3R5bGUiXTsKICAgIGtpbGxJZHMuZm9yRWFjaChpZD0+eyBjb25zdCBlbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7IGlmKGVsICYmIGVsLnBhcmVudE5vZGUpIGVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWwpOyB9KTsKICB9KSgpOwoKICAvLyAxKSBVdGlsaXRpZXMgZm9yIHBlci1oZWFkaW5nIGJhciBjb2xvcgogIGNvbnN0IE1BUF9LRVkgPSAncmFtaWZ5X2hlYWRpbmdfYmFyX21hcCc7CiAgZnVuY3Rpb24gbG9hZE1hcCgpeyB0cnl7IHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKE1BUF9LRVkpfHwne30nKTsgfWNhdGNoeyByZXR1cm4ge307IH0gfQogIGZ1bmN0aW9uIHNhdmVNYXAobSl7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKE1BUF9LRVksIEpTT04uc3RyaW5naWZ5KG0pKTsgfQoKICBmdW5jdGlvbiBhcHBseUhlYWRpbmdCYXIobmFtZSwgdmFsdWUpewogICAgY29uc3QgYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI21haW4taGVhZGluZy0ke0NTUy5lc2NhcGUobmFtZSl9IC5oZWFkaW5nLWJhcmApOwogICAgaWYoIWJhcikgcmV0dXJuOwogICAgY29uc3QgdmFsID0gKHZhbHVlICYmIHZhbHVlLmxlbmd0aCkgPyB2YWx1ZSA6ICdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMzOTQwNGEsIzFiMjQzMCknOwogICAgYmFyLnN0eWxlLnNldFByb3BlcnR5KCdiYWNrZ3JvdW5kJywgdmFsLCAnaW1wb3J0YW50Jyk7IC8vIGJlYXQgYW55IHRoZW1lL2RlZmF1bHRzCiAgICBiYXIuc3R5bGUuc2V0UHJvcGVydHkoJ2JvcmRlcicsICcxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwwLjA4KScsICdpbXBvcnRhbnQnKTsKICB9CgogIGZ1bmN0aW9uIGFwcGx5QWxsU2F2ZWQoKXsKICAgIGNvbnN0IG1hcCA9IGxvYWRNYXAoKTsKICAgICh3aW5kb3cuQXBwICYmIEFwcC5zdGF0ZSAmJiBBcHAuc3RhdGUuaGVhZGluZ3MgfHwgW10pLmZvckVhY2goZnVuY3Rpb24obmFtZSl7CiAgICAgIGlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtYXAsIG5hbWUpKXsKICAgICAgICBhcHBseUhlYWRpbmdCYXIobmFtZSwgbWFwW25hbWVdfHwnJyk7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgLy8gMikgUGFsZXR0ZSAobm8gY3VzdG9tIGlucHV0IGZpZWxkKSBhbmQgYXR0YWNoIHRvIDMtZG90IG1lbnUgaXRlbQogIGxldCBhY3RpdmVIZWFkaW5nID0gbnVsbDsKICBmdW5jdGlvbiBlbnN1cmVQYWxldHRlKCl7CiAgICBsZXQgcGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlYWRpbmdDb2xvclBhbGV0dGUnKTsKICAgIGlmKCFwYWwpewogICAgICBwYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgcGFsLmlkID0gJ2hlYWRpbmdDb2xvclBhbGV0dGUnOwogICAgICBwYWwuc2V0QXR0cmlidXRlKCdyb2xlJywnZGlhbG9nJyk7CiAgICAgIHBhbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDt6LWluZGV4OjIxNDc0ODMwMDA7YmFja2dyb3VuZDojMGYxNDFjO2JvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTIpO2JvcmRlci1yYWRpdXM6MTRweDtwYWRkaW5nOjEycHg7Ym94LXNoYWRvdzowIDEwcHggMjhweCByZ2JhKDAsMCwwLC40NSk7bWluLXdpZHRoOjI2MHB4Oyc7CiAgICAgIHBhbC5pbm5lckhUTUwgPSAnPGg0IHN0eWxlPVwibWFyZ2luOjAgMCA4cHg7Zm9udC1zaXplOjE0cHhcIj5IZWFkaW5nIEJhciBjb2xvcjwvaDQ+PGRpdiBjbGFzcz1cInN3YXRjaGVzXCIgc3R5bGU9XCJkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdCgzLDFmcik7Z2FwOjhweFwiPjwvZGl2Pic7CiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocGFsKTsKICAgICAgY29uc3QgcHJlc2V0cyA9IFsKICAgICAgICAnJywgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzIyZDNlZSwjYTc4YmZhKScsJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzEwYjk4MSwjNjBhNWZhKScsCiAgICAgICAgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzBlYTVlOSwjMTRiOGE2KScsJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsI2VmNDQ0NCwjZjU5ZTBiKScsCiAgICAgICAgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzhiNWNmNiwjMDZiNmQ0KScsJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzBlYTVlOSwjOTMzM2VhKScsCiAgICAgICAgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsI2Y1OWUwYiwjODRjYzE2KScsJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzFlMjkzYiwjMGVhNWU5KScsCiAgICAgICAgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzE0YjhhNiwjZmFjYzE1KScsJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsI2ZiNzE4NSwjZTg3OWY5KScsCiAgICAgICAgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzM4YmRmOCwjMjJkM2VlKScKICAgICAgXTsKICAgICAgY29uc3QgZ3JpZCA9IHBhbC5xdWVyeVNlbGVjdG9yKCcuc3dhdGNoZXMnKTsKICAgICAgcHJlc2V0cy5mb3JFYWNoKHY9PnsgY29uc3QgZD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgZC5jbGFzc05hbWU9J3N3YXRjaCc7IGQuZGF0YXNldC52YWw9djsKICAgICAgICBkLnN0eWxlLmNzc1RleHQ9J2hlaWdodDozNnB4O2JvcmRlci1yYWRpdXM6MTBweDtjdXJzb3I6cG9pbnRlcjtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjEyKTtiYWNrZ3JvdW5kOicrKHZ8fCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMzOTQwNGEsIzFiMjQzMCknKTsKICAgICAgICBncmlkLmFwcGVuZENoaWxkKGQpOwogICAgICB9KTsKICAgICAgcGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7CiAgICAgICAgY29uc3Qgc3cgPSBlLnRhcmdldC5jbG9zZXN0KCcuc3dhdGNoJyk7IGlmKCFzdyB8fCAhYWN0aXZlSGVhZGluZykgcmV0dXJuOwogICAgICAgIGNvbnN0IHZhbCA9IHN3LmRhdGFzZXQudmFsIHx8ICcnOwogICAgICAgIGNvbnN0IG1hcCA9IGxvYWRNYXAoKTsgbWFwW2FjdGl2ZUhlYWRpbmddID0gdmFsOyBzYXZlTWFwKG1hcCk7CiAgICAgICAgYXBwbHlIZWFkaW5nQmFyKGFjdGl2ZUhlYWRpbmcsIHZhbCk7CiAgICAgICAgcGFsLnN0eWxlLmRpc3BsYXk9J25vbmUnOwogICAgICB9KTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldil7CiAgICAgICAgaWYocGFsLnN0eWxlLmRpc3BsYXk9PT0nYmxvY2snICYmICFwYWwuY29udGFpbnMoZXYudGFyZ2V0KSAmJiAhZXYudGFyZ2V0LmNsb3Nlc3QoJy5iYXItY29sb3ItYnRuJykpIHBhbC5zdHlsZS5kaXNwbGF5PSdub25lJzsKICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gcGFsOwogIH0KCiAgZnVuY3Rpb24gZW5oYW5jZU1lbnVzKCl7CiAgICBpZighd2luZG93LkFwcCB8fCAhQXBwLnN0YXRlIHx8ICFBcHAuc3RhdGUuaGVhZGluZ3MpIHJldHVybjsKICAgIEFwcC5zdGF0ZS5oZWFkaW5ncy5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpewogICAgICBjb25zdCBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGhhLSR7bmFtZX1gKTsKICAgICAgaWYoIW1lbnUpIHJldHVybjsKCiAgICAgIC8vIFJlbW92ZSAiT3BlbiBhbGwiIGJ1dHRvbiBmcm9tIHRoZSBoZWFkaW5nIGJhciAob3V0c2lkZSBtZW51KQogICAgICB0cnl7CiAgICAgICAgY29uc3QgYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI21haW4taGVhZGluZy0ke0NTUy5lc2NhcGUobmFtZSl9IC5oZWFkaW5nLWJhciAuaGVhZGluZy1hY3Rpb25zYCk7CiAgICAgICAgaWYoYmFyKXsKICAgICAgICAgIGNvbnN0IGJ0bnMgPSBBcnJheS5mcm9tKGJhci5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24uY2hpcC1idG4nKSk7CiAgICAgICAgICBidG5zLmZvckVhY2goYj0+eyBpZigvb3BlbiBhbGwvaS50ZXN0KGIudGV4dENvbnRlbnR8fCcnKSkgYi5yZW1vdmUoKTsgfSk7CiAgICAgICAgfQogICAgICB9Y2F0Y2h7fQoKICAgICAgLy8gSW5zZXJ0IG91ciBCYXIgY29sb3IgaXRlbSBhdCB0aGUgdG9wIG9mIHRoZSBtZW51IGlmIG5vdCBwcmVzZW50CiAgICAgIGlmKCFtZW51LnF1ZXJ5U2VsZWN0b3IoJy5iYXItY29sb3ItYnRuJykpewogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyByb3cuY2xhc3NOYW1lPSdyb3cnOyByb3cuc3R5bGUubWFyZ2luVG9wPScwJzsKICAgICAgICByb3cuaW5uZXJIVE1MID0gJzxidXR0b24gY2xhc3M9XCJjaGlwLWJ0biBiYXItY29sb3ItYnRuXCI+8J+OqCBCYXIgY29sb3I8L2J1dHRvbj4nOwogICAgICAgIG1lbnUuaW5zZXJ0QmVmb3JlKHJvdywgbWVudS5maXJzdENoaWxkKTsKICAgICAgICBjb25zdCBidG4gPSByb3cucXVlcnlTZWxlY3RvcignLmJhci1jb2xvci1idG4nKTsKICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldil7CiAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgIGFjdGl2ZUhlYWRpbmcgPSBuYW1lOwogICAgICAgICAgY29uc3QgcGFsID0gZW5zdXJlUGFsZXR0ZSgpOwogICAgICAgICAgY29uc3QgciA9IGJ0bi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICAgIHBhbC5zdHlsZS5sZWZ0ID0gKHIucmlnaHQgKyA4ICsgd2luZG93LnNjcm9sbFgpICsgJ3B4JzsKICAgICAgICAgIHBhbC5zdHlsZS50b3AgID0gKHIudG9wICsgd2luZG93LnNjcm9sbFkpICsgJ3B4JzsKICAgICAgICAgIHBhbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgIG1lbnUuc3R5bGUuekluZGV4ID0gMjE0NzQ4MjAwMDsgLy8ga2VlcCBtZW51IGFib3ZlIHBhZ2UgYnV0IGJlbG93IHBhbGV0dGUKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CiAgfQoKICAvLyAzKSBFbnN1cmUgYW55IG5ld2x5IGNyZWF0ZWQgY2FyZHMgbmV2ZXIgc2hvdyB0ZWFsIChiZWx0K2JyYWNlcykKICAoZnVuY3Rpb24gcGF0Y2hDcmVhdGVDYXJkKCl7CiAgICBpZighd2luZG93LkFwcCB8fCBBcHAuX19ub1RlYWw2KSByZXR1cm47CiAgICBpZih0eXBlb2YgQXBwLmNyZWF0ZUNhcmQgPT09ICdmdW5jdGlvbicpewogICAgICBjb25zdCBvcmlnID0gQXBwLmNyZWF0ZUNhcmQuYmluZChBcHApOwogICAgICBBcHAuY3JlYXRlQ2FyZCA9IGZ1bmN0aW9uKGNvbnRhaW5lciwgaGVhZGluZ05hbWUsIGl0ZW0pewogICAgICAgIGlmKGl0ZW0peyBpZighaXRlbS5jb2xvck5hbWUgfHwgL150ZWFsJC9pLnRlc3QoaXRlbS5jb2xvck5hbWUpKSBpdGVtLmNvbG9yTmFtZT0nJzsgaWYoJ2NvbG9yJyBpbiBpdGVtKSBpdGVtLmNvbG9yPScnOyB9CiAgICAgICAgY29uc3QgcmVzID0gb3JpZyhjb250YWluZXIsIGhlYWRpbmdOYW1lLCBpdGVtKTsKICAgICAgICB0cnl7CiAgICAgICAgICBjb25zdCBjYXJkcyA9IGNvbnRhaW5lciA/IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuY2FyZCcpIDogW107CiAgICAgICAgICBjb25zdCBjYXJkID0gY2FyZHNbY2FyZHMubGVuZ3RoLTFdOyBpZihjYXJkKXsKICAgICAgICAgICAgY2FyZC5zdHlsZS5zZXRQcm9wZXJ0eSgnYmFja2dyb3VuZCcsIGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5nZXRQcm9wZXJ0eVZhbHVlKCctLWNhcmQnKS50cmltKCkgfHwgJyMxMzFhMjInLCAnaW1wb3J0YW50Jyk7CiAgICAgICAgICAgIGNhcmQuc3R5bGUuc2V0UHJvcGVydHkoJ2NvbG9yJywgZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLmdldFByb3BlcnR5VmFsdWUoJy0tdGV4dCcpLnRyaW0oKSB8fCAnI2VhZjJmZicsICdpbXBvcnRhbnQnKTsKICAgICAgICAgIH0KICAgICAgICB9Y2F0Y2h7fQogICAgICAgIHJldHVybiByZXM7CiAgICAgIH07CiAgICAgIEFwcC5fX25vVGVhbDYgPSB0cnVlOwogICAgfQogIH0pKCk7CgogIGZ1bmN0aW9uIGluaXQoKXsKICAgIHRyeXsgZW5oYW5jZU1lbnVzKCk7IGFwcGx5QWxsU2F2ZWQoKTsgfWNhdGNoKGUpeyBjb25zb2xlLndhcm4oZSk7IH0KICB9CiAgaWYoZG9jdW1lbnQucmVhZHlTdGF0ZT09PSdsb2FkaW5nJyl7IGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0LCB7IG9uY2U6dHJ1ZSB9KTsgfSBlbHNlIHsgaW5pdCgpOyB9Cn0pKCk7"},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgY29uc3QgTUFQX0tFWSA9ICdyYW1pZnlfaGVhZGluZ19iYXJfbWFwJzsKCiAgZnVuY3Rpb24gbG9hZE1hcCgpeyB0cnl7IHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKE1BUF9LRVkpfHwne30nKTsgfWNhdGNoeyByZXR1cm4ge307IH0gfQogIGZ1bmN0aW9uIHNhdmVNYXAobSl7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKE1BUF9LRVksIEpTT04uc3RyaW5naWZ5KG0pKTsgfQoKICAvLyBQYXJzZSBmaXJzdCBoZXggY29sb3IgZnJvbSBhIENTUyBjb2xvci9ncmFkaWVudCBzdHJpbmcKICBmdW5jdGlvbiBmaXJzdEhleChjc3MpewogICAgaWYoIWNzcykgcmV0dXJuIG51bGw7CiAgICBjb25zdCBtID0gY3NzLm1hdGNoKC8jKFswLTlhLWZdezZ9KS9pKTsKICAgIHJldHVybiBtID8gbVswXSA6IG51bGw7CiAgfQogIGZ1bmN0aW9uIGhleFRvUmdiKGhleCl7CiAgICBpZighaGV4KSByZXR1cm4gbnVsbDsKICAgIGNvbnN0IGggPSBoZXgucmVwbGFjZSgnIycsJycpOwogICAgcmV0dXJuIHsgcjogcGFyc2VJbnQoaC5zbGljZSgwLDIpLDE2KSwgZzogcGFyc2VJbnQoaC5zbGljZSgyLDQpLDE2KSwgYjogcGFyc2VJbnQoaC5zbGljZSg0LDYpLDE2KSB9OwogIH0KICBmdW5jdGlvbiBsdW1pbmFuY2UocmdiKXsKICAgIGlmKCFyZ2IpIHJldHVybiAwOwogICAgY29uc3Qgc3JnYiA9IFsncicsJ2cnLCdiJ10ubWFwKGs9PnsKICAgICAgbGV0IHYgPSByZ2Jba10vMjU1OwogICAgICByZXR1cm4gdiA8PSAwLjAzOTI4ID8gdi8xMi45MiA6IE1hdGgucG93KCh2KzAuMDU1KS8xLjA1NSwgMi40KTsKICAgIH0pOwogICAgcmV0dXJuIDAuMjEyNipzcmdiWzBdICsgMC43MTUyKnNyZ2JbMV0gKyAwLjA3MjIqc3JnYlsyXTsKICB9CiAgZnVuY3Rpb24gcGlja0ZvcmVncm91bmQoY3NzKXsKICAgIGNvbnN0IHJnYiA9IGhleFRvUmdiKGZpcnN0SGV4KGNzcykgfHwgJyMzOTQwNGEnKTsgLy8gZmFsbGJhY2sKICAgIGNvbnN0IEwgPSBsdW1pbmFuY2UocmdiKTsKICAgIC8vIGNob29zZSBsaWdodCB0ZXh0IGZvciBkYXJrIGJhY2tncm91bmRzCiAgICByZXR1cm4gKEwgPCAwLjUpID8gJyNmZmZmZmYnIDogJyMwYjEyMjAnOwogIH0KCiAgZnVuY3Rpb24gc2V0SGVhZGluZ0NvbnRyYXN0KG5hbWUsIGNzc0JnKXsKICAgIGNvbnN0IGJhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNtYWluLWhlYWRpbmctJHtDU1MuZXNjYXBlKG5hbWUpfSAuaGVhZGluZy1iYXJgKTsKICAgIGlmKCFiYXIpIHJldHVybjsKICAgIGNvbnN0IGZnID0gcGlja0ZvcmVncm91bmQoY3NzQmcpOwogICAgLy8gc2V0IGlubGluZSBDU1MgdmFyaWFibGUgdG8gYmUgdXNlZCBpbiBDU1MKICAgIGJhci5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1oYi1mZycsIGZnKTsKICB9CgogIGZ1bmN0aW9uIGFwcGx5SGVhZGluZ0JhcihuYW1lLCB2YWx1ZSl7CiAgICBjb25zdCBiYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjbWFpbi1oZWFkaW5nLSR7Q1NTLmVzY2FwZShuYW1lKX0gLmhlYWRpbmctYmFyYCk7CiAgICBpZighYmFyKSByZXR1cm47CiAgICBjb25zdCB2YWwgPSAodmFsdWUgJiYgdmFsdWUubGVuZ3RoKSA/IHZhbHVlIDogJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzM5NDA0YSwjMWIyNDMwKSc7CiAgICBiYXIuc3R5bGUuc2V0UHJvcGVydHkoJ2JhY2tncm91bmQnLCB2YWwsICdpbXBvcnRhbnQnKTsKICAgIGJhci5zdHlsZS5zZXRQcm9wZXJ0eSgnYm9yZGVyJywgJzFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMDgpJywgJ2ltcG9ydGFudCcpOwogICAgc2V0SGVhZGluZ0NvbnRyYXN0KG5hbWUsIHZhbCk7CiAgfQogIGZ1bmN0aW9uIGFwcGx5QWxsU2F2ZWQoKXsKICAgIGNvbnN0IG1hcCA9IGxvYWRNYXAoKTsKICAgICh3aW5kb3cuQXBwICYmIEFwcC5zdGF0ZSAmJiBBcHAuc3RhdGUuaGVhZGluZ3MgfHwgW10pLmZvckVhY2goZnVuY3Rpb24obmFtZSl7CiAgICAgIGlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtYXAsIG5hbWUpKXsKICAgICAgICBhcHBseUhlYWRpbmdCYXIobmFtZSwgbWFwW25hbWVdfHwnJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYXBwbHlIZWFkaW5nQmFyKG5hbWUsICcnKTsKICAgICAgfQogICAgfSk7CiAgfQoKICAvLyBQYWxldHRlIChzd2F0Y2hlcyBvbmx5KQogIGxldCBhY3RpdmVIZWFkaW5nID0gbnVsbDsKICBmdW5jdGlvbiBlbnN1cmVQYWxldHRlKCl7CiAgICBsZXQgcGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlYWRpbmdDb2xvclBhbGV0dGUnKTsKICAgIGlmKCFwYWwpewogICAgICBwYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgcGFsLmlkID0gJ2hlYWRpbmdDb2xvclBhbGV0dGUnOwogICAgICBwYWwuc2V0QXR0cmlidXRlKCdyb2xlJywnZGlhbG9nJyk7CiAgICAgIHBhbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDt6LWluZGV4OjIxNDc0ODMwMDA7YmFja2dyb3VuZDojMGYxNDFjO2JvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTIpO2JvcmRlci1yYWRpdXM6MTRweDtwYWRkaW5nOjEycHg7Ym94LXNoYWRvdzowIDEwcHggMjhweCByZ2JhKDAsMCwwLC40NSk7bWluLXdpZHRoOjI2MHB4Oyc7CiAgICAgIHBhbC5pbm5lckhUTUwgPSAnPGg0IHN0eWxlPVwibWFyZ2luOjAgMCA4cHg7Zm9udC1zaXplOjE0cHhcIj5IZWFkaW5nIEJhciBjb2xvcjwvaDQ+PGRpdiBjbGFzcz1cInN3YXRjaGVzXCIgc3R5bGU9XCJkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdCgzLDFmcik7Z2FwOjhweFwiPjwvZGl2Pic7CiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocGFsKTsKICAgICAgY29uc3QgcHJlc2V0cyA9IFsKICAgICAgICAnJywgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzIyZDNlZSwjYTc4YmZhKScsJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzEwYjk4MSwjNjBhNWZhKScsCiAgICAgICAgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzBlYTVlOSwjMTRiOGE2KScsJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsI2VmNDQ0NCwjZjU5ZTBiKScsCiAgICAgICAgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzhiNWNmNiwjMDZiNmQ0KScsJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzBlYTVlOSwjOTMzM2VhKScsCiAgICAgICAgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsI2Y1OWUwYiwjODRjYzE2KScsJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzFlMjkzYiwjMGVhNWU5KScsCiAgICAgICAgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzE0YjhhNiwjZmFjYzE1KScsJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsI2ZiNzE4NSwjZTg3OWY5KScsCiAgICAgICAgJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzM4YmRmOCwjMjJkM2VlKScKICAgICAgXTsKICAgICAgY29uc3QgZ3JpZCA9IHBhbC5xdWVyeVNlbGVjdG9yKCcuc3dhdGNoZXMnKTsKICAgICAgcHJlc2V0cy5mb3JFYWNoKHY9PnsgY29uc3QgZD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgZC5jbGFzc05hbWU9J3N3YXRjaCc7IGQuZGF0YXNldC52YWw9djsKICAgICAgICBkLnN0eWxlLmNzc1RleHQ9J2hlaWdodDozNnB4O2JvcmRlci1yYWRpdXM6MTBweDtjdXJzb3I6cG9pbnRlcjtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjEyKTtiYWNrZ3JvdW5kOicrKHZ8fCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMzOTQwNGEsIzFiMjQzMCknKTsKICAgICAgICBncmlkLmFwcGVuZENoaWxkKGQpOwogICAgICB9KTsKICAgICAgcGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7CiAgICAgICAgY29uc3Qgc3cgPSBlLnRhcmdldC5jbG9zZXN0KCcuc3dhdGNoJyk7IGlmKCFzdyB8fCAhYWN0aXZlSGVhZGluZykgcmV0dXJuOwogICAgICAgIGNvbnN0IHZhbCA9IHN3LmRhdGFzZXQudmFsIHx8ICcnOwogICAgICAgIGNvbnN0IG1hcCA9IGxvYWRNYXAoKTsgbWFwW2FjdGl2ZUhlYWRpbmddID0gdmFsOyBzYXZlTWFwKG1hcCk7CiAgICAgICAgYXBwbHlIZWFkaW5nQmFyKGFjdGl2ZUhlYWRpbmcsIHZhbCk7CiAgICAgICAgcGFsLnN0eWxlLmRpc3BsYXk9J25vbmUnOwogICAgICB9KTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldil7CiAgICAgICAgaWYocGFsLnN0eWxlLmRpc3BsYXk9PT0nYmxvY2snICYmICFwYWwuY29udGFpbnMoZXYudGFyZ2V0KSAmJiAhZXYudGFyZ2V0LmNsb3Nlc3QoJy5iYXItY29sb3ItYnRuJykpIHBhbC5zdHlsZS5kaXNwbGF5PSdub25lJzsKICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gcGFsOwogIH0KCiAgZnVuY3Rpb24gZW5oYW5jZU1lbnVzKCl7CiAgICBpZighd2luZG93LkFwcCB8fCAhQXBwLnN0YXRlIHx8ICFBcHAuc3RhdGUuaGVhZGluZ3MpIHJldHVybjsKICAgIEFwcC5zdGF0ZS5oZWFkaW5ncy5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpewogICAgICBjb25zdCBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGhhLSR7bmFtZX1gKTsKICAgICAgaWYoIW1lbnUpIHJldHVybjsKCiAgICAgIC8vIFJlbW92ZSAiT3BlbiBhbGwiIGJ1dHRvbiBmcm9tIHRoZSBoZWFkaW5nIGJhciAob3V0c2lkZSBtZW51KQogICAgICB0cnl7CiAgICAgICAgY29uc3QgYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI21haW4taGVhZGluZy0ke0NTUy5lc2NhcGUobmFtZSl9IC5oZWFkaW5nLWJhciAuaGVhZGluZy1hY3Rpb25zYCk7CiAgICAgICAgaWYoYmFyKXsKICAgICAgICAgIEFycmF5LmZyb20oYmFyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbi5jaGlwLWJ0bicpKS5mb3JFYWNoKGI9PnsgaWYoL29wZW4gYWxsL2kudGVzdChiLnRleHRDb250ZW50fHwnJykpIGIucmVtb3ZlKCk7IH0pOwogICAgICAgIH0KICAgICAgfWNhdGNoe30KCiAgICAgIC8vIEluc2VydCBvdXIgQmFyIGNvbG9yIGl0ZW0gYXQgdGhlIHZlcnkgdG9wIG9mIHRoZSBtZW51IGlmIG5vdCBwcmVzZW50CiAgICAgIGlmKCFtZW51LnF1ZXJ5U2VsZWN0b3IoJy5iYXItY29sb3ItYnRuJykpewogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyByb3cuY2xhc3NOYW1lPSdyb3cnOyByb3cuc3R5bGUubWFyZ2luVG9wPScwJzsKICAgICAgICByb3cuaW5uZXJIVE1MID0gJzxidXR0b24gY2xhc3M9XCJjaGlwLWJ0biBiYXItY29sb3ItYnRuXCI+8J+OqCBCYXIgY29sb3I8L2J1dHRvbj4nOwogICAgICAgIG1lbnUuaW5zZXJ0QmVmb3JlKHJvdywgbWVudS5maXJzdENoaWxkKTsKICAgICAgICBjb25zdCBidG4gPSByb3cucXVlcnlTZWxlY3RvcignLmJhci1jb2xvci1idG4nKTsKICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldil7CiAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgIGFjdGl2ZUhlYWRpbmcgPSBuYW1lOwogICAgICAgICAgY29uc3QgcGFsID0gZW5zdXJlUGFsZXR0ZSgpOwogICAgICAgICAgY29uc3QgciA9IGJ0bi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICAgIHBhbC5zdHlsZS5sZWZ0ID0gKHIucmlnaHQgKyA4ICsgd2luZG93LnNjcm9sbFgpICsgJ3B4JzsKICAgICAgICAgIHBhbC5zdHlsZS50b3AgID0gKHIudG9wICsgd2luZG93LnNjcm9sbFkpICsgJ3B4JzsKICAgICAgICAgIHBhbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgIG1lbnUuc3R5bGUuekluZGV4ID0gMjE0NzQ4MjAwMDsgLy8ga2VlcCBtZW51IGFib3ZlIHBhZ2UgYnV0IGJlbG93IHBhbGV0dGUKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CiAgfQoKICAvLyBQYXRjaCByZW5kZXJIZWFkaW5nc1VJIHNvIGVuaGFuY2VtZW50cyByZS1hcHBseSBhZnRlciBhbnkgcmUtcmVuZGVyCiAgZnVuY3Rpb24gcGF0Y2hSZW5kZXJIZWFkaW5ncygpewogICAgaWYoIXdpbmRvdy5BcHAgfHwgQXBwLl9fbWVudXNFbmhhbmNlZDcpIHJldHVybjsKICAgIGNvbnN0IG9yaWcgPSBBcHAucmVuZGVySGVhZGluZ3NVSSAmJiBBcHAucmVuZGVySGVhZGluZ3NVSS5iaW5kKEFwcCk7CiAgICBpZighb3JpZykgcmV0dXJuOwogICAgQXBwLnJlbmRlckhlYWRpbmdzVUkgPSBmdW5jdGlvbigpewogICAgICBjb25zdCByID0gb3JpZygpOwogICAgICB0cnl7IGVuaGFuY2VNZW51cygpOyBhcHBseUFsbFNhdmVkKCk7IH1jYXRjaChlKXsgY29uc29sZS53YXJuKGUpOyB9CiAgICAgIHJldHVybiByOwogICAgfTsKICAgIEFwcC5fX21lbnVzRW5oYW5jZWQ3ID0gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGluaXQoKXsKICAgIHBhdGNoUmVuZGVySGVhZGluZ3MoKTsKICAgIC8vIElmIGFscmVhZHkgcmVuZGVyZWQsIHJ1biBub3cKICAgIHRyeXsgZW5oYW5jZU1lbnVzKCk7IGFwcGx5QWxsU2F2ZWQoKTsgfWNhdGNoKGUpeyBjb25zb2xlLndhcm4oZSk7IH0KICB9CiAgaWYoZG9jdW1lbnQucmVhZHlTdGF0ZT09PSdsb2FkaW5nJyl7IGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0LCB7IG9uY2U6dHJ1ZSB9KTsgfSBlbHNlIHsgaW5pdCgpOyB9Cn0pKCk7"},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgY29uc3QgTUFQX0tFWSA9ICdyYW1pZnlfaGVhZGluZ19iYXJfbWFwJzsKICBmdW5jdGlvbiBsb2FkTWFwKCl7IHRyeXsgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oTUFQX0tFWSl8fCd7fScpOyB9Y2F0Y2h7IHJldHVybiB7fTsgfSB9CiAgZnVuY3Rpb24gc2F2ZU1hcChtKXsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTUFQX0tFWSwgSlNPTi5zdHJpbmdpZnkobSkpOyB9CgogIGZ1bmN0aW9uIGFwcGx5SGVhZGluZ0JhcihuYW1lLCB2YWx1ZSl7CiAgICBjb25zdCBiYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjbWFpbi1oZWFkaW5nLSR7Q1NTLmVzY2FwZShuYW1lKX0gLmhlYWRpbmctYmFyYCk7CiAgICBpZighYmFyKSByZXR1cm47CiAgICBjb25zdCB2YWwgPSAodmFsdWUgJiYgdmFsdWUubGVuZ3RoKSA/IHZhbHVlIDogJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzM5NDA0YSwjMWIyNDMwKSc7CiAgICBiYXIuc3R5bGUuc2V0UHJvcGVydHkoJ2JhY2tncm91bmQnLCB2YWwsICdpbXBvcnRhbnQnKTsKICAgIGJhci5zdHlsZS5zZXRQcm9wZXJ0eSgnYm9yZGVyJywgJzFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMDgpJywgJ2ltcG9ydGFudCcpOwoKICAgIC8vIENvbnRyYXN0IGNhbGN1bGF0aW9uIChzYW1lIGFzIGJlZm9yZSwgaW5saW5lZCBoZXJlIHRvIGVuc3VyZSBwcmVzZW5jZSkKICAgIGZ1bmN0aW9uIGZpcnN0SGV4KGNzcyl7IGNvbnN0IG0gPSAoY3NzfHwnJykubWF0Y2goLyMoWzAtOWEtZl17Nn0pL2kpOyByZXR1cm4gbSA/IG1bMF0gOiBudWxsOyB9CiAgICBmdW5jdGlvbiBoZXhUb1JnYihoKXsgaWYoIWgpIHJldHVybiBudWxsOyBoPWgucmVwbGFjZSgnIycsJycpOyByZXR1cm4ge3I6cGFyc2VJbnQoaC5zbGljZSgwLDIpLDE2KSwgZzpwYXJzZUludChoLnNsaWNlKDIsNCksMTYpLCBiOnBhcnNlSW50KGguc2xpY2UoNCw2KSwxNil9OyB9CiAgICBmdW5jdGlvbiBsdW1pbmFuY2UocmdiKXsgaWYoIXJnYikgcmV0dXJuIDA7IGNvbnN0IGY9eD0+e3gvPTI1NTsgcmV0dXJuIHg8PS4wMzkyOD94LzEyLjkyOk1hdGgucG93KCh4Ky4wNTUpLzEuMDU1LDIuNCl9OyByZXR1cm4gLjIxMjYqZihyZ2IucikrLjcxNTIqZihyZ2IuZykrLjA3MjIqZihyZ2IuYik7IH0KICAgIGNvbnN0IHJnYiA9IGhleFRvUmdiKGZpcnN0SGV4KHZhbCkgfHwgJyMzOTQwNGEnKTsgY29uc3QgTCA9IGx1bWluYW5jZShyZ2IpOwogICAgY29uc3QgZmcgPSAoTCA8IDAuNSkgPyAnI2ZmZmZmZicgOiAnIzBiMTIyMCc7CiAgICBiYXIuc3R5bGUuc2V0UHJvcGVydHkoJy0taGItZmcnLCBmZyk7CiAgfQoKICBmdW5jdGlvbiBhcHBseUFsbFNhdmVkKCl7CiAgICBjb25zdCBtYXAgPSBsb2FkTWFwKCk7CiAgICAod2luZG93LkFwcCAmJiBBcHAuc3RhdGUgJiYgQXBwLnN0YXRlLmhlYWRpbmdzIHx8IFtdKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpewogICAgICBhcHBseUhlYWRpbmdCYXIobmFtZSwgbWFwW25hbWVdIHx8ICcnKTsKICAgIH0pOwogIH0KCiAgLy8gUmViaW5kIHRoZSBzd2F0Y2ggY2xpY2sgdG8gcmUtYXBwbHkgZ2xvYmFsbHkgYWZ0ZXIgc2F2ZQogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7CiAgICBjb25zdCBzdyA9IGUudGFyZ2V0LmNsb3Nlc3QoJyNoZWFkaW5nQ29sb3JQYWxldHRlIC5zd2F0Y2gnKTsKICAgIGlmKCFzdykgcmV0dXJuOwogICAgLy8gRmluZCBhY3RpdmUgaGVhZGluZyBieSBsb2NhdGluZyB0aGUgbmVhcmVzdCBvcGVuIG1lbnUKICAgIGNvbnN0IG9wZW5NZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1pbmktbWVudVtzdHlsZSo9XCJkaXNwbGF5OiBibG9ja1wiXSwgLm1pbmktbWVudS5vcGVuLCAubWluaS1tZW51Om5vdCguaGlkZGVuKScpOwogICAgLy8gRmFsbGJhY2s6IGxhc3QgY2xpY2tlZCBiYXItY29sb3IgYnV0dG9uIGNhY2hlcyBoZWFkaW5nIHZpYSBkYXRhc2V0IG9uIGJvZHkKICAgIGxldCBoZWFkaW5nID0gZG9jdW1lbnQuYm9keS5kYXRhc2V0LmFjdGl2ZUhlYWRpbmcgfHwgbnVsbDsKICAgIGlmKG9wZW5NZW51ICYmICFoZWFkaW5nKXsKICAgICAgY29uc3QgaWQgPSBvcGVuTWVudS5pZCB8fCAnJzsKICAgICAgaWYoaWQuc3RhcnRzV2l0aCgnaGEtJykpIGhlYWRpbmcgPSBpZC5zbGljZSgzKTsKICAgIH0KICAgIGlmKCFoZWFkaW5nKSByZXR1cm47CiAgICBjb25zdCBtYXAgPSBsb2FkTWFwKCk7IG1hcFtoZWFkaW5nXSA9IHN3LmRhdGFzZXQudmFsIHx8ICcnOyBzYXZlTWFwKG1hcCk7CiAgICBhcHBseUhlYWRpbmdCYXIoaGVhZGluZywgbWFwW2hlYWRpbmddKTsKICAgIC8vIEFsc28gcmUtYXBwbHkgYWNyb3NzIGFsbCAoaW4gY2FzZSBiYXJzIHJlLXJlbmRlcmVkKQogICAgc2V0VGltZW91dChhcHBseUFsbFNhdmVkLCAwKTsKICB9LCB0cnVlKTsKCiAgLy8gVHJhY2sgd2hpY2ggaGVhZGluZyBidXR0b24gb3BlbmVkIHRoZSBwYWxldHRlCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXsKICAgIGNvbnN0IGJ0biA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5iYXItY29sb3ItYnRuJyk7CiAgICBpZihidG4pewogICAgICBjb25zdCBzZWN0aW9uID0gYnRuLmNsb3Nlc3QoJ1tpZF49XCJtYWluLWhlYWRpbmctXCJdJyk7CiAgICAgIGlmKHNlY3Rpb24peyBkb2N1bWVudC5ib2R5LmRhdGFzZXQuYWN0aXZlSGVhZGluZyA9IHNlY3Rpb24uaWQucmVwbGFjZSgnbWFpbi1oZWFkaW5nLScsJycpOyB9CiAgICB9CiAgfSwgdHJ1ZSk7CgogIC8vIEVuc3VyZSBtZW51cyBhcmUgZW5oYW5jZWQgYWZ0ZXIgcmVuZGVyCiAgKGZ1bmN0aW9uIHBhdGNoUmVuZGVySGVhZGluZ3NBZ2FpbigpewogICAgaWYoIXdpbmRvdy5BcHAgfHwgQXBwLl9fbWVudXNFbmhhbmNlZDgpIHJldHVybjsKICAgIGNvbnN0IG9yaWcgPSBBcHAucmVuZGVySGVhZGluZ3NVSSAmJiBBcHAucmVuZGVySGVhZGluZ3NVSS5iaW5kKEFwcCk7CiAgICBpZighb3JpZykgcmV0dXJuOwogICAgQXBwLnJlbmRlckhlYWRpbmdzVUkgPSBmdW5jdGlvbigpewogICAgICBjb25zdCByID0gb3JpZygpOwogICAgICB0cnl7IGFwcGx5QWxsU2F2ZWQoKTsgfWNhdGNoKGUpeyBjb25zb2xlLndhcm4oZSk7IH0KICAgICAgcmV0dXJuIHI7CiAgICB9OwogICAgQXBwLl9fbWVudXNFbmhhbmNlZDggPSB0cnVlOwogIH0pKCk7CgogIC8vIEluaXRpYWwgc3dlZXAKICBpZihkb2N1bWVudC5yZWFkeVN0YXRlPT09J2xvYWRpbmcnKXsgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGFwcGx5QWxsU2F2ZWQsIHtvbmNlOnRydWV9KTsgfSBlbHNlIHsgYXBwbHlBbGxTYXZlZCgpOyB9Cn0pKCk7"},{"t":"classic","d":"KGZ1bmN0aW9uKCl7CiAgZnVuY3Rpb24gcmVidWlsZFBhbGV0dGUoKXsKICAgIGxldCBwYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVhZGluZ0NvbG9yUGFsZXR0ZScpOwogICAgaWYoIXBhbCkgcmV0dXJuOwogICAgcGFsLmlubmVySFRNTCA9ICc8aDQgc3R5bGU9Im1hcmdpbjowIDAgOHB4O2ZvbnQtc2l6ZToxNHB4Ij5IZWFkaW5nIEJhciBjb2xvcjwvaDQ+PGRpdiBjbGFzcz0ic3dhdGNoZXMiIHN0eWxlPSJkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdCgzLDFmcik7Z2FwOjhweCI+PC9kaXY+JzsKICAgIGNvbnN0IGdyaWQgPSBwYWwucXVlcnlTZWxlY3RvcignLnN3YXRjaGVzJyk7CiAgICBjb25zdCBwcmVzZXRzID0gWwogICAgICAvLyBEZWZhdWx0CiAgICAgIHtuYW1lOidEZWZhdWx0JywgdmFsOicnfSwKCiAgICAgIC8vIFNvbGlkcwogICAgICB7bmFtZTonQmx1ZScsIHZhbDonIzNiODJmNid9LAogICAgICB7bmFtZTonUmVkJywgdmFsOicjZWY0NDQ0J30sCiAgICAgIHtuYW1lOidHcmVlbicsIHZhbDonIzIyYzU1ZSd9LAogICAgICB7bmFtZTonWWVsbG93JywgdmFsOicjZWFiMzA4J30sCiAgICAgIHtuYW1lOidQdXJwbGUnLCB2YWw6JyNhODU1ZjcnfSwKICAgICAge25hbWU6J0dyYXknLCB2YWw6JyM2YjcyODAnfSwKCiAgICAgIC8vIEdyYWRpZW50cyAodGhlIG5pY2UgZmxhc2h5IG9uZXMpCiAgICAgIHtuYW1lOidBcXVhLVZpb2xldCcsIHZhbDonbGluZWFyLWdyYWRpZW50KDEzNWRlZywjMjJkM2VlLCNhNzhiZmEpJ30sCiAgICAgIHtuYW1lOidNaW50LVNreScsIHZhbDonbGluZWFyLWdyYWRpZW50KDEzNWRlZywjMTBiOTgxLCM2MGE1ZmEpJ30sCiAgICAgIHtuYW1lOidPY2VhbicsIHZhbDonbGluZWFyLWdyYWRpZW50KDEzNWRlZywjMGVhNWU5LCMxNGI4YTYpJ30sCiAgICAgIHtuYW1lOidTdW5zZXQnLCB2YWw6J2xpbmVhci1ncmFkaWVudCgxMzVkZWcsI2VmNDQ0NCwjZjU5ZTBiKSd9LAogICAgICB7bmFtZTonQ3liZXInLCB2YWw6J2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzhiNWNmNiwjMDZiNmQ0KSd9LAogICAgICB7bmFtZTonTmVvbicsIHZhbDonbGluZWFyLWdyYWRpZW50KDEzNWRlZywjMGVhNWU5LCM5MzMzZWEpJ30sCiAgICAgIHtuYW1lOidMaW1ld2F2ZScsIHZhbDonbGluZWFyLWdyYWRpZW50KDEzNWRlZywjZjU5ZTBiLCM4NGNjMTYpJ30sCiAgICAgIHtuYW1lOidNaWRuaWdodCcsIHZhbDonbGluZWFyLWdyYWRpZW50KDEzNWRlZywjMWUyOTNiLCMwZWE1ZTkpJ30sCiAgICAgIHtuYW1lOidUcm9waWMnLCB2YWw6J2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzE0YjhhNiwjZmFjYzE1KSd9LAogICAgICB7bmFtZTonQ2FuZHknLCB2YWw6J2xpbmVhci1ncmFkaWVudCgxMzVkZWcsI2ZiNzE4NSwjZTg3OWY5KSd9LAogICAgICB7bmFtZTonU2t5YmxlbmQnLCB2YWw6J2xpbmVhci1ncmFkaWVudCgxMzVkZWcsIzM4YmRmOCwjMjJkM2VlKSd9CiAgICBdOwogICAgcHJlc2V0cy5mb3JFYWNoKGM9PnsKICAgICAgY29uc3QgZD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgZC5jbGFzc05hbWU9J3N3YXRjaCc7IGQuZGF0YXNldC52YWw9Yy52YWw7CiAgICAgIGQudGl0bGUgPSBjLm5hbWU7CiAgICAgIGQuc3R5bGUuY3NzVGV4dD0naGVpZ2h0OjM2cHg7Ym9yZGVyLXJhZGl1czoxMHB4O2N1cnNvcjpwb2ludGVyO2JvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTIpO2JhY2tncm91bmQ6JysoYy52YWx8fCdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCMzOTQwNGEsIzFiMjQzMCknKTsKICAgICAgZ3JpZC5hcHBlbmRDaGlsZChkKTsKICAgIH0pOwogIH0KICBpZihkb2N1bWVudC5yZWFkeVN0YXRlPT09J2xvYWRpbmcnKXsKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCByZWJ1aWxkUGFsZXR0ZSwge29uY2U6dHJ1ZX0pOwogIH0gZWxzZSB7CiAgICByZWJ1aWxkUGFsZXR0ZSgpOwogIH0KfSkoKTs="},{"t":"classic","d":"CihmdW5jdGlvbigpewogIGNvbnN0IE9XTkVSX0VNQUlMID0gImRlYW5yYW1zYm90dG9tM0BnbWFpbC5jb20iOwogIC8vIEVuc3VyZSBjbG9zZSBidXR0b24gd29ya3MKICBmdW5jdGlvbiBfd2lyZVNldHRpbmdzQ2hyb21lKCl7CiAgICBjb25zdCBiYWNrZHJvcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYW1pZnlTZXR0aW5nc0JhY2tkcm9wJyk7CiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYW1pZnlTZXR0aW5nc01vZGFsJyk7CiAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYW1pZnlTZXR0aW5nc0Nsb3NlJyk7CiAgICBpZihjbG9zZUJ0bil7CiAgICAgIGNsb3NlQnRuLm9uY2xpY2sgPSBfcmFtaWZ5Q2xvc2VTZXR0aW5nczsKICAgIH0KICAgIGlmKGJhY2tkcm9wKXsKICAgICAgYmFja2Ryb3Aub25jbGljayA9IF9yYW1pZnlDbG9zZVNldHRpbmdzOwogICAgfQogIH0KICB3aW5kb3cuX3JhbWlmeU9wZW5TZXR0aW5ncyA9IGZ1bmN0aW9uKCl7CiAgICBjb25zdCBiYWNrZHJvcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYW1pZnlTZXR0aW5nc0JhY2tkcm9wJyk7CiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYW1pZnlTZXR0aW5nc01vZGFsJyk7CiAgICBpZighYmFja2Ryb3AgfHwgIW1vZGFsKSByZXR1cm47CiAgICBiYWNrZHJvcC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgX3JhbWlmeVNob3dBYm91dCgpOwogICAgX3dpcmVTZXR0aW5nc0Nocm9tZSgpOwogIH07CiAgd2luZG93Ll9yYW1pZnlDbG9zZVNldHRpbmdzID0gZnVuY3Rpb24oKXsKICAgIGNvbnN0IGJhY2tkcm9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JhbWlmeVNldHRpbmdzQmFja2Ryb3AnKTsKICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JhbWlmeVNldHRpbmdzTW9kYWwnKTsKICAgIGlmKGJhY2tkcm9wKSBiYWNrZHJvcC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgaWYobW9kYWwpIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgfTsKICB3aW5kb3cuX3JhbWlmeVNob3dBYm91dCA9IGZ1bmN0aW9uKCl7CiAgICBjb25zdCBwYW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzUGFuZScpOwogICAgaWYoIXBhbmUpIHJldHVybjsKICAgIHBhbmUuaW5uZXJIVE1MID0gIjxiPlJhbWlmeXk8L2I+IGlzIHlvdXIgcGVyc29uYWwgc3RhcnQgcGFnZS4gWW91ciBkYXRhIGlzIHN0b3JlZCBsb2NhbGx5IGluIHRoaXMgYnJvd3Nlci4iOwogIH07CiAgd2luZG93Ll9yYW1pZnlTaG93Q29udGFjdCA9IGZ1bmN0aW9uKCl7CiAgICBjb25zdCBwYW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzUGFuZScpOwogICAgaWYoIXBhbmUpIHJldHVybjsKICAgIGNvbnN0IGVtYWlsID0gT1dORVJfRU1BSUw7CiAgICBwYW5lLmlubmVySFRNTCA9IGBZb3UgY2FuIGNvbnRhY3QgdGhlIG93bmVyIGF0IDxicj48YnI+PGNvZGUgc3R5bGU9ImZvbnQtd2VpZ2h0OjgwMCI+JHtlbWFpbH08L2NvZGU+PGJyPjxicj48YSBjbGFzcz0iY2hpcC1idG4iIGhyZWY9Im1haWx0bzoke2VtYWlsfSI+4pyJ77iPIEVtYWlsICR7ZW1haWx9PC9hPmA7CiAgfTsKICB3aW5kb3cuX3JhbWlmeVNob3dMZWdhbCA9IGZ1bmN0aW9uKCl7CiAgICBjb25zdCBwYW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzUGFuZScpOwogICAgaWYoIXBhbmUpIHJldHVybjsKICAgIHBhbmUuaW5uZXJIVE1MID0gWwogICAgICAiPGRpdj48Yj5Eb2N1bWVudHM8L2I+PC9kaXY+IiwKICAgICAgIjx1bCBzdHlsZT0nbGluZS1oZWlnaHQ6MS45Jz4iLAogICAgICAiPGxpPjxhIGhyZWY9J1ByaXZhY3lfUmFtaWZ5eS5wZGYnIGRvd25sb2FkPlByaXZhY3kgUG9saWN5IChQREYpPC9hPjwvbGk+IiwKICAgICAgIjxsaT48YSBocmVmPSdTZWN1cml0eV9SYW1pZnl5LnBkZicgZG93bmxvYWQ+U2VjdXJpdHkgUG9saWN5IChQREYpPC9hPjwvbGk+IiwKICAgICAgIjxsaT48YSBocmVmPSdUZXJtc19PZl9Vc2VfUmFtaWZ5eS5wZGYnIGRvd25sb2FkPlRlcm1zIG9mIFVzZSAoUERGKTwvYT48L2xpPiIsCiAgICAgICI8bGk+PGEgaHJlZj0nTGljZW5zZV9SYW1pZnl5LnBkZicgZG93bmxvYWQ+TGljZW5zZSAoUERGKTwvYT48L2xpPiIsCiAgICAgICI8L3VsPiIsCiAgICAgICI8c21hbGwgc3R5bGU9J2NvbG9yOnZhcigtLW11dGVkKSc+VGlwOiBrZWVwIHRoZXNlIFBERnMgbmV4dCB0byB0aGlzIEhUTUwgZmlsZSBzbyB0aGUgZG93bmxvYWRzIHdvcmsgb2ZmbGluZS48L3NtYWxsPiIKICAgIF0uam9pbigiIik7CiAgfTsKICAvLyBBbHNvIHdpcmUgZmFsbGJhY2sgIlNldHRpbmdzIiBidXR0b24gKGlmIHByZXNlbnQpIHRvIG9wZW4gdGhlIG1vZGFsCiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpewogICAgY29uc3QgZmIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmFtaWZ5U2V0dGluZ3NGYWxsYmFjaycpOwogICAgaWYoZmIpeyBmYi5zdHlsZS5kaXNwbGF5PSJub25lIjsgfQogIH0pOwp9KSgpOwo="}];
  var anchor = document.currentScript;
  function b64ToUtf8(b64){
    var bin = atob(b64);
    var bytes = new Uint8Array(bin.length);
    for (var i=0;i<bin.length;i++) bytes[i] = bin.charCodeAt(i);
    try {
      return new TextDecoder('utf-8').decode(bytes);
    } catch(e){
      // Fallback for very old browsers
      var s = '';
      for (var i=0;i<bytes.length;i++) s += String.fromCharCode(bytes[i]);
      return decodeURIComponent(escape(s));
    }
  }
  for (var i=0;i<list.length;i++){
    var item = list[i];
    var el = document.createElement('script');
    if(item.t === 'module'){ el.type = 'module'; }
    el.textContent = b64ToUtf8(item.d);
    anchor.parentNode.insertBefore(el, anchor);
  }
  // Remove loader script for cleanliness
  anchor.remove();
})();
</script>
